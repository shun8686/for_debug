image: swr.cn-southwest-2.myhuaweicloud.com/base_image/dockerhub/lmsysorg/sglang:cann8.3.rc2-a3-release1223
KUBE_JOB_NAME: sglang-single-227407ec-f13d-4c27-a472-65dcad1f367f
Apply k8s yaml... KUBE_NAME_SPACE:sglang-single-debug, KUBE_CONFIG_MAP:None, KUBE_JOB_TYPE:single, KUBE_YAML_FILE:yaml_sglang-single-227407ec-f13d-4c27-a472-65dcad1f367f.yaml
job.batch.volcano.sh/sglang-single-227407ec-f13d-4c27-a472-65dcad1f367f created

Waiting all pods to running...
No sglang pod, waiting...
Pod: sglang-single-227407ec-f13d-4c27-a472-65dcad1f367f-pod-0, status: Pending
Pod: sglang-single-227407ec-f13d-4c27-a472-65dcad1f367f-pod-0, status: Running
All sglang Pod is Running !
Starting to monitor logs for Pod: sglang-single-227407ec-f13d-4c27-a472-65dcad1f367f-pod-0
Namespace: sglang-single-debug
Timeout set to: 10800 seconds
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting kubernetes
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/ca/ec/65f7d563aa4a62dd58777e8f6aa882f15db53b14eb29aba0c28a20f7eb26/kubernetes-34.1.0-py2.py3-none-any.whl (2.0 MB)
Requirement already satisfied: certifi>=14.05.14 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2025.11.12)
Requirement already satisfied: six>=1.9.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (1.17.0)
Requirement already satisfied: python-dateutil>=2.5.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.9.0.post0)
Requirement already satisfied: pyyaml>=5.4.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (6.0.3)
Collecting google-auth>=1.0.1 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c6/97/451d55e05487a5cd6279a01a7e34921858b16f7dc8aa38a2c684743cd2b3/google_auth-2.45.0-py2.py3-none-any.whl (233 kB)
Collecting websocket-client!=0.40.0,!=0.41.*,!=0.42.*,>=0.32.0 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/34/db/b10e48aa8fff7407e67470363eac595018441cf32d5e1001567a7aeba5d2/websocket_client-1.9.0-py3-none-any.whl (82 kB)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.32.5)
Collecting requests-oauthlib (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/3b/5d/63d4ae3b9daea098d5d6f5da83984853c1bbacd5dc826764b249fe119d24/requests_oauthlib-2.0.0-py2.py3-none-any.whl (24 kB)
Collecting urllib3<2.4.0,>=1.24.2 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c8/19/4ec628951a74043532ca2cf5d97b7b14863931476d117c471e8e2b1eb39f/urllib3-2.3.0-py3-none-any.whl (128 kB)
Collecting durationpy>=0.7 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/b0/0d/9feae160378a3553fa9a339b0e9c1a048e147a4127210e286ef18b730f03/durationpy-0.10-py3-none-any.whl (3.9 kB)
Collecting cachetools<7.0,>=2.0.0 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/2c/fc/1d7b80d0eb7b714984ce40efc78859c022cd930e402f599d8ca9e39c78a4/cachetools-6.2.4-py3-none-any.whl (11 kB)
Collecting pyasn1-modules>=0.2.1 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/47/8d/d529b5d697919ba8c11ad626e835d4039be708a35b0d22de83a269a6682c/pyasn1_modules-0.4.2-py3-none-any.whl (181 kB)
Collecting rsa<5,>=3.1.4 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/64/8d/0133e4eb4beed9e425d9a98ed6e081a55d195481b7632472be1af08d2f6b/rsa-4.9.1-py3-none-any.whl (34 kB)
Collecting pyasn1>=0.1.3 (from rsa<5,>=3.1.4->google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c8/f1/d6a797abb14f6283c0ddff96bbdd46937f64122b8c925cab503dd37f8214/pyasn1-0.6.1-py3-none-any.whl (83 kB)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.11)
Collecting oauthlib>=3.0.0 (from requests-oauthlib->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/be/9c/92789c596b8df838baa98fa71844d84283302f7604ed565dafe5a6b5041a/oauthlib-3.3.1-py3-none-any.whl (160 kB)
Installing collected packages: durationpy, websocket-client, urllib3, pyasn1, oauthlib, cachetools, rsa, pyasn1-modules, requests-oauthlib, google-auth, kubernetes
  Attempting uninstall: urllib3
    Found existing installation: urllib3 2.5.0
    Uninstalling urllib3-2.5.0:
      Successfully uninstalled urllib3-2.5.0

Successfully installed cachetools-6.2.4 durationpy-0.10 google-auth-2.45.0 kubernetes-34.1.0 oauthlib-3.3.1 pyasn1-0.6.1 pyasn1-modules-0.4.2 requests-oauthlib-2.0.0 rsa-4.9.1 urllib3-2.3.0 websocket-client-1.9.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting xgrammar==0.1.25
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/55/04/55a87e814bcab771d3e4159281fa382b3d5f14a36114f2f9e572728da831/xgrammar-0.1.25-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (8.5 MB)
Requirement already satisfied: pydantic in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.12.5)
Requirement already satisfied: torch>=1.10.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.8.0+cpu)
Requirement already satisfied: transformers>=4.38.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (4.57.1)
Requirement already satisfied: ninja in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (1.13.0)
Requirement already satisfied: numpy in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.4.0)
Requirement already satisfied: typing-extensions>=4.9.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (4.15.0)
Requirement already satisfied: filelock in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.20.0)
Requirement already satisfied: sympy>=1.13.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (1.14.0)
Requirement already satisfied: networkx in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.6.1)
Requirement already satisfied: jinja2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.1.6)
Requirement already satisfied: fsspec in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (2025.10.0)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from sympy>=1.13.3->torch>=1.10.0->xgrammar==0.1.25) (1.3.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.34.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.36.0)
Requirement already satisfied: packaging>=20.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (25.0)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (6.0.3)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (2025.11.3)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (2.32.5)
Requirement already satisfied: tokenizers<=0.23.0,>=0.22.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.22.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.7.0)
Requirement already satisfied: tqdm>=4.27 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (4.67.1)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers>=4.38.0->xgrammar==0.1.25) (1.2.0)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from jinja2->torch>=1.10.0->xgrammar==0.1.25) (2.1.5)
Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (2.41.5)
Requirement already satisfied: typing-inspection>=0.4.2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (0.4.2)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (2025.11.12)
Installing collected packages: xgrammar
  Attempting uninstall: xgrammar
    Found existing installation: xgrammar 0.1.27
    Uninstalling xgrammar-0.1.27:
      Successfully uninstalled xgrammar-0.1.27
Successfully installed xgrammar-0.1.25
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Requirement already satisfied: transformers==4.57.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (4.57.1)
Requirement already satisfied: filelock in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (3.20.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.34.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.36.0)
Requirement already satisfied: numpy>=1.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2.4.0)
Requirement already satisfied: packaging>=20.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (25.0)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (6.0.3)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2025.11.3)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2.32.5)
Requirement already satisfied: tokenizers<=0.23.0,>=0.22.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.22.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.7.0)
Requirement already satisfied: tqdm>=4.27 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (4.67.1)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (2025.10.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (4.15.0)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (1.2.0)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (2025.11.12)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  732k  100  732k    0     0  1027k      0 --:--:-- --:--:-- --:--:-- 1028k
performance
vm.swappiness = 0
kernel.numa_balancing = 0
kernel.sched_migration_cost_ns = 50000
Running test case test/nightly/ascend/performance/test_ascend_qwen3_235b_w8a8_8p_in2k_out2k_50ms.py
Nic name: lo
ENV_VAR PYTORCH_NPU_ALLOC_CONF:expandable_segments:True
ENV_VAR SGLANG_DISAGGREGATION_BOOTSTRAP_TIMEOUT:600
ENV_VAR HCCL_BUFFSIZE:1600
ENV_VAR HCCL_SOCKET_IFNAME:lo
ENV_VAR GLOO_SOCKET_IFNAME:lo
ENV_VAR HCCL_OP_EXPANSION_MODE:AIV
ENV_VAR SGLANG_ENABLE_OVERLAP_PLAN_STREAM:1
ENV_VAR SGLANG_ENABLE_SPEC_V2:1
ENV_VAR SGLANG_SCHEDULER_DECREASE_PREFILL_IDLE:1
ENV_VAR ENABLE_PROFILING:1
command=python3 -m sglang.launch_server --model-path /root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8 --trust-remote-code --nnodes 1 --node-rank 0 --attention-backend ascend --device npu --quantization modelslim --max-running-requests 480 --context-length 8192 --dtype bfloat16 --chunked-prefill-size -1 --max-prefill-tokens 16384 --speculative-draft-model-quantization unquant --speculative-algorithm EAGLE3 --speculative-draft-model-path /root/.cache/modelscope/hub/models/Qwen/Qwen3-235B-A22B-Eagle3 --speculative-num-steps 3 --speculative-eagle-topk 1 --speculative-num-draft-tokens 4 --disable-radix-cache --moe-a2a-backend deepep --deepep-mode auto --tp 16 --dp-size 16 --enable-dp-attention --enable-dp-lm-head --mem-fraction-static 0.78 --cuda-graph-bs 6 8 10 12 15 18 28 30 --device npu --host 127.0.0.1 --port 21000
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-24 01:08:53] WARNING model_config.py:812: modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:08:53] WARNING server_args.py:1773: DP attention is enabled. The chunked prefill size is adjusted to -1 to avoid MoE kernel issues. 
[2025-12-24 01:08:53] WARNING server_args.py:1826: DeepEP MoE is enabled. The expert parallel size is adjusted to be the same as the tensor parallel size[16].
[2025-12-24 01:08:54] server_args=ServerArgs(model_path='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8', tokenizer_path='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8', tokenizer_mode='auto', tokenizer_worker_num=1, skip_tokenizer_init=False, load_format='auto', model_loader_extra_config='{}', trust_remote_code=True, context_length=8192, is_embedding=False, enable_multimodal=None, limit_mm_data_per_request=None, revision=None, model_impl='auto', host='127.0.0.1', port=21000, fastapi_root_path='', grpc_mode=False, skip_server_warmup=False, warmups=None, nccl_port=None, checkpoint_engine_wait_weights_before_ready=False, dtype='bfloat16', quantization='modelslim', quantization_param_path=None, kv_cache_dtype='auto', enable_fp32_lm_head=False, modelopt_quant=None, modelopt_checkpoint_restore_path=None, modelopt_checkpoint_save_path=None, modelopt_export_path=None, quantize_and_serve=False, rl_quant_profile=None, mem_fraction_static=0.78, max_running_requests=480, max_queued_requests=None, max_total_tokens=None, chunked_prefill_size=-1, enable_dynamic_chunking=False, max_prefill_tokens=16384, prefill_max_requests=None, schedule_policy='fcfs', enable_priority_scheduling=False, abort_on_priority_when_disabled=False, schedule_low_priority_values_first=False, priority_scheduling_preemption_threshold=10, schedule_conservativeness=0.3, page_size=128, hybrid_kvcache_ratio=None, swa_full_tokens_ratio=0.8, disable_hybrid_swa_memory=False, radix_eviction_policy='lru', device='npu', tp_size=16, pp_size=1, pp_max_micro_batch_size=None, pp_async_batch_depth=0, stream_interval=1, stream_output=False, random_seed=857102467, constrained_json_whitespace_pattern=None, constrained_json_disable_any_whitespace=False, watchdog_timeout=300, soft_watchdog_timeout=None, dist_timeout=None, download_dir=None, base_gpu_id=0, gpu_id_step=1, sleep_on_idle=False, custom_sigquit_handler=None, log_level='info', log_level_http=None, log_requests=False, log_requests_level=2, crash_dump_folder=None, show_time_cost=False, enable_metrics=False, enable_metrics_for_all_schedulers=False, tokenizer_metrics_custom_labels_header='x-custom-labels', tokenizer_metrics_allowed_custom_labels=None, bucket_time_to_first_token=None, bucket_inter_token_latency=None, bucket_e2e_request_latency=None, collect_tokens_histogram=False, prompt_tokens_buckets=None, generation_tokens_buckets=None, gc_warning_threshold_secs=0.0, decode_log_interval=40, enable_request_time_stats_logging=False, kv_events_config=None, enable_trace=False, otlp_traces_endpoint='localhost:4317', export_metrics_to_file=False, export_metrics_to_file_dir=None, api_key=None, served_model_name='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8', weight_version='default', chat_template=None, completion_template=None, file_storage_path='sglang_storage', enable_cache_report=False, reasoning_parser=None, tool_call_parser=None, tool_server=None, sampling_defaults='model', dp_size=16, load_balance_method='round_robin', load_watch_interval=0.1, prefill_round_robin_balance=False, dist_init_addr=None, nnodes=1, node_rank=0, json_model_override_args='{}', preferred_sampling_params=None, enable_lora=None, max_lora_rank=None, lora_target_modules=None, lora_paths=None, max_loaded_loras=None, max_loras_per_batch=8, lora_eviction_policy='lru', lora_backend='csgmv', max_lora_chunk_size=16, attention_backend='ascend', decode_attention_backend='ascend', prefill_attention_backend='ascend', sampling_backend='pytorch', grammar_backend='xgrammar', mm_attention_backend=None, fp8_gemm_runner_backend='auto', nsa_prefill_backend='flashmla_sparse', nsa_decode_backend='fa3', disable_flashinfer_autotune=False, speculative_algorithm='EAGLE3', speculative_draft_model_path='/root/.cache/modelscope/hub/models/Qwen/Qwen3-235B-A22B-Eagle3', speculative_draft_model_revision='main', speculative_draft_load_format=None, speculative_num_steps=3, speculative_eagle_topk=1, speculative_num_draft_tokens=4, speculative_accept_threshold_single=1.0, speculative_accept_threshold_acc=1.0, speculative_token_map=None, speculative_attention_mode='prefill', speculative_draft_attention_backend=None, speculative_moe_runner_backend='auto', speculative_moe_a2a_backend=None, speculative_draft_model_quantization=None, speculative_ngram_min_match_window_size=1, speculative_ngram_max_match_window_size=12, speculative_ngram_min_bfs_breadth=1, speculative_ngram_max_bfs_breadth=10, speculative_ngram_match_type='BFS', speculative_ngram_branch_length=18, speculative_ngram_capacity=10000000, enable_multi_layer_eagle=False, ep_size=16, moe_a2a_backend='deepep', moe_runner_backend='auto', flashinfer_mxfp4_moe_precision='default', enable_flashinfer_allreduce_fusion=False, deepep_mode='auto', ep_num_redundant_experts=0, ep_dispatch_algorithm=None, init_expert_location='trivial', enable_eplb=False, eplb_algorithm='auto', eplb_rebalance_num_iterations=1000, eplb_rebalance_layers_per_chunk=None, eplb_min_rebalancing_utilization_threshold=1.0, expert_distribution_recorder_mode=None, expert_distribution_recorder_buffer_size=1000, enable_expert_distribution_metrics=False, deepep_config=None, moe_dense_tp_size=None, elastic_ep_backend=None, mooncake_ib_device=None, max_mamba_cache_size=None, mamba_ssm_dtype='float32', mamba_full_memory_ratio=0.9, mamba_scheduler_strategy='no_buffer', mamba_track_interval=256, enable_hierarchical_cache=False, hicache_ratio=2.0, hicache_size=0, hicache_write_policy='write_through', hicache_io_backend='kernel', hicache_mem_layout='layer_first', hicache_storage_backend=None, hicache_storage_prefetch_policy='best_effort', hicache_storage_backend_extra_config=None, enable_lmcache=False, kt_weight_path=None, kt_method='AMXINT4', kt_cpuinfer=None, kt_threadpool_count=2, kt_num_gpu_experts=None, kt_max_deferred_experts_per_token=None, dllm_algorithm=None, dllm_algorithm_config=None, enable_double_sparsity=False, ds_channel_config_path=None, ds_heavy_channel_num=32, ds_heavy_token_num=256, ds_heavy_channel_type='qk', ds_sparse_decode_threshold=4096, cpu_offload_gb=0, offload_group_size=-1, offload_num_in_group=1, offload_prefetch_step=1, offload_mode='cpu', multi_item_scoring_delimiter=None, disable_radix_cache=True, cuda_graph_max_bs=30, cuda_graph_bs=[6, 8, 10, 12, 15, 18, 28, 30], disable_cuda_graph=False, disable_cuda_graph_padding=False, enable_profile_cuda_graph=False, enable_cudagraph_gc=False, enable_layerwise_nvtx_marker=False, enable_nccl_nvls=False, enable_symm_mem=False, disable_flashinfer_cutlass_moe_fp4_allgather=False, enable_tokenizer_batch_encode=False, disable_tokenizer_batch_decode=False, disable_outlines_disk_cache=False, disable_custom_all_reduce=True, enable_mscclpp=False, enable_torch_symm_mem=False, disable_overlap_schedule=False, enable_mixed_chunk=False, enable_dp_attention=True, enable_dp_lm_head=True, enable_two_batch_overlap=False, enable_single_batch_overlap=False, tbo_token_distribution_threshold=0.48, enable_torch_compile=False, enable_piecewise_cuda_graph=False, enable_torch_compile_debug_mode=False, torch_compile_max_bs=32, piecewise_cuda_graph_max_tokens=4096, piecewise_cuda_graph_tokens=[4, 8, 12, 16, 20, 24, 28, 32, 48, 64, 80, 96, 112, 128, 144, 160, 176, 192, 208, 224, 240, 256, 288, 320, 352, 384, 416, 448, 480, 512, 640, 768, 896, 1024, 1152, 1280, 1408, 1536, 1664, 1792, 1920, 2048, 2176, 2304, 2432, 2560, 2688, 2816, 2944, 3072, 3200, 3328, 3456, 3584, 3712, 3840, 3968, 4096], piecewise_cuda_graph_compiler='eager', torchao_config='', enable_nan_detection=False, enable_p2p_check=False, triton_attention_reduce_in_fp32=False, triton_attention_num_kv_splits=8, triton_attention_split_tile_size=None, num_continuous_decode_steps=1, delete_ckpt_after_loading=False, enable_memory_saver=False, enable_weights_cpu_backup=False, enable_draft_weights_cpu_backup=False, allow_auto_truncate=False, enable_custom_logit_processor=False, flashinfer_mla_disable_ragged=False, disable_shared_experts_fusion=False, disable_chunked_prefix_cache=False, disable_fast_image_processor=False, keep_mm_feature_on_device=False, enable_return_hidden_states=False, enable_return_routed_experts=False, scheduler_recv_interval=1, numa_node=None, enable_deterministic_inference=False, rl_on_policy_target=None, enable_attn_tp_input_scattered=False, enable_nsa_prefill_context_parallel=False, enable_fused_qk_norm_rope=False, enable_dynamic_batch_tokenizer=False, dynamic_batch_tokenizer_batch_size=32, dynamic_batch_tokenizer_batch_timeout=0.002, debug_tensor_dump_output_folder=None, debug_tensor_dump_layers=None, debug_tensor_dump_input_file=None, debug_tensor_dump_inject=False, disaggregation_mode='null', disaggregation_transfer_backend='mooncake', disaggregation_bootstrap_port=8998, disaggregation_decode_tp=None, disaggregation_decode_dp=None, disaggregation_prefill_pp=1, disaggregation_ib_device=None, disaggregation_decode_enable_offload_kvcache=False, disaggregation_decode_enable_fake_auto=False, num_reserved_decode_tokens=512, disaggregation_decode_polling_interval=1, encoder_only=False, language_only=False, encoder_transfer_backend='zmq_to_scheduler', encoder_urls=[], custom_weight_loader=[], weight_loader_disable_mmap=False, remote_instance_weight_loader_seed_instance_ip=None, remote_instance_weight_loader_seed_instance_service_port=None, remote_instance_weight_loader_send_weights_group_ports=None, remote_instance_weight_loader_backend='nccl', remote_instance_weight_loader_start_seed_via_transfer_engine=False, enable_pdmux=False, pdmux_config_path=None, sm_group_num=8, mm_max_concurrent_calls=32, mm_per_request_timeout=10.0, enable_broadcast_mm_inputs_process=False, enable_prefix_mm_cache=False, mm_enable_dp_encoder=False, mm_process_config={}, decrypted_config_file=None, decrypted_draft_config_file=None, forward_hooks=None)
[2025-12-24 01:08:54] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:08:54] Using default HuggingFace chat template with detected content format: string
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
[2025-12-24 01:09:13 DP9 TP9 EP9] Process 1749 gpu_id 9 is running on CPUs: [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
[2025-12-24 01:09:13 DP10 TP10 EP10] Process 1750 gpu_id 10 is running on CPUs: [200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219]
[2025-12-24 01:09:13 DP1 TP1 EP1] Process 1741 gpu_id 1 is running on CPUs: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
[2025-12-24 01:09:13 DP3 TP3 EP3] Process 1743 gpu_id 3 is running on CPUs: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
[2025-12-24 01:09:13 DP10 TP10 EP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:13 DP9 TP9 EP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
[2025-12-24 01:09:13 DP1 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:13 DP3 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-24 01:09:14 DP7 TP7 EP7] Process 1747 gpu_id 7 is running on CPUs: [140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
[2025-12-24 01:09:14 DP7 TP7 EP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-24 01:09:14 DP0 TP0 EP0] Process 1740 gpu_id 0 is running on CPUs: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[2025-12-24 01:09:14 DP0 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:14 DP13 TP13 EP13] Process 2445 gpu_id 13 is running on CPUs: [260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279]
[2025-12-24 01:09:14 DP13 TP13 EP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-24 01:09:14 DP11 TP11 EP11] Process 2435 gpu_id 11 is running on CPUs: [220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[2025-12-24 01:09:14 DP11 TP11 EP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:14 DP12 TP12 EP12] Process 2437 gpu_id 12 is running on CPUs: [240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259]
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
[2025-12-24 01:09:14 DP12 TP12 EP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-24 01:09:14 DP10 TP10 EP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:14 DP10 TP10 EP10] Init torch distributed begin.
[2025-12-24 01:09:14 DP2 TP2 EP2] Process 1742 gpu_id 2 is running on CPUs: [40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
[2025-12-24 01:09:14 DP9 TP9 EP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:14 DP9 TP9 EP9] Init torch distributed begin.
[2025-12-24 01:09:14 DP2 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:14 DP3 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:14 DP3 TP3 EP3] Init torch distributed begin.
[2025-12-24 01:09:15 DP1 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP1 TP1 EP1] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-24 01:09:15 DP8 TP8 EP8] Process 1748 gpu_id 8 is running on CPUs: [160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
[2025-12-24 01:09:15 DP8 TP8 EP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP6 TP6 EP6] Process 1746 gpu_id 6 is running on CPUs: [120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
[2025-12-24 01:09:15 DP6 TP6 EP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP14 TP14 EP14] Process 2447 gpu_id 14 is running on CPUs: [280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299]
[2025-12-24 01:09:15 DP14 TP14 EP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP4 TP4 EP4] Process 1744 gpu_id 4 is running on CPUs: [80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
[2025-12-24 01:09:15 DP4 TP4 EP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP15 TP15 EP15] Process 2448 gpu_id 15 is running on CPUs: [300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319]
[2025-12-24 01:09:15 DP5 TP5 EP5] Process 1745 gpu_id 5 is running on CPUs: [100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
[2025-12-24 01:09:15 DP15 TP15 EP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP5 TP5 EP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-24 01:09:15 DP7 TP7 EP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP7 TP7 EP7] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-24 01:09:15 DP13 TP13 EP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP13 TP13 EP13] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-24 01:09:15 DP0 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP0 TP0 EP0] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-24 01:09:15 DP12 TP12 EP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP12 TP12 EP12] Init torch distributed begin.
[2025-12-24 01:09:15 DP11 TP11 EP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP11 TP11 EP11] Init torch distributed begin.
[2025-12-24 01:09:15 DP2 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP2 TP2 EP2] Init torch distributed begin.
[2025-12-24 01:09:15 DP8 TP8 EP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP8 TP8 EP8] Init torch distributed begin.
[2025-12-24 01:09:15 DP6 TP6 EP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP6 TP6 EP6] Init torch distributed begin.
[2025-12-24 01:09:15 DP14 TP14 EP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:15 DP14 TP14 EP14] Init torch distributed begin.
[2025-12-24 01:09:16 DP4 TP4 EP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:16 DP4 TP4 EP4] Init torch distributed begin.
[2025-12-24 01:09:16 DP15 TP15 EP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:16 DP15 TP15 EP15] Init torch distributed begin.
[2025-12-24 01:09:16 DP5 TP5 EP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-24 01:09:16 DP5 TP5 EP5] Init torch distributed begin.
[Gloo] Rank 0 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 2 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 1 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 3 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 14 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 9 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 4 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 5 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 6 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 7 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 8 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 10 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 12 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 11 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 13 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 15 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 1 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 2 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 3 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 4 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 5 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 6 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 7 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 10 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 8 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 9 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 11 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 12 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 14 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 13 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 15 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[2025-12-24 01:09:17 DP0 TP0 EP0] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP14 TP14 EP14] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP15 TP15 EP15] Init torch distributed ends. mem usage=0.00 GB
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[2025-12-24 01:09:17 DP13 TP13 EP13] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP12 TP12 EP12] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP11 TP11 EP11] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP10 TP10 EP10] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP8 TP8 EP8] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP9 TP9 EP9] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP7 TP7 EP7] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP6 TP6 EP6] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP5 TP5 EP5] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP3 TP3 EP3] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP2 TP2 EP2] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP4 TP4 EP4] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:17 DP1 TP1 EP1] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:09:18 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.glmasr: cannot import name 'GlmasrConfig' from 'transformers' (/usr/local/python3.11.13/lib/python3.11/site-packages/transformers/__init__.py)
[2025-12-24 01:09:18 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-24 01:09:18 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:18 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-24 01:09:20 DP12 TP12 EP12] Load weight begin. avail mem=60.87 GB
[2025-12-24 01:09:20 DP10 TP10 EP10] Load weight begin. avail mem=60.87 GB
[2025-12-24 01:09:20 DP13 TP13 EP13] Load weight begin. avail mem=61.10 GB
[2025-12-24 01:09:20 DP15 TP15 EP15] Load weight begin. avail mem=61.10 GB
[2025-12-24 01:09:20 DP14 TP14 EP14] Load weight begin. avail mem=60.88 GB
[2025-12-24 01:09:20 DP8 TP8 EP8] Load weight begin. avail mem=60.87 GB
[2025-12-24 01:09:20 DP4 TP4 EP4] Load weight begin. avail mem=60.87 GB
[2025-12-24 01:09:20 DP7 TP7 EP7] Load weight begin. avail mem=61.10 GB
[2025-12-24 01:09:20 DP9 TP9 EP9] Load weight begin. avail mem=61.10 GB
[2025-12-24 01:09:20 DP5 TP5 EP5] Load weight begin. avail mem=61.10 GB
[2025-12-24 01:09:20 DP6 TP6 EP6] Load weight begin. avail mem=60.87 GB
[2025-12-24 01:09:20 DP11 TP11 EP11] Load weight begin. avail mem=61.10 GB
[2025-12-24 01:09:20 DP1 TP1 EP1] Load weight begin. avail mem=61.10 GB
[2025-12-24 01:09:20 DP0 TP0 EP0] Load weight begin. avail mem=60.81 GB
[2025-12-24 01:09:20 DP2 TP2 EP2] Load weight begin. avail mem=60.87 GB
[2025-12-24 01:09:20 DP3 TP3 EP3] Load weight begin. avail mem=61.10 GB

Loading safetensors checkpoint shards:   0% Completed | 0/56 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:   2% Completed | 1/56 [00:02<02:31,  2.75s/it]

Loading safetensors checkpoint shards:   4% Completed | 2/56 [00:06<02:46,  3.08s/it]

Loading safetensors checkpoint shards:   5% Completed | 3/56 [00:09<02:45,  3.12s/it]

Loading safetensors checkpoint shards:   7% Completed | 4/56 [00:12<02:46,  3.21s/it]

Loading safetensors checkpoint shards:   9% Completed | 5/56 [00:15<02:46,  3.26s/it]

Loading safetensors checkpoint shards:  11% Completed | 6/56 [00:19<02:44,  3.29s/it]

Loading safetensors checkpoint shards:  12% Completed | 7/56 [00:22<02:42,  3.32s/it]

Loading safetensors checkpoint shards:  14% Completed | 8/56 [00:26<02:40,  3.33s/it]

Loading safetensors checkpoint shards:  16% Completed | 9/56 [00:29<02:34,  3.28s/it]

Loading safetensors checkpoint shards:  18% Completed | 10/56 [00:32<02:34,  3.36s/it]

Loading safetensors checkpoint shards:  20% Completed | 11/56 [00:36<02:31,  3.37s/it]

Loading safetensors checkpoint shards:  21% Completed | 12/56 [00:39<02:26,  3.34s/it]

Loading safetensors checkpoint shards:  23% Completed | 13/56 [00:42<02:23,  3.33s/it]

Loading safetensors checkpoint shards:  25% Completed | 14/56 [00:45<02:14,  3.20s/it]

Loading safetensors checkpoint shards:  27% Completed | 15/56 [00:49<02:15,  3.31s/it]

Loading safetensors checkpoint shards:  29% Completed | 16/56 [00:52<02:12,  3.31s/it]

Loading safetensors checkpoint shards:  30% Completed | 17/56 [00:55<02:09,  3.33s/it]

Loading safetensors checkpoint shards:  32% Completed | 18/56 [00:59<02:06,  3.32s/it]

Loading safetensors checkpoint shards:  34% Completed | 19/56 [01:02<02:01,  3.28s/it]

Loading safetensors checkpoint shards:  36% Completed | 20/56 [01:04<01:48,  3.01s/it]

Loading safetensors checkpoint shards:  38% Completed | 21/56 [01:07<01:48,  3.10s/it]

Loading safetensors checkpoint shards:  39% Completed | 22/56 [01:11<01:46,  3.13s/it]

Loading safetensors checkpoint shards:  41% Completed | 23/56 [01:14<01:44,  3.15s/it]

Loading safetensors checkpoint shards:  43% Completed | 24/56 [01:17<01:41,  3.16s/it]

Loading safetensors checkpoint shards:  45% Completed | 25/56 [01:20<01:38,  3.19s/it]

Loading safetensors checkpoint shards:  46% Completed | 26/56 [01:24<01:36,  3.21s/it]

Loading safetensors checkpoint shards:  48% Completed | 27/56 [01:28<01:45,  3.63s/it]

Loading safetensors checkpoint shards:  50% Completed | 28/56 [01:32<01:38,  3.53s/it]

Loading safetensors checkpoint shards:  52% Completed | 29/56 [01:35<01:33,  3.48s/it]

Loading safetensors checkpoint shards:  54% Completed | 30/56 [01:38<01:28,  3.41s/it]

Loading safetensors checkpoint shards:  55% Completed | 31/56 [01:41<01:24,  3.38s/it]

Loading safetensors checkpoint shards:  57% Completed | 32/56 [01:45<01:20,  3.37s/it]

Loading safetensors checkpoint shards:  59% Completed | 33/56 [01:48<01:17,  3.36s/it]

Loading safetensors checkpoint shards:  61% Completed | 34/56 [01:51<01:13,  3.32s/it]

Loading safetensors checkpoint shards:  62% Completed | 35/56 [01:55<01:09,  3.32s/it]

Loading safetensors checkpoint shards:  64% Completed | 36/56 [01:58<01:06,  3.31s/it]

Loading safetensors checkpoint shards:  66% Completed | 37/56 [02:01<01:03,  3.35s/it]

Loading safetensors checkpoint shards:  68% Completed | 38/56 [02:05<00:59,  3.30s/it]

Loading safetensors checkpoint shards:  70% Completed | 39/56 [02:08<00:55,  3.28s/it]

Loading safetensors checkpoint shards:  71% Completed | 40/56 [02:11<00:52,  3.29s/it]

Loading safetensors checkpoint shards:  73% Completed | 41/56 [02:14<00:48,  3.23s/it]

Loading safetensors checkpoint shards:  75% Completed | 42/56 [02:17<00:44,  3.20s/it]

Loading safetensors checkpoint shards:  77% Completed | 43/56 [02:20<00:41,  3.18s/it]

Loading safetensors checkpoint shards:  79% Completed | 44/56 [02:24<00:38,  3.19s/it]

Loading safetensors checkpoint shards:  80% Completed | 45/56 [02:27<00:35,  3.20s/it]

Loading safetensors checkpoint shards:  82% Completed | 46/56 [02:30<00:31,  3.17s/it]

Loading safetensors checkpoint shards:  84% Completed | 47/56 [02:34<00:29,  3.28s/it]

Loading safetensors checkpoint shards:  86% Completed | 48/56 [02:37<00:26,  3.32s/it]

Loading safetensors checkpoint shards:  88% Completed | 49/56 [02:40<00:23,  3.31s/it]

Loading safetensors checkpoint shards:  89% Completed | 50/56 [02:44<00:19,  3.33s/it]

Loading safetensors checkpoint shards:  91% Completed | 51/56 [02:47<00:16,  3.33s/it]

Loading safetensors checkpoint shards:  93% Completed | 52/56 [02:50<00:13,  3.34s/it]

Loading safetensors checkpoint shards:  95% Completed | 53/56 [02:54<00:10,  3.35s/it]

Loading safetensors checkpoint shards:  96% Completed | 54/56 [02:57<00:06,  3.34s/it]

Loading safetensors checkpoint shards:  98% Completed | 55/56 [03:00<00:03,  3.37s/it]

Loading safetensors checkpoint shards: 100% Completed | 56/56 [03:04<00:00,  3.35s/it]

Loading safetensors checkpoint shards: 100% Completed | 56/56 [03:04<00:00,  3.29s/it]

[2025-12-24 01:13:26 DP9 TP9 EP9] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.33 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP13 TP13 EP13] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.32 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP10 TP10 EP10] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.10 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP12 TP12 EP12] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.10 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP3 TP3 EP3] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.33 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP11 TP11 EP11] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.32 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP14 TP14 EP14] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.10 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP6 TP6 EP6] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.09 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP2 TP2 EP2] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.09 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP7 TP7 EP7] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.33 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP15 TP15 EP15] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.32 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP8 TP8 EP8] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.09 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP5 TP5 EP5] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.32 GB, mem usage=23.78 GB.
[2025-12-24 01:13:26 DP0 TP0 EP0] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.03 GB, mem usage=23.78 GB.
[2025-12-24 01:13:27 DP4 TP4 EP4] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.09 GB, mem usage=23.78 GB.
[2025-12-24 01:13:27 DP1 TP1 EP1] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=37.32 GB, mem usage=23.78 GB.
[2025-12-24 01:13:27 DP0 TP0 EP0] Using KV cache dtype: torch.bfloat16
[2025-12-24 01:13:27 DP0 TP0 EP0] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP15 TP15 EP15] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP14 TP14 EP14] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP13 TP13 EP13] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP12 TP12 EP12] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP11 TP11 EP11] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP10 TP10 EP10] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP9 TP9 EP9] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP8 TP8 EP8] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP7 TP7 EP7] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP6 TP6 EP6] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP5 TP5 EP5] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP4 TP4 EP4] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP1 TP1 EP1] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP3 TP3 EP3] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP2 TP2 EP2] The available memory for KV cache is 23.65 GB.
[2025-12-24 01:13:27 DP11 TP11 EP11] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP12 TP12 EP12] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP6 TP6 EP6] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP3 TP3 EP3] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP14 TP14 EP14] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP5 TP5 EP5] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP0 TP0 EP0] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP7 TP7 EP7] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP4 TP4 EP4] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP1 TP1 EP1] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP9 TP9 EP9] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP2 TP2 EP2] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP8 TP8 EP8] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP13 TP13 EP13] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP10 TP10 EP10] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP15 TP15 EP15] KV Cache is allocated. #tokens: 135296, K size: 12.14 GB, V size: 12.14 GB
[2025-12-24 01:13:27 DP6 TP6 EP6] Memory pool end. avail mem=12.80 GB
[2025-12-24 01:13:27 DP11 TP11 EP11] Memory pool end. avail mem=13.02 GB
[2025-12-24 01:13:27 DP12 TP12 EP12] Memory pool end. avail mem=12.80 GB
[2025-12-24 01:13:27 DP3 TP3 EP3] Memory pool end. avail mem=13.03 GB
[2025-12-24 01:13:27 DP14 TP14 EP14] Memory pool end. avail mem=12.80 GB
[2025-12-24 01:13:27 DP5 TP5 EP5] Memory pool end. avail mem=13.03 GB
[2025-12-24 01:13:27 DP0 TP0 EP0] Memory pool end. avail mem=12.74 GB
[2025-12-24 01:13:27 DP7 TP7 EP7] Memory pool end. avail mem=13.03 GB
[2025-12-24 01:13:27 DP4 TP4 EP4] Memory pool end. avail mem=12.80 GB
[2025-12-24 01:13:27 DP1 TP1 EP1] Memory pool end. avail mem=13.02 GB
[2025-12-24 01:13:27 DP2 TP2 EP2] Memory pool end. avail mem=12.80 GB
[2025-12-24 01:13:27 DP9 TP9 EP9] Memory pool end. avail mem=13.03 GB
[2025-12-24 01:13:27 DP8 TP8 EP8] Memory pool end. avail mem=12.79 GB
[2025-12-24 01:13:27 DP13 TP13 EP13] Memory pool end. avail mem=13.03 GB
[2025-12-24 01:13:27 DP10 TP10 EP10] Memory pool end. avail mem=12.80 GB
[2025-12-24 01:13:27 DP15 TP15 EP15] Memory pool end. avail mem=13.02 GB
[2025-12-24 01:13:27 DP15 TP15 EP15] Capture cuda graph begin. This can take up to several minutes. avail mem=13.02 GB
[2025-12-24 01:13:27 DP14 TP14 EP14] Capture cuda graph begin. This can take up to several minutes. avail mem=12.80 GB
[2025-12-24 01:13:27 DP12 TP12 EP12] Capture cuda graph begin. This can take up to several minutes. avail mem=12.80 GB
[2025-12-24 01:13:27 DP13 TP13 EP13] Capture cuda graph begin. This can take up to several minutes. avail mem=13.03 GB
[2025-12-24 01:13:27 DP9 TP9 EP9] Capture cuda graph begin. This can take up to several minutes. avail mem=13.03 GB
[2025-12-24 01:13:27 DP7 TP7 EP7] Capture cuda graph begin. This can take up to several minutes. avail mem=13.03 GB
[2025-12-24 01:13:27 DP8 TP8 EP8] Capture cuda graph begin. This can take up to several minutes. avail mem=12.79 GB
[2025-12-24 01:13:27 DP5 TP5 EP5] Capture cuda graph begin. This can take up to several minutes. avail mem=13.03 GB
[2025-12-24 01:13:27 DP6 TP6 EP6] Capture cuda graph begin. This can take up to several minutes. avail mem=12.80 GB
[2025-12-24 01:13:27 DP10 TP10 EP10] Capture cuda graph begin. This can take up to several minutes. avail mem=12.80 GB
[2025-12-24 01:13:27 DP11 TP11 EP11] Capture cuda graph begin. This can take up to several minutes. avail mem=13.02 GB
[2025-12-24 01:13:27 DP4 TP4 EP4] Capture cuda graph begin. This can take up to several minutes. avail mem=12.80 GB
[2025-12-24 01:13:27 DP1 TP1 EP1] Capture cuda graph begin. This can take up to several minutes. avail mem=13.02 GB
[2025-12-24 01:13:27 DP0 TP0 EP0] Capture cuda graph begin. This can take up to several minutes. avail mem=12.74 GB
[2025-12-24 01:13:27 DP0 TP0 EP0] Capture cuda graph bs [6, 8, 10, 12, 15, 18, 28, 30]
[2025-12-24 01:13:27 DP2 TP2 EP2] Capture cuda graph begin. This can take up to several minutes. avail mem=12.80 GB
[2025-12-24 01:13:27 DP3 TP3 EP3] Capture cuda graph begin. This can take up to several minutes. avail mem=13.03 GB

  0%|          | 0/8 [00:00<?, ?it/s]
Capturing batches (bs=30 avail_mem=12.67 GB):   0%|          | 0/8 [00:00<?, ?it/s]
Capturing batches (bs=30 avail_mem=12.67 GB):  12%|        | 1/8 [00:30<03:35, 30.84s/it]
Capturing batches (bs=28 avail_mem=9.06 GB):  12%|        | 1/8 [00:30<03:35, 30.84s/it] 
Capturing batches (bs=28 avail_mem=9.06 GB):  25%|       | 2/8 [00:32<01:23, 13.86s/it]
Capturing batches (bs=18 avail_mem=9.05 GB):  25%|       | 2/8 [00:32<01:23, 13.86s/it]
Capturing batches (bs=18 avail_mem=9.05 GB):  38%|      | 3/8 [00:33<00:39,  7.87s/it]
Capturing batches (bs=15 avail_mem=9.04 GB):  38%|      | 3/8 [00:33<00:39,  7.87s/it]
Capturing batches (bs=15 avail_mem=9.04 GB):  50%|     | 4/8 [00:34<00:20,  5.06s/it]
Capturing batches (bs=12 avail_mem=9.03 GB):  50%|     | 4/8 [00:34<00:20,  5.06s/it]
Capturing batches (bs=12 avail_mem=9.03 GB):  62%|   | 5/8 [00:35<00:10,  3.50s/it]
Capturing batches (bs=10 avail_mem=9.02 GB):  62%|   | 5/8 [00:35<00:10,  3.50s/it]
Capturing batches (bs=10 avail_mem=9.02 GB):  75%|  | 6/8 [00:35<00:05,  2.57s/it]
Capturing batches (bs=8 avail_mem=9.01 GB):  75%|  | 6/8 [00:35<00:05,  2.57s/it] 
Capturing batches (bs=8 avail_mem=9.01 GB):  88%| | 7/8 [00:37<00:02,  2.42s/it]
Capturing batches (bs=6 avail_mem=9.01 GB):  88%| | 7/8 [00:37<00:02,  2.42s/it]
Capturing batches (bs=6 avail_mem=9.01 GB): 100%|| 8/8 [00:38<00:00,  1.86s/it]
Capturing batches (bs=6 avail_mem=9.01 GB): 100%|| 8/8 [00:38<00:00,  4.82s/it]
[2025-12-24 01:14:07 DP10 TP10 EP10] Capture cuda graph end. Time elapsed: 39.64 s. mem usage=3.74 GB. avail mem=9.06 GB.
[2025-12-24 01:14:07 DP12 TP12 EP12] Capture cuda graph end. Time elapsed: 39.66 s. mem usage=3.74 GB. avail mem=9.06 GB.
[2025-12-24 01:14:07 DP13 TP13 EP13] Capture cuda graph end. Time elapsed: 39.68 s. mem usage=3.74 GB. avail mem=9.29 GB.
[2025-12-24 01:14:07 DP15 TP15 EP15] Capture cuda graph end. Time elapsed: 39.81 s. mem usage=3.74 GB. avail mem=9.29 GB.
[2025-12-24 01:14:07 DP8 TP8 EP8] Capture cuda graph end. Time elapsed: 39.82 s. mem usage=3.74 GB. avail mem=9.06 GB.
[2025-12-24 01:14:07 DP9 TP9 EP9] Capture cuda graph end. Time elapsed: 39.84 s. mem usage=3.74 GB. avail mem=9.29 GB.
[2025-12-24 01:14:07 DP4 TP4 EP4] Capture cuda graph end. Time elapsed: 39.85 s. mem usage=3.74 GB. avail mem=9.06 GB.
[2025-12-24 01:14:07 DP7 TP7 EP7] Capture cuda graph end. Time elapsed: 39.85 s. mem usage=3.74 GB. avail mem=9.29 GB.
[2025-12-24 01:14:07 DP14 TP14 EP14] Capture cuda graph end. Time elapsed: 39.86 s. mem usage=3.74 GB. avail mem=9.06 GB.
[2025-12-24 01:14:07 DP5 TP5 EP5] Capture cuda graph end. Time elapsed: 39.87 s. mem usage=3.74 GB. avail mem=9.29 GB.
[2025-12-24 01:14:07 DP6 TP6 EP6] Capture cuda graph end. Time elapsed: 39.87 s. mem usage=3.74 GB. avail mem=9.06 GB.
[2025-12-24 01:14:07 DP11 TP11 EP11] Capture cuda graph end. Time elapsed: 39.88 s. mem usage=3.74 GB. avail mem=9.29 GB.
[2025-12-24 01:14:07 DP0 TP0 EP0] Capture cuda graph end. Time elapsed: 39.93 s. mem usage=3.74 GB. avail mem=9.00 GB.
[2025-12-24 01:14:07 DP1 TP1 EP1] Capture cuda graph end. Time elapsed: 39.94 s. mem usage=3.74 GB. avail mem=9.28 GB.
[2025-12-24 01:14:07 DP2 TP2 EP2] Capture cuda graph end. Time elapsed: 39.96 s. mem usage=3.74 GB. avail mem=9.06 GB.
[2025-12-24 01:14:07 DP3 TP3 EP3] Capture cuda graph end. Time elapsed: 39.98 s. mem usage=3.74 GB. avail mem=9.29 GB.
/data/d00662834/1211_dev/sglang/python/sglang/srt/utils/common.py:1204: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  tensor_data = torch.ByteTensor(
[2025-12-24 01:14:07 DP13 TP13 EP13] Init torch distributed begin.
[2025-12-24 01:14:07 DP15 TP15 EP15] Init torch distributed begin.
[2025-12-24 01:14:07 DP12 TP12 EP12] Init torch distributed begin.
[2025-12-24 01:14:07 DP14 TP14 EP14] Init torch distributed begin.
[2025-12-24 01:14:07 DP10 TP10 EP10] Init torch distributed begin.
[2025-12-24 01:14:07 DP6 TP6 EP6] Init torch distributed begin.
[2025-12-24 01:14:07 DP5 TP5 EP5] Init torch distributed begin.
[2025-12-24 01:14:07 DP4 TP4 EP4] Init torch distributed begin.
[2025-12-24 01:14:07 DP9 TP9 EP9] Init torch distributed begin.
[2025-12-24 01:14:07 DP8 TP8 EP8] Init torch distributed begin.
[2025-12-24 01:14:07 DP7 TP7 EP7] Init torch distributed begin.
[2025-12-24 01:14:07 DP11 TP11 EP11] Init torch distributed begin.
[2025-12-24 01:14:07 DP0 TP0 EP0] Init torch distributed begin.
[2025-12-24 01:14:07 DP1 TP1 EP1] Init torch distributed begin.
[2025-12-24 01:14:07 DP2 TP2 EP2] Init torch distributed begin.
[2025-12-24 01:14:07 DP3 TP3 EP3] Init torch distributed begin.
[2025-12-24 01:14:07 DP14 TP14 EP14] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP0 TP0 EP0] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP13 TP13 EP13] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP12 TP12 EP12] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP7 TP7 EP7] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP10 TP10 EP10] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP11 TP11 EP11] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP9 TP9 EP9] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP8 TP8 EP8] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP15 TP15 EP15] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP5 TP5 EP5] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP1 TP1 EP1] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP4 TP4 EP4] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP2 TP2 EP2] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP3 TP3 EP3] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP0 TP0 EP0] Load weight begin. avail mem=9.00 GB
[2025-12-24 01:14:07 DP14 TP14 EP14] Load weight begin. avail mem=9.06 GB
[2025-12-24 01:14:07 DP7 TP7 EP7] Load weight begin. avail mem=9.29 GB
[2025-12-24 01:14:07 DP12 TP12 EP12] Load weight begin. avail mem=9.06 GB
[2025-12-24 01:14:07 DP10 TP10 EP10] Load weight begin. avail mem=9.06 GB
[2025-12-24 01:14:07 DP13 TP13 EP13] Load weight begin. avail mem=9.29 GB
[2025-12-24 01:14:07 DP15 TP15 EP15] Load weight begin. avail mem=9.29 GB
[2025-12-24 01:14:07 DP11 TP11 EP11] Load weight begin. avail mem=9.29 GB
[2025-12-24 01:14:07 DP1 TP1 EP1] Load weight begin. avail mem=9.28 GB
[2025-12-24 01:14:07 DP4 TP4 EP4] Load weight begin. avail mem=9.06 GB
[2025-12-24 01:14:07 DP9 TP9 EP9] Load weight begin. avail mem=9.29 GB
[2025-12-24 01:14:07 DP8 TP8 EP8] Load weight begin. avail mem=9.06 GB
[2025-12-24 01:14:07 DP2 TP2 EP2] Load weight begin. avail mem=9.06 GB
[2025-12-24 01:14:07 DP5 TP5 EP5] Load weight begin. avail mem=9.29 GB
[2025-12-24 01:14:07 DP3 TP3 EP3] Load weight begin. avail mem=9.29 GB
[2025-12-24 01:14:07 DP6 TP6 EP6] Init torch distributed ends. mem usage=0.00 GB
[2025-12-24 01:14:07 DP6 TP6 EP6] Load weight begin. avail mem=9.06 GB

Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]

Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.36it/s]

Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:00<00:00,  1.35it/s]

[2025-12-24 01:14:08 DP1 TP1 EP1] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.05 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP0 TP0 EP0] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=8.76 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP14 TP14 EP14] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=8.83 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP12 TP12 EP12] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=8.82 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP11 TP11 EP11] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.05 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP6 TP6 EP6] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=8.82 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP15 TP15 EP15] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.05 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP9 TP9 EP9] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.06 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP8 TP8 EP8] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=8.82 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP10 TP10 EP10] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=8.83 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP2 TP2 EP2] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=8.82 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP3 TP3 EP3] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.06 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP7 TP7 EP7] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.06 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP4 TP4 EP4] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=8.82 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP5 TP5 EP5] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.05 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP13 TP13 EP13] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.05 GB, mem usage=0.24 GB.
[2025-12-24 01:14:08 DP0 TP0 EP0] Using KV cache dtype: torch.bfloat16
[2025-12-24 01:14:08 DP0 TP0 EP0] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP15 TP15 EP15] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP14 TP14 EP14] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP13 TP13 EP13] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP12 TP12 EP12] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP11 TP11 EP11] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP10 TP10 EP10] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP9 TP9 EP9] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP8 TP8 EP8] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP7 TP7 EP7] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP6 TP6 EP6] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP5 TP5 EP5] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP4 TP4 EP4] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP3 TP3 EP3] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP2 TP2 EP2] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP1 TP1 EP1] The available memory for KV cache is 6.78 GB.
[2025-12-24 01:14:08 DP14 TP14 EP14] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP12 TP12 EP12] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP15 TP15 EP15] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP0 TP0 EP0] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP13 TP13 EP13] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP10 TP10 EP10] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP11 TP11 EP11] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP9 TP9 EP9] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP8 TP8 EP8] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP6 TP6 EP6] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP7 TP7 EP7] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP5 TP5 EP5] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP4 TP4 EP4] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP1 TP1 EP1] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP2 TP2 EP2] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP3 TP3 EP3] KV Cache is allocated. #tokens: 135296, K size: 0.13 GB, V size: 0.13 GB
[2025-12-24 01:14:08 DP0 TP0 EP0] Memory pool end. avail mem=8.51 GB
[2025-12-24 01:14:08 DP14 TP14 EP14] Memory pool end. avail mem=8.57 GB
[2025-12-24 01:14:08 DP12 TP12 EP12] Memory pool end. avail mem=8.57 GB
[2025-12-24 01:14:08 DP15 TP15 EP15] Memory pool end. avail mem=8.80 GB
[2025-12-24 01:14:08 DP13 TP13 EP13] Memory pool end. avail mem=8.80 GB
[2025-12-24 01:14:08 DP10 TP10 EP10] Memory pool end. avail mem=8.57 GB
[2025-12-24 01:14:08 DP8 TP8 EP8] Memory pool end. avail mem=8.57 GB
[2025-12-24 01:14:08 DP11 TP11 EP11] Memory pool end. avail mem=8.80 GB
[2025-12-24 01:14:08 DP6 TP6 EP6] Memory pool end. avail mem=8.57 GB
[2025-12-24 01:14:08 DP7 TP7 EP7] Memory pool end. avail mem=8.80 GB
[2025-12-24 01:14:08 DP1 TP1 EP1] Memory pool end. avail mem=8.79 GB
[2025-12-24 01:14:08 DP9 TP9 EP9] Memory pool end. avail mem=8.80 GB
[2025-12-24 01:14:08 DP4 TP4 EP4] Memory pool end. avail mem=8.57 GB
[2025-12-24 01:14:08 DP5 TP5 EP5] Memory pool end. avail mem=8.80 GB
[2025-12-24 01:14:08 DP3 TP3 EP3] Memory pool end. avail mem=8.80 GB
[2025-12-24 01:14:08 DP2 TP2 EP2] Memory pool end. avail mem=8.57 GB
[2025-12-24 01:14:09 DP12 TP12 EP12] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.69 GB
[2025-12-24 01:14:09 DP13 TP13 EP13] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.92 GB
[2025-12-24 01:14:09 DP15 TP15 EP15] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.91 GB
[2025-12-24 01:14:09 DP14 TP14 EP14] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.69 GB
[2025-12-24 01:14:09 DP5 TP5 EP5] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.91 GB
[2025-12-24 01:14:09 DP4 TP4 EP4] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.69 GB
[2025-12-24 01:14:09 DP8 TP8 EP8] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.68 GB
[2025-12-24 01:14:09 DP9 TP9 EP9] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.92 GB
[2025-12-24 01:14:09 DP0 TP0 EP0] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.62 GB
[2025-12-24 01:14:09 DP1 TP1 EP1] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.91 GB
[2025-12-24 01:14:09 DP10 TP10 EP10] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.69 GB
[2025-12-24 01:14:09 DP11 TP11 EP11] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.91 GB
[2025-12-24 01:14:09 DP6 TP6 EP6] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.68 GB
[2025-12-24 01:14:09 DP3 TP3 EP3] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.92 GB
[2025-12-24 01:14:09 DP2 TP2 EP2] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.68 GB
[2025-12-24 01:14:09 DP7 TP7 EP7] Capture draft cuda graph begin. This can take up to several minutes. avail mem=8.92 GB
................................mki_log mkdir /root/ascend/log/atb
mki_log mkdir /root/ascend/log/atb
mki_log mkdir /root/ascend/log/atb
mki_log mkdir /root/ascend/log/atb

  0%|          | 0/8 [00:00<?, ?it/s]
Capturing batches (bs=30 avail_mem=8.62 GB):   0%|          | 0/8 [00:00<?, ?it/s][rank15]:[E1224 01:14:28.932556327 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe251a48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe2514c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffced83c8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffced83dec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffcfb448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcf93cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcf93cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcf93ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffffafe129cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffffb2610398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffffb2679e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank8]:[E1224 01:14:28.932566777 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdfb3748c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdfb31c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcbf9cc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcbf9cdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffccf448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffccd3cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffccd3cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffccd3ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff85fe29cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff887e0398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff88849e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank12]:[E1224 01:14:28.932591797 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf37048c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf36ac140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcb7d7c8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcb7d7dec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffccebe8764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcccb6b510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcccb6c0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcccb6a008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff7e3729cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff80b70398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff80bd9e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank9]:[E1224 01:14:28.932593427 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdffea48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdffe4c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcc853c8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcc853dec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffcd7348764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcd52cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcd52cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcd52ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff8ab129cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff8d310398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff8d379e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank0]:[E1224 01:14:28.932592307 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe1e4948c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe1e43c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffce2afc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffce2afdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffcf3448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcf13cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcf13cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcf13ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffffa91029cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffffab900398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffffab969e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank1]:[E1224 01:14:28.932591457 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe0e9648c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0e90c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcd2ffc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcd2ffdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffce3448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffce13cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffce13cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffce13ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff995d29cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff9bdd0398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff9be39e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank3]:[E1224 01:14:28.932593537 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe0b4948c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0b43c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffccfafc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffccfafdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffcdf448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcdd3cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcdd3cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcdd3ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff961029cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff98900398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff98969e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank2]:[E1224 01:14:28.932591937 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf2f348c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf2edc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcb74fc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcb74fdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffcc7448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcc53cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcc53cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcc53ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff7dba29cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff803a0398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff80409e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank13]:[E1224 01:14:28.932602847 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdfcf348c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdfcedc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcc55ac8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcc55adec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffcd3448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcd13cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcd13cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcd13ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff87ba29cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff8a3a0398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff8a409e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank14]:[E1224 01:14:28.932602577 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe2d0348c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe2cfdc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcf56cc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcf56cdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffd03448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffd013cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffd013cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffd013ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffffb7ca29cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffffba4a0398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffffba509e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank11]:[E1224 01:14:28.932608357 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf75248c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf74cc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcbbb7c8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcbbb7dec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffccb448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcc93cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcc93cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcc93ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff821929cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff84990398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff849f9e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank10]:[E1224 01:14:28.932608107 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdfe0f48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdfe09c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcc26fc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcc26fdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffcd3448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcd13cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcd13cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcd13ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff88d629cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff8b560398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff8b5c9e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank5]:[E1224 01:14:28.932618537 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf62e48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf628c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcba8fc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcba8fdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffccb448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcc93cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcc93cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcc93ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff80f529cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff83750398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff837b9e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank4]:[E1224 01:14:28.932618947 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe0c6048c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0c5ac140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcd4cac8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcd4cadec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffce3448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffce13cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffce13cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffce13ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff972729cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff99a70398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff99ad9e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank7]:[E1224 01:14:28.932623577 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe26a348c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe269dc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffceb0cc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffceb0cdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffcfb448764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcf93cb510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcf93cc0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcf93ca008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffffb16a29cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffffb3ea0398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffffb3f09e9c in /lib/aarch64-linux-gnu/libc.so.6)

[rank6]:[E1224 01:14:28.932623727 compiler_depend.ts:444] ReshapeAndCacheOperation setup failed!
Exception raised from OperationSetup at build/third_party/op-plugin/op_plugin/CMakeFiles/op_plugin_atb.dir/compiler_depend.ts:203 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdffa448c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdff9ec140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: atb::OperationSetup(atb::VariantPack, atb::Operation*, atb::Context*) + 0x278 (0xfffcc80cc8c8 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #3: <unknown function> + 0xadec4 (0xfffcc80cdec4 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libop_plugin_atb.so)
frame #4: <unknown function> + 0x2a88764 (0xfffcd6ed8764 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0xa0b510 (0xfffcd4e5b510 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0xa0c0ec (0xfffcd4e5c0ec in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0xa0a008 (0xfffcd4e5a008 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: <unknown function> + 0xd29cc (0xffff8a6b29cc in /lib/aarch64-linux-gnu/libstdc++.so.6)
frame #9: <unknown function> + 0x80398 (0xffff8ceb0398 in /lib/aarch64-linux-gnu/libc.so.6)
frame #10: <unknown function> + 0xe9e9c (0xffff8cf19e9c in /lib/aarch64-linux-gnu/libc.so.6)


Capturing batches (bs=30 avail_mem=8.62 GB):   0%|          | 0/8 [00:17<?, ?it/s]
[2025-12-24 01:14:28 DP10 TP10 EP10] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1750, Device:10, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1750, Device:10, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


[2025-12-24 01:14:28 DP12 TP12 EP12] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2437, Device:12, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2437, Device:12, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


[2025-12-24 01:14:28 DP13 TP13 EP13] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2445, Device:13, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2445, Device:13, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb09f2ad60>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb09781240>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb097811d0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb09781160>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb097812b0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb09791f70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffaffa15160>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffaff7c02f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffafed990f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffafed99080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffafed99010>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffafeda1f70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb085bd0f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb085bd080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb085bd010>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb085bd160>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb085bd240>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb085c5f70>
  parent_process.send_signal(signal.SIGQUIT)
[2025-12-24 01:14:28 DP15 TP15 EP15] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2448, Device:15, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2448, Device:15, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


[2025-12-24 01:14:28 DP8 TP8 EP8] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1748, Device:8, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1748, Device:8, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


[2025-12-24 01:14:28 DP9 TP9 EP9] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1749, Device:9, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1749, Device:9, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


[2025-12-24 01:14:28 DP14 TP14 EP14] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2447, Device:14, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2447, Device:14, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


[2025-12-24 01:14:28 DP7 TP7 EP7] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1747, Device:7, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1747, Device:7, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb3018d1d0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb3018d160>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb3018d0f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb3018d240>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb30fe6970>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb3019df70>
  parent_process.send_signal(signal.SIGQUIT)
[2025-12-24 01:14:28 DP4 TP4 EP4] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1744, Device:4, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1744, Device:4, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


[2025-12-24 01:14:28 DP6 TP6 EP6] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1746, Device:6, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1746, Device:6, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb069e9080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb069e9010>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb069e8fa0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb069e90f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb069e91d0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb069f5f70>
  parent_process.send_signal(signal.SIGQUIT)
[2025-12-24 01:14:28 DP5 TP5 EP5] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1745, Device:5, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1745, Device:5, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb0bcdeba0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb0bdd87c0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb0b545240>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb0b5451d0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb0b545160>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb0b555f70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb38e7a9e0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb386d9010>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb386d8fa0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb386d8f30>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb386d9080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb386e1f70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb320f0fa0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb320f0f30>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb320f0ec0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb320f1010>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb320f10f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb320f5f70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb17605010>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb17604fa0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb17604f30>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb17605080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb17605160>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb1760df70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb0b85ee40>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb0b0c9010>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb0b0c9080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb0b0c8fa0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb0b0c90f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb0b0d5f70>
  parent_process.send_signal(signal.SIGQUIT)
[2025-12-24 01:14:28 DP11 TP11 EP11] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2435, Device:11, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:2435, Device:11, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb0212ac80>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb023b03d0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb01985160>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb019850f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb01985080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb01991f70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb035f0280>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb035f03d0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb02bc5160>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb02bc50f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb02bc5080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb02bd1f70>
  parent_process.send_signal(signal.SIGQUIT)
[2025-12-24 01:14:28 DP1 TP1 EP1] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1741, Device:1, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1741, Device:1, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


[2025-12-24 01:14:28 DP0 TP0 EP0] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1740, Device:0, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1740, Device:0, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


[2025-12-24 01:14:28 DP2 TP2 EP2] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1742, Device:2, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1742, Device:2, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb1ac237e0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb1a7aeba0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb1a011240>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb1a0112b0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb1a0111d0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb1a025f70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb2a3a8980>
  parent_process.send_signal(signal.SIGQUIT)
[2025-12-24 01:14:28 DP3 TP3 EP3] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 130, in __init__
    self.capture()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 178, in capture
    CudaGraphRunner.capture(self)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 513, in capture
    _capture_one_stream()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/cuda_graph_runner.py", line 500, in _capture_one_stream
    ) = self.capture_one_batch_size(bs, forward, stream_idx)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 304, in capture_one_batch_size
    self._capture_init(run_once)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 72, in _capture_init
    run_once_fn()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 296, in run_once
    ret = self.eagle_worker.draft_forward(forward_batch)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 394, in draft_forward
    logits_output = self.draft_runner.forward(
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2889, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2955, in _forward_raw
    ret = self.forward_decode(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2804, in forward_decode
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama.py", line 469, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 170, in forward
    hidden_states, residual = self.midlayer(
                              ^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/llama_eagle3.py", line 96, in forward
    hidden_states, residual = self.post_attention_layernorm(hidden_states, residual)
                              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/custom_op.py", line 67, in forward
    return self._forward_method(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/quantization/modelslim.py", line 53, in _rmsnorm_forward_oot
    out, residual_out = add_rmsnorm_bias(
                        ^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sgl_kernel_npu/norm/add_rmsnorm_bias.py", line 115, in add_rmsnorm_bias
    kernel = add_rmsnorm_bias_kernel.warmup(
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 773, in warmup
    return self.run(grid=grid, warmup=True, *map(MockTensor.wrap_dtype, args), **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/runtime/jit.py", line 592, in run
    stream = driver.active.get_current_stream(device)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 358, in get_current_stream
    return _npu_getCurrentRawStream(device)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1743, Device:3, RankID:-1) ERR00100 PTA call acl api failed.


During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2836, in run_scheduler_process
    scheduler = Scheduler(
                ^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 314, in __init__
    self.init_model_worker()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 517, in init_model_worker
    self.draft_worker = self.spec_algorithm.create_draft_worker(
                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 179, in create_draft_worker
    return self._draft_worker_factory(self, **factory_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 197, in _factory
    return worker_cls(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/spec_info.py", line 269, in _create_eagle_worker
    return EAGLEWorkerV2(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 580, in __init__
    self._draft_worker = EagleDraftWorker(
                         ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 148, in __init__
    self.init_cuda_graphs()
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_worker_v2.py", line 241, in init_cuda_graphs
    self.cuda_graph_runner = Device2DraftCudaGraphRunner[
                             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/hardware_backend/npu/graph_runner/eagle_draft_npu_graph_runner.py", line 50, in __init__
    super().__init__(eagle_worker)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/speculative/eagle_draft_cuda_graph_runner.py", line 132, in __init__
    raise Exception(
Exception: Capture cuda graph failed: The Inner error is reported as above. The process exits for this inner error, and the current working operator name is ReshapeCacheOperation.
Since the operator is called asynchronously, the stacktrace may be inaccurate. If you want to get the accurate stacktrace, please set the environment variable ASCEND_LAUNCH_BLOCKING=1.
Note: ASCEND_LAUNCH_BLOCKING=1 will force ops to run in synchronous mode, resulting in performance degradation. Please unset ASCEND_LAUNCH_BLOCKING in time after debugging.
[ERROR] 2025-12-24-01:14:28 (PID:1743, Device:3, RankID:-1) ERR00100 PTA call acl api failed.

Possible solutions:
1. set --mem-fraction-static to a smaller value (e.g., 0.8 or 0.7)
2. set --cuda-graph-max-bs to a smaller value (e.g., 16)
3. disable torch compile by not using --enable-torch-compile
4. disable CUDA graph by --disable-cuda-graph. (Not recommended. Huge performance loss)
Open an issue on GitHub https://github.com/sgl-project/sglang/issues/new/choose 


/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb29b1cfa0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb29b1d010>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb29b1cf30>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb29b1d080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb29b25f70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffafe5dd080>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffafe5dd010>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffafe5dcfa0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffafe5dd0f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffafe5dd1d0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffafe5e5f70>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PULL) at 0xfffb173d8a60>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.DEALER) at 0xfffb177c46e0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb172deeb0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb16b45160>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed socket <zmq.Socket(zmq.PUSH) at 0xfffb16b450f0>
  parent_process.send_signal(signal.SIGQUIT)
/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py:2895: ResourceWarning: Unclosed context <zmq.Context() at 0xfffb16b55f70>
  parent_process.send_signal(signal.SIGQUIT)
[2025-12-24 01:14:28] Rank 0 scheduler is dead. Please check if there are relevant logs.
[2025-12-24 01:14:28] Exit code: -3
Traceback (most recent call last):
  File "<frozen runpy>", line 198, in _run_module_as_main
  File "<frozen runpy>", line 88, in _run_code
  File "/data/d00662834/1211_dev/sglang/python/sglang/launch_server.py", line 32, in <module>
    run_server(server_args)
  File "/data/d00662834/1211_dev/sglang/python/sglang/launch_server.py", line 25, in run_server
    launch_server(server_args)
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/entrypoints/http_server.py", line 1692, in launch_server
    _launch_subprocesses(
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/entrypoints/engine.py", line 966, in _launch_subprocesses
    data = scheduler_pipe_readers[i].recv()
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/multiprocessing/connection.py", line 399, in _recv
    raise EOFError
EOFError
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
E
======================================================================
ERROR: setUpClass (__main__.TestQwen3_235B)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/test/nightly/ascend/performance/test_ascend_single_mix_utils.py", line 92, in setUpClass
    cls.process = popen_launch_server(
                  ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/test/test_utils.py", line 667, in popen_launch_server
    raise Exception(
Exception: Server process exited with code 1. Check server logs for errors.

----------------------------------------------------------------------
Ran 0 tests in 370.081s

FAILED (errors=1)
Finished test case test/nightly/ascend/performance/test_ascend_qwen3_235b_w8a8_8p_in2k_out2k_50ms.py

Error: Pod logs ended but target pattern was not detected
job.batch.volcano.sh "sglang-single-227407ec-f13d-4c27-a472-65dcad1f367f" deleted
