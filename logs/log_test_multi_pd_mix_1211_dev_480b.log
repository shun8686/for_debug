KUBE_JOB_NAME: sglang-multi-debug
WARNING: When the --extra-index-url option is used, the installation package is downloaded from an unverified URL. Exercise caution when using this option.
WARNING: Running pip install with root privileges is generally not a good idea. Try `pip3 install --user` instead.
Looking in indexes: https://mirrors.tuna.tsinghua.edu.cn/pypi/web/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Requirement already satisfied: jinja2-cli in /usr/local/lib/python3.9/site-packages (0.8.2)
Requirement already satisfied: jinja2 in /root/.local/lib/python3.9/site-packages (from jinja2-cli) (2.11.3)
Requirement already satisfied: MarkupSafe>=0.23 in /root/.local/lib/python3.9/site-packages (from jinja2->jinja2-cli) (2.0.1)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv
apply k8s yaml... KUBE_NAME_SPACE:sglang-multi-debug, KUBE_CONFIG_MAP:sglang-info, KUBE_JOB_TYPE:multi, KUBE_YAML_FILE:k8s_multi.yaml
configmap/rings-config-ascend-sglang-test created
configmap/sglang-info created
role.rbac.authorization.k8s.io/ascend-sglang-configmap-access created
rolebinding.rbac.authorization.k8s.io/ascend-sglang-configmap-binding created
role.rbac.authorization.k8s.io/ascend-sglang-pod-access created
rolebinding.rbac.authorization.k8s.io/ascend-sglang-pod-binding created
job.batch.volcano.sh/sglang-multi-debug created

Waiting all pods to running...
Pod: sglang-multi-debug-sglang-node-0, status: Pending
Pod: sglang-multi-debug-sglang-node-0, status: Pending
Pod: sglang-multi-debug-sglang-node-0, status: Pending
Pod: sglang-multi-debug-sglang-node-0, status: Running
Pod: sglang-multi-debug-sglang-node-1, status: Running
All sglang Pod is Running !
ConfigMap sglang-info already exists. Updating...
ConfigMap sglang-info updated successfully.
{'api_version': 'v1',
 'binary_data': None,
 'data': {'sglang-multi-debug-sglang-node-0': '192.168.0.184',
          'sglang-multi-debug-sglang-node-1': '192.168.0.60'},
 'immutable': None,
 'kind': 'ConfigMap',
 'metadata': {'annotations': None,
              'creation_timestamp': datetime.datetime(2025, 12, 19, 8, 7, 25, tzinfo=tzutc()),
              'deletion_grace_period_seconds': None,
              'deletion_timestamp': None,
              'finalizers': None,
              'generate_name': None,
              'generation': None,
              'labels': None,
              'managed_fields': [{'api_version': 'v1',
                                  'fields_type': 'FieldsV1',
                                  'fields_v1': {'f:data': {'.': {},
                                                           'f:sglang-multi-debug-sglang-node-0': {},
                                                           'f:sglang-multi-debug-sglang-node-1': {}}},
                                  'manager': 'OpenAPI-Generator',
                                  'operation': 'Update',
                                  'subresource': None,
                                  'time': datetime.datetime(2025, 12, 19, 8, 7, 45, tzinfo=tzutc())}],
              'name': 'sglang-info',
              'namespace': 'sglang-multi-debug',
              'owner_references': None,
              'resource_version': '114627942',
              'self_link': None,
              'uid': '104eb598-be70-4afa-b06b-4b08438dd187'}}
Starting to monitor logs for Pod: sglang-multi-debug-sglang-node-0
Namespace: sglang-multi-debug
Timeout set to: 10800 seconds
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting kubernetes
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/ca/ec/65f7d563aa4a62dd58777e8f6aa882f15db53b14eb29aba0c28a20f7eb26/kubernetes-34.1.0-py2.py3-none-any.whl (2.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 2.0/2.0 MB 7.2 MB/s  0:00:00
Requirement already satisfied: certifi>=14.05.14 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2025.10.5)
Requirement already satisfied: six>=1.9.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (1.17.0)
Requirement already satisfied: python-dateutil>=2.5.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.9.0.post0)
Requirement already satisfied: pyyaml>=5.4.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (6.0.3)
Collecting google-auth>=1.0.1 (from kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/c6/97/451d55e05487a5cd6279a01a7e34921858b16f7dc8aa38a2c684743cd2b3/google_auth-2.45.0-py2.py3-none-any.whl (233 kB)
Collecting websocket-client!=0.40.0,!=0.41.*,!=0.42.*,>=0.32.0 (from kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/34/db/b10e48aa8fff7407e67470363eac595018441cf32d5e1001567a7aeba5d2/websocket_client-1.9.0-py3-none-any.whl (82 kB)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.32.5)
Collecting requests-oauthlib (from kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/3b/5d/63d4ae3b9daea098d5d6f5da83984853c1bbacd5dc826764b249fe119d24/requests_oauthlib-2.0.0-py2.py3-none-any.whl (24 kB)
Collecting urllib3<2.4.0,>=1.24.2 (from kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/c8/19/4ec628951a74043532ca2cf5d97b7b14863931476d117c471e8e2b1eb39f/urllib3-2.3.0-py3-none-any.whl (128 kB)
Collecting durationpy>=0.7 (from kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/b0/0d/9feae160378a3553fa9a339b0e9c1a048e147a4127210e286ef18b730f03/durationpy-0.10-py3-none-any.whl (3.9 kB)
Collecting cachetools<7.0,>=2.0.0 (from google-auth>=1.0.1->kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/2c/fc/1d7b80d0eb7b714984ce40efc78859c022cd930e402f599d8ca9e39c78a4/cachetools-6.2.4-py3-none-any.whl (11 kB)
Collecting pyasn1-modules>=0.2.1 (from google-auth>=1.0.1->kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/47/8d/d529b5d697919ba8c11ad626e835d4039be708a35b0d22de83a269a6682c/pyasn1_modules-0.4.2-py3-none-any.whl (181 kB)
Collecting rsa<5,>=3.1.4 (from google-auth>=1.0.1->kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/64/8d/0133e4eb4beed9e425d9a98ed6e081a55d195481b7632472be1af08d2f6b/rsa-4.9.1-py3-none-any.whl (34 kB)
Collecting pyasn1>=0.1.3 (from rsa<5,>=3.1.4->google-auth>=1.0.1->kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/c8/f1/d6a797abb14f6283c0ddff96bbdd46937f64122b8c925cab503dd37f8214/pyasn1-0.6.1-py3-none-any.whl (83 kB)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.11)
Collecting oauthlib>=3.0.0 (from requests-oauthlib->kubernetes)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/be/9c/92789c596b8df838baa98fa71844d84283302f7604ed565dafe5a6b5041a/oauthlib-3.3.1-py3-none-any.whl (160 kB)
Installing collected packages: durationpy, websocket-client, urllib3, pyasn1, oauthlib, cachetools, rsa, pyasn1-modules, requests-oauthlib, google-auth, kubernetes
  Attempting uninstall: urllib3
    Found existing installation: urllib3 2.5.0
    Uninstalling urllib3-2.5.0:
      Successfully uninstalled urllib3-2.5.0

Successfully installed cachetools-6.2.4 durationpy-0.10 google-auth-2.45.0 kubernetes-34.1.0 oauthlib-3.3.1 pyasn1-0.6.1 pyasn1-modules-0.4.2 requests-oauthlib-2.0.0 rsa-4.9.1 urllib3-2.3.0 websocket-client-1.9.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting xgrammar==0.1.25
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/55/04/55a87e814bcab771d3e4159281fa382b3d5f14a36114f2f9e572728da831/xgrammar-0.1.25-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (8.5 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 8.5/8.5 MB 26.0 MB/s  0:00:00
Requirement already satisfied: pydantic in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.12.5)
Requirement already satisfied: torch>=1.10.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.8.0+cpu)
Requirement already satisfied: transformers>=4.38.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (5.0.0rc0)
Requirement already satisfied: ninja in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (1.13.0)
Requirement already satisfied: numpy in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.3.5)
Requirement already satisfied: typing-extensions>=4.9.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (4.15.0)
Requirement already satisfied: filelock in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.19.1)
Requirement already satisfied: sympy>=1.13.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (1.14.0)
Requirement already satisfied: networkx in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.5)
Requirement already satisfied: jinja2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.1.6)
Requirement already satisfied: fsspec in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (2025.9.0)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from sympy>=1.13.3->torch>=1.10.0->xgrammar==0.1.25) (1.3.0)
Requirement already satisfied: huggingface-hub<2.0,>=1.0.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (1.2.1)
Requirement already satisfied: packaging>=20.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (25.0)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (6.0.3)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (2025.11.3)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (2.32.5)
Requirement already satisfied: tokenizers<=0.23.0,>=0.22.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.22.1)
Requirement already satisfied: typer-slim in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.20.0)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.7.0)
Requirement already satisfied: tqdm>=4.27 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (4.67.1)
Requirement already satisfied: hf-xet<2.0.0,>=1.2.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<2.0,>=1.0.0->transformers>=4.38.0->xgrammar==0.1.25) (1.2.0)
Requirement already satisfied: httpx<1,>=0.23.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<2.0,>=1.0.0->transformers>=4.38.0->xgrammar==0.1.25) (0.28.1)
Requirement already satisfied: shellingham in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<2.0,>=1.0.0->transformers>=4.38.0->xgrammar==0.1.25) (1.5.4)
Requirement already satisfied: anyio in /usr/local/python3.11.13/lib/python3.11/site-packages (from httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.0.0->transformers>=4.38.0->xgrammar==0.1.25) (4.12.0)
Requirement already satisfied: certifi in /usr/local/python3.11.13/lib/python3.11/site-packages (from httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.0.0->transformers>=4.38.0->xgrammar==0.1.25) (2025.10.5)
Requirement already satisfied: httpcore==1.* in /usr/local/python3.11.13/lib/python3.11/site-packages (from httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.0.0->transformers>=4.38.0->xgrammar==0.1.25) (1.0.9)
Requirement already satisfied: idna in /usr/local/python3.11.13/lib/python3.11/site-packages (from httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.0.0->transformers>=4.38.0->xgrammar==0.1.25) (3.11)
Requirement already satisfied: h11>=0.16 in /usr/local/python3.11.13/lib/python3.11/site-packages (from httpcore==1.*->httpx<1,>=0.23.0->huggingface-hub<2.0,>=1.0.0->transformers>=4.38.0->xgrammar==0.1.25) (0.16.0)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from jinja2->torch>=1.10.0->xgrammar==0.1.25) (2.1.5)
Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (2.41.5)
Requirement already satisfied: typing-inspection>=0.4.2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (0.4.2)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (3.4.4)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (2.3.0)
Requirement already satisfied: click>=8.0.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from typer-slim->transformers>=4.38.0->xgrammar==0.1.25) (8.3.1)
Installing collected packages: xgrammar
  Attempting uninstall: xgrammar
    Found existing installation: xgrammar 0.1.27
    Uninstalling xgrammar-0.1.27:
      Successfully uninstalled xgrammar-0.1.27
Successfully installed xgrammar-0.1.25
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting transformers==4.57.1
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/71/d3/c16c3b3cf7655a67db1144da94b021c200ac1303f82428f2beef6c2e72bb/transformers-4.57.1-py3-none-any.whl (12.0 MB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 12.0/12.0 MB 33.9 MB/s  0:00:00
Requirement already satisfied: filelock in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (3.19.1)
Collecting huggingface-hub<1.0,>=0.34.0 (from transformers==4.57.1)
  Downloading https://pypi.tuna.tsinghua.edu.cn/packages/cb/bd/1a875e0d592d447cbc02805fd3fe0f497714d6a2583f59d14fa9ebad96eb/huggingface_hub-0.36.0-py3-none-any.whl (566 kB)
     ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━ 566.1/566.1 kB 43.8 MB/s  0:00:00
Requirement already satisfied: numpy>=1.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2.3.5)
Requirement already satisfied: packaging>=20.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (25.0)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (6.0.3)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2025.11.3)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2.32.5)
Requirement already satisfied: tokenizers<=0.23.0,>=0.22.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.22.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.7.0)
Requirement already satisfied: tqdm>=4.27 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (4.67.1)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (2025.9.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (4.15.0)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (1.2.0)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (2025.10.5)
Installing collected packages: huggingface-hub, transformers
  Attempting uninstall: huggingface-hub
    Found existing installation: huggingface_hub 1.2.1
    Uninstalling huggingface_hub-1.2.1:
      Successfully uninstalled huggingface_hub-1.2.1
  Attempting uninstall: transformers
    Found existing installation: transformers 5.0.0rc0
    Uninstalling transformers-5.0.0rc0:
      Successfully uninstalled transformers-5.0.0rc0

Successfully installed huggingface-hub-0.36.0 transformers-4.57.1
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Processing /data/d00662834/doc_test/sgl-kernel-npu/output/sgl_kernel_npu-2025.12.14-cp311-cp311-linux_aarch64.whl
Installing collected packages: sgl-kernel-npu
  Attempting uninstall: sgl-kernel-npu
    Found existing installation: sgl-kernel-npu 0.1.0
    Uninstalling sgl-kernel-npu-0.1.0:
      Successfully uninstalled sgl-kernel-npu-0.1.0
Successfully installed sgl-kernel-npu-2025.12.14
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  732k  100  732k    0     0  1574k      0 --:--:-- --:--:-- --:--:-- 1574k
performance
vm.swappiness = 0
kernel.numa_balancing = 0
kernel.sched_migration_cost_ns = 50000
Running test case test/srt/ascend_k8s/test_ascend_qwen3_480b_16p_in3500_out1500_50ms.py
The nic name matched is enp23s0f3
The nic name matched is enp23s0f3
Nic name: enp23s0f3
Init 192.168.0.184 cls.role='master'!
[CI Test Method] TestQwen3_480B.test_qwen3_480b
launch_node start ......Waiting for the server to start...

query_configmap successfully!
monitor configmap.data={'sglang-multi-debug-sglang-node-0': '192.168.0.184', 'sglang-multi-debug-sglang-node-1': '192.168.0.60'}
launch_node dist_init_addr='192.168.0.184:5000'
ENV_VAR SGLANG_SET_CPU_AFFINITY:1
ENV_VAR PYTORCH_NPU_ALLOC_CONF:expandable_segments:True
ENV_VAR SGLANG_DEEPEP_NUM_MAX_DISPATCH_TOKENS_PER_RANK:24
ENV_VAR SGLANG_DISAGGREGATION_BOOTSTRAP_TIMEOUT:600
ENV_VAR SGLANG_ENABLE_OVERLAP_PLAN_STREAM:1
ENV_VAR SGLANG_ENABLE_SPEC_V2:1
ENV_VAR SGLANG_DP_ROUND_ROBIN:1
ENV_VAR HCCL_BUFFSIZE:2100
ENV_VAR HCCL_SOCKET_IFNAME:enp23s0f3
ENV_VAR GLOO_SOCKET_IFNAME:enp23s0f3
ENV_VAR STREAMS_PER_DEVICE:32
ENV_VAR TASK_QUEUE_ENABLE:0
ENV_VAR SGLANG_SCHEDULER_DECREASE_PREFILL_IDLE:1
Starting node, node_ip='192.168.0.184' other_args=['--trust-remote-code', '--nnodes', '2', '--tp-size', '32', '--dp-size', '32', '--mem-fraction-static', '0.75', '--max-running-requests', '384', '--attention-backend', 'ascend', '--device', 'npu', '--quantization', 'modelslim', '--enable-dp-attention', '--moe-a2a-backend', 'deepep', '--deepep-mode', 'auto', '--cuda-graph-bs', 6, 8, 10, 12, '--enable-dp-lm-head', '--disable-cuda-graph', '--chunked-prefill-size', '-1', '--max-prefill-tokens', '7168', '--disaggregation-transfer-backend', 'ascend', '--watchdog-timeout', 9000, '--context-length', '8192', '--dtype', 'bfloat16', '--dist-init-addr', '192.168.0.184:5000', '--node-rank', 0]
command=python3 -m sglang.launch_server --model-path /root/.cache/modelscope/hub/models/Qwen3-Coder-480B-A35B-Instruct-w8a8-QuaRot --trust-remote-code --nnodes 2 --tp-size 32 --dp-size 32 --mem-fraction-static 0.75 --max-running-requests 384 --attention-backend ascend --device npu --quantization modelslim --enable-dp-attention --moe-a2a-backend deepep --deepep-mode auto --cuda-graph-bs 6 8 10 12 --enable-dp-lm-head --disable-cuda-graph --chunked-prefill-size -1 --max-prefill-tokens 7168 --disaggregation-transfer-backend ascend --watchdog-timeout 9000 --context-length 8192 --dtype bfloat16 --dist-init-addr 192.168.0.184:5000 --node-rank 0 --device npu --host 192.168.0.184 --port 6677
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-19 16:08:44] WARNING model_config.py:768: modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:08:44] WARNING server_args.py:1767: DP attention is enabled. The chunked prefill size is adjusted to -1 to avoid MoE kernel issues. 
[2025-12-19 16:08:44] WARNING server_args.py:1820: DeepEP MoE is enabled. The expert parallel size is adjusted to be the same as the tensor parallel size[32].
[2025-12-19 16:08:45] server_args=ServerArgs(model_path='/root/.cache/modelscope/hub/models/Qwen3-Coder-480B-A35B-Instruct-w8a8-QuaRot', tokenizer_path='/root/.cache/modelscope/hub/models/Qwen3-Coder-480B-A35B-Instruct-w8a8-QuaRot', tokenizer_mode='auto', tokenizer_worker_num=1, skip_tokenizer_init=False, load_format='auto', model_loader_extra_config='{}', trust_remote_code=True, context_length=8192, is_embedding=False, enable_multimodal=None, revision=None, model_impl='auto', host='192.168.0.184', port=6677, fastapi_root_path='', grpc_mode=False, skip_server_warmup=False, warmups=None, nccl_port=None, checkpoint_engine_wait_weights_before_ready=False, encoder_only=False, language_only=False, encoder_transfer_backend='zmq_to_scheduler', encoder_urls=[], dtype='bfloat16', quantization='modelslim', quantization_param_path=None, kv_cache_dtype='auto', enable_fp32_lm_head=False, modelopt_quant=None, modelopt_checkpoint_restore_path=None, modelopt_checkpoint_save_path=None, modelopt_export_path=None, quantize_and_serve=False, rl_quant_profile=None, mem_fraction_static=0.75, max_running_requests=384, max_queued_requests=None, max_total_tokens=None, chunked_prefill_size=-1, enable_dynamic_chunking=False, max_prefill_tokens=7168, prefill_max_requests=None, schedule_policy='fcfs', enable_priority_scheduling=False, abort_on_priority_when_disabled=False, schedule_low_priority_values_first=False, priority_scheduling_preemption_threshold=10, schedule_conservativeness=0.3, page_size=128, hybrid_kvcache_ratio=None, swa_full_tokens_ratio=0.8, disable_hybrid_swa_memory=False, radix_eviction_policy='lru', device='npu', tp_size=32, pp_size=1, pp_max_micro_batch_size=None, pp_async_batch_depth=0, stream_interval=1, stream_output=False, random_seed=929023499, constrained_json_whitespace_pattern=None, constrained_json_disable_any_whitespace=False, watchdog_timeout=9000.0, soft_watchdog_timeout=None, dist_timeout=None, download_dir=None, base_gpu_id=0, gpu_id_step=1, sleep_on_idle=False, custom_sigquit_handler=None, log_level='info', log_level_http=None, log_requests=False, log_requests_level=2, crash_dump_folder=None, show_time_cost=False, enable_metrics=False, enable_metrics_for_all_schedulers=False, tokenizer_metrics_custom_labels_header='x-custom-labels', tokenizer_metrics_allowed_custom_labels=None, bucket_time_to_first_token=None, bucket_inter_token_latency=None, bucket_e2e_request_latency=None, collect_tokens_histogram=False, prompt_tokens_buckets=None, generation_tokens_buckets=None, gc_warning_threshold_secs=0.0, decode_log_interval=40, enable_request_time_stats_logging=False, kv_events_config=None, enable_trace=False, otlp_traces_endpoint='localhost:4317', export_metrics_to_file=False, export_metrics_to_file_dir=None, api_key=None, served_model_name='/root/.cache/modelscope/hub/models/Qwen3-Coder-480B-A35B-Instruct-w8a8-QuaRot', weight_version='default', chat_template=None, completion_template=None, file_storage_path='sglang_storage', enable_cache_report=False, reasoning_parser=None, tool_call_parser=None, tool_server=None, sampling_defaults='model', dp_size=32, load_balance_method='round_robin', load_watch_interval=0.1, prefill_round_robin_balance=False, dist_init_addr='192.168.0.184:5000', nnodes=2, node_rank=0, json_model_override_args='{}', preferred_sampling_params=None, enable_lora=None, max_lora_rank=None, lora_target_modules=None, lora_paths=None, max_loaded_loras=None, max_loras_per_batch=8, lora_eviction_policy='lru', lora_backend='csgmv', max_lora_chunk_size=16, attention_backend='ascend', decode_attention_backend='ascend', prefill_attention_backend='ascend', sampling_backend='pytorch', grammar_backend='xgrammar', mm_attention_backend=None, fp8_gemm_runner_backend='auto', nsa_prefill_backend='flashmla_sparse', nsa_decode_backend='fa3', disable_flashinfer_autotune=False, speculative_algorithm=None, speculative_draft_model_path=None, speculative_draft_model_revision=None, speculative_draft_load_format=None, speculative_num_steps=None, speculative_eagle_topk=None, speculative_num_draft_tokens=None, speculative_accept_threshold_single=1.0, speculative_accept_threshold_acc=1.0, speculative_token_map=None, speculative_attention_mode='prefill', speculative_moe_runner_backend='auto', speculative_moe_a2a_backend=None, speculative_draft_model_quantization='modelslim', speculative_ngram_min_match_window_size=1, speculative_ngram_max_match_window_size=12, speculative_ngram_min_bfs_breadth=1, speculative_ngram_max_bfs_breadth=10, speculative_ngram_match_type='BFS', speculative_ngram_branch_length=18, speculative_ngram_capacity=10000000, ep_size=32, moe_a2a_backend='deepep', moe_runner_backend='auto', flashinfer_mxfp4_moe_precision='default', enable_flashinfer_allreduce_fusion=False, deepep_mode='auto', ep_num_redundant_experts=0, ep_dispatch_algorithm=None, init_expert_location='trivial', enable_eplb=False, eplb_algorithm='auto', eplb_rebalance_num_iterations=1000, eplb_rebalance_layers_per_chunk=None, eplb_min_rebalancing_utilization_threshold=1.0, expert_distribution_recorder_mode=None, expert_distribution_recorder_buffer_size=1000, enable_expert_distribution_metrics=False, deepep_config=None, moe_dense_tp_size=None, elastic_ep_backend=None, mooncake_ib_device=None, max_mamba_cache_size=None, mamba_ssm_dtype='float32', mamba_full_memory_ratio=0.9, mamba_scheduler_strategy='no_buffer', mamba_track_interval=256, enable_hierarchical_cache=False, hicache_ratio=2.0, hicache_size=0, hicache_write_policy='write_through', hicache_io_backend='kernel', hicache_mem_layout='layer_first', hicache_storage_backend=None, hicache_storage_prefetch_policy='best_effort', hicache_storage_backend_extra_config=None, enable_lmcache=False, kt_weight_path=None, kt_method='AMXINT4', kt_cpuinfer=None, kt_threadpool_count=2, kt_num_gpu_experts=None, kt_max_deferred_experts_per_token=None, dllm_algorithm=None, dllm_algorithm_config=None, enable_double_sparsity=False, ds_channel_config_path=None, ds_heavy_channel_num=32, ds_heavy_token_num=256, ds_heavy_channel_type='qk', ds_sparse_decode_threshold=4096, cpu_offload_gb=0, offload_group_size=-1, offload_num_in_group=1, offload_prefetch_step=1, offload_mode='cpu', multi_item_scoring_delimiter=None, disable_radix_cache=False, cuda_graph_max_bs=12, cuda_graph_bs=[6, 8, 10, 12], disable_cuda_graph=True, disable_cuda_graph_padding=False, enable_profile_cuda_graph=False, enable_cudagraph_gc=False, enable_layerwise_nvtx_marker=False, enable_nccl_nvls=False, enable_symm_mem=False, disable_flashinfer_cutlass_moe_fp4_allgather=False, enable_tokenizer_batch_encode=False, disable_tokenizer_batch_decode=False, disable_outlines_disk_cache=False, disable_custom_all_reduce=True, enable_mscclpp=False, enable_torch_symm_mem=False, disable_overlap_schedule=False, enable_mixed_chunk=False, enable_dp_attention=True, enable_dp_lm_head=True, enable_two_batch_overlap=False, enable_single_batch_overlap=False, tbo_token_distribution_threshold=0.48, enable_torch_compile=False, enable_piecewise_cuda_graph=False, enable_torch_compile_debug_mode=False, torch_compile_max_bs=32, piecewise_cuda_graph_max_tokens=4096, piecewise_cuda_graph_tokens=[4, 8, 12, 16, 20, 24, 28, 32, 48, 64, 80, 96, 112, 128, 144, 160, 176, 192, 208, 224, 240, 256, 288, 320, 352, 384, 416, 448, 480, 512, 640, 768, 896, 1024, 1152, 1280, 1408, 1536, 1664, 1792, 1920, 2048, 2176, 2304, 2432, 2560, 2688, 2816, 2944, 3072, 3200, 3328, 3456, 3584, 3712, 3840, 3968, 4096], piecewise_cuda_graph_compiler='eager', torchao_config='', enable_nan_detection=False, enable_p2p_check=False, triton_attention_reduce_in_fp32=False, triton_attention_num_kv_splits=8, triton_attention_split_tile_size=None, num_continuous_decode_steps=1, delete_ckpt_after_loading=False, enable_memory_saver=False, enable_weights_cpu_backup=False, enable_draft_weights_cpu_backup=False, allow_auto_truncate=False, enable_custom_logit_processor=False, flashinfer_mla_disable_ragged=False, disable_shared_experts_fusion=False, disable_chunked_prefix_cache=False, disable_fast_image_processor=False, keep_mm_feature_on_device=False, enable_return_hidden_states=False, scheduler_recv_interval=1, numa_node=None, enable_deterministic_inference=False, rl_on_policy_target=None, enable_attn_tp_input_scattered=False, enable_nsa_prefill_context_parallel=False, enable_fused_qk_norm_rope=False, enable_dynamic_batch_tokenizer=False, dynamic_batch_tokenizer_batch_size=32, dynamic_batch_tokenizer_batch_timeout=0.002, debug_tensor_dump_output_folder=None, debug_tensor_dump_layers=None, debug_tensor_dump_input_file=None, debug_tensor_dump_inject=False, disaggregation_mode='null', disaggregation_transfer_backend='ascend', disaggregation_bootstrap_port=8998, disaggregation_decode_tp=None, disaggregation_decode_dp=None, disaggregation_prefill_pp=1, disaggregation_ib_device=None, disaggregation_decode_enable_offload_kvcache=False, num_reserved_decode_tokens=512, disaggregation_decode_polling_interval=1, custom_weight_loader=[], weight_loader_disable_mmap=False, remote_instance_weight_loader_seed_instance_ip=None, remote_instance_weight_loader_seed_instance_service_port=None, remote_instance_weight_loader_send_weights_group_ports=None, remote_instance_weight_loader_backend='nccl', remote_instance_weight_loader_start_seed_via_transfer_engine=False, enable_pdmux=False, pdmux_config_path=None, sm_group_num=8, mm_max_concurrent_calls=32, mm_per_request_timeout=10.0, enable_broadcast_mm_inputs_process=False, enable_prefix_mm_cache=False, mm_enable_dp_encoder=False, mm_process_config={}, decrypted_config_file=None, decrypted_draft_config_file=None, forward_hooks=None)
[2025-12-19 16:08:45] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:08:45] Using default HuggingFace chat template with detected content format: string
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-19 16:09:03 DP14 TP14 EP14] Process 1779 gpu_id 14 is running on CPUs: [280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299]
[2025-12-19 16:09:03 DP14 TP14 EP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-19 16:09:04 DP8 TP8 EP8] Process 1773 gpu_id 8 is running on CPUs: [160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
[2025-12-19 16:09:04 DP8 TP8 EP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
[2025-12-19 16:09:04 DP12 TP12 EP12] Process 1777 gpu_id 12 is running on CPUs: [240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259]
[2025-12-19 16:09:04 DP12 TP12 EP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-19 16:09:04 DP14 TP14 EP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:04 DP14 TP14 EP14] Init torch distributed begin.
[2025-12-19 16:09:04 DP9 TP9 EP9] Process 1774 gpu_id 9 is running on CPUs: [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
[2025-12-19 16:09:04 DP9 TP9 EP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-19 16:09:04 DP4 TP4 EP4] Process 1769 gpu_id 4 is running on CPUs: [80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
[2025-12-19 16:09:04 DP4 TP4 EP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:04 DP8 TP8 EP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:04 DP8 TP8 EP8] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-19 16:09:05 DP7 TP7 EP7] Process 1772 gpu_id 7 is running on CPUs: [140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
[2025-12-19 16:09:05 DP7 TP7 EP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP12 TP12 EP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP12 TP12 EP12] Init torch distributed begin.
[2025-12-19 16:09:05 DP1 TP1 EP1] Process 1766 gpu_id 1 is running on CPUs: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
[2025-12-19 16:09:05 DP3 TP3 EP3] Process 1768 gpu_id 3 is running on CPUs: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
[2025-12-19 16:09:05 DP3 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP1 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP0 TP0 EP0] Process 1765 gpu_id 0 is running on CPUs: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[2025-12-19 16:09:05 DP0 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP15 TP15 EP15] Process 1780 gpu_id 15 is running on CPUs: [300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319]
[2025-12-19 16:09:05 DP15 TP15 EP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP10 TP10 EP10] Process 1775 gpu_id 10 is running on CPUs: [200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219]
[2025-12-19 16:09:05 DP10 TP10 EP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP6 TP6 EP6] Process 1771 gpu_id 6 is running on CPUs: [120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
[2025-12-19 16:09:05 DP6 TP6 EP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP11 TP11 EP11] Process 1776 gpu_id 11 is running on CPUs: [220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[2025-12-19 16:09:05 DP11 TP11 EP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP2 TP2 EP2] Process 1767 gpu_id 2 is running on CPUs: [40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
[2025-12-19 16:09:05 DP2 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP13 TP13 EP13] Process 1778 gpu_id 13 is running on CPUs: [260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279]
[2025-12-19 16:09:05 DP13 TP13 EP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-19 16:09:05 DP5 TP5 EP5] Process 1770 gpu_id 5 is running on CPUs: [100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
[2025-12-19 16:09:05 DP5 TP5 EP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-19 16:09:05 DP9 TP9 EP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP9 TP9 EP9] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-19 16:09:05 DP4 TP4 EP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP4 TP4 EP4] Init torch distributed begin.
[2025-12-19 16:09:05 DP3 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP3 TP3 EP3] Init torch distributed begin.
[2025-12-19 16:09:05 DP7 TP7 EP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP7 TP7 EP7] Init torch distributed begin.
[2025-12-19 16:09:05 DP1 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP0 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP0 TP0 EP0] Init torch distributed begin.
[2025-12-19 16:09:05 DP1 TP1 EP1] Init torch distributed begin.
[2025-12-19 16:09:05 DP15 TP15 EP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP15 TP15 EP15] Init torch distributed begin.
[2025-12-19 16:09:05 DP10 TP10 EP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP10 TP10 EP10] Init torch distributed begin.
[2025-12-19 16:09:05 DP6 TP6 EP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP6 TP6 EP6] Init torch distributed begin.
[2025-12-19 16:09:05 DP11 TP11 EP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP11 TP11 EP11] Init torch distributed begin.
[2025-12-19 16:09:05 DP13 TP13 EP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP13 TP13 EP13] Init torch distributed begin.
[2025-12-19 16:09:05 DP2 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:05 DP2 TP2 EP2] Init torch distributed begin.
[2025-12-19 16:09:06 DP5 TP5 EP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-19 16:09:06 DP5 TP5 EP5] Init torch distributed begin.
[Gloo] Rank 4 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 1 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 0 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 2 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 3 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 5 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 6 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 13 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 8 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 12 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 7 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 9 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 11 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 10 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 14 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 15 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 0 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 1 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 2 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 7 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 6 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 3 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 4 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 5 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 12 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 9 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 8 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 11 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 13 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 15 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 10 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
[Gloo] Rank 14 is connected to 31 peer ranks. Expected number of connected peer ranks is : 31
/data/d00662834/1211_dev/sglang/python/sglang/srt/utils/common.py:2713: ResourceWarning: unclosed <socket.socket fd=168, family=2, type=2, proto=0, laddr=('192.168.0.184', 52478), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[2025-12-19 16:09:08 DP0 TP0 EP0] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP14 TP14 EP14] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP15 TP15 EP15] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP13 TP13 EP13] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP12 TP12 EP12] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP11 TP11 EP11] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP10 TP10 EP10] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP9 TP9 EP9] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP8 TP8 EP8] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP7 TP7 EP7] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP6 TP6 EP6] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP5 TP5 EP5] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP4 TP4 EP4] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP3 TP3 EP3] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP1 TP1 EP1] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:08 DP2 TP2 EP2] Init torch distributed ends. mem usage=0.00 GB
[2025-12-19 16:09:09 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:09 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-19 16:09:10 DP14 TP14 EP14] Load weight begin. avail mem=60.55 GB
[2025-12-19 16:09:10 DP15 TP15 EP15] Load weight begin. avail mem=60.78 GB
[2025-12-19 16:09:10 DP12 TP12 EP12] Load weight begin. avail mem=60.55 GB
[2025-12-19 16:09:10 DP13 TP13 EP13] Load weight begin. avail mem=60.78 GB
[2025-12-19 16:09:11 DP1 TP1 EP1] Load weight begin. avail mem=60.78 GB
[2025-12-19 16:09:11 DP0 TP0 EP0] Load weight begin. avail mem=60.48 GB
[2025-12-19 16:09:11 DP4 TP4 EP4] Load weight begin. avail mem=60.54 GB
[2025-12-19 16:09:11 DP3 TP3 EP3] Load weight begin. avail mem=60.80 GB
[2025-12-19 16:09:11 DP9 TP9 EP9] Load weight begin. avail mem=60.80 GB
[2025-12-19 16:09:11 DP5 TP5 EP5] Load weight begin. avail mem=60.80 GB
[2025-12-19 16:09:11 DP7 TP7 EP7] Load weight begin. avail mem=60.78 GB
[2025-12-19 16:09:11 DP8 TP8 EP8] Load weight begin. avail mem=60.54 GB
[2025-12-19 16:09:11 DP10 TP10 EP10] Load weight begin. avail mem=60.54 GB
[2025-12-19 16:09:11 DP6 TP6 EP6] Load weight begin. avail mem=60.55 GB
[2025-12-19 16:09:11 DP2 TP2 EP2] Load weight begin. avail mem=60.54 GB
[2025-12-19 16:09:11 DP11 TP11 EP11] Load weight begin. avail mem=60.80 GB

Loading safetensors checkpoint shards:   0% Completed | 0/113 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:   1% Completed | 1/113 [00:01<03:20,  1.79s/it]

Loading safetensors checkpoint shards:   2% Completed | 2/113 [00:02<02:20,  1.27s/it]

Loading safetensors checkpoint shards:   3% Completed | 3/113 [00:04<02:58,  1.62s/it]

Loading safetensors checkpoint shards:   4% Completed | 4/113 [00:06<03:04,  1.69s/it]

Loading safetensors checkpoint shards:   4% Completed | 5/113 [00:07<02:22,  1.32s/it]

Loading safetensors checkpoint shards:   5% Completed | 6/113 [00:09<03:11,  1.79s/it]

Loading safetensors checkpoint shards:   6% Completed | 7/113 [00:10<02:29,  1.41s/it]

Loading safetensors checkpoint shards:   7% Completed | 8/113 [00:12<03:02,  1.74s/it]

Loading safetensors checkpoint shards:   8% Completed | 9/113 [00:14<02:48,  1.62s/it]

Loading safetensors checkpoint shards:   9% Completed | 10/113 [00:15<02:44,  1.60s/it]

Loading safetensors checkpoint shards:  10% Completed | 11/113 [00:16<02:13,  1.31s/it]

Loading safetensors checkpoint shards:  11% Completed | 12/113 [00:17<01:57,  1.16s/it]

Loading safetensors checkpoint shards:  12% Completed | 13/113 [00:18<02:08,  1.29s/it]

Loading safetensors checkpoint shards:  12% Completed | 14/113 [00:20<02:05,  1.26s/it]

Loading safetensors checkpoint shards:  13% Completed | 15/113 [00:21<01:59,  1.21s/it]

Loading safetensors checkpoint shards:  14% Completed | 16/113 [00:22<01:59,  1.23s/it]

Loading safetensors checkpoint shards:  15% Completed | 17/113 [00:23<01:59,  1.25s/it]

Loading safetensors checkpoint shards:  16% Completed | 18/113 [00:26<02:46,  1.76s/it]

Loading safetensors checkpoint shards:  17% Completed | 19/113 [00:31<04:04,  2.60s/it]

Loading safetensors checkpoint shards:  18% Completed | 20/113 [00:33<03:52,  2.50s/it]

Loading safetensors checkpoint shards:  19% Completed | 21/113 [00:35<03:43,  2.43s/it]

Loading safetensors checkpoint shards:  19% Completed | 22/113 [00:37<03:23,  2.23s/it]

Loading safetensors checkpoint shards:  20% Completed | 23/113 [00:39<03:00,  2.01s/it]

Loading safetensors checkpoint shards:  21% Completed | 24/113 [00:41<03:07,  2.11s/it]

Loading safetensors checkpoint shards:  22% Completed | 25/113 [00:43<03:06,  2.11s/it]

Loading safetensors checkpoint shards:  23% Completed | 26/113 [00:48<04:27,  3.07s/it]

Loading safetensors checkpoint shards:  24% Completed | 27/113 [00:49<03:25,  2.38s/it]

Loading safetensors checkpoint shards:  25% Completed | 28/113 [00:50<02:39,  1.88s/it]

Loading safetensors checkpoint shards:  26% Completed | 29/113 [00:52<02:51,  2.04s/it]

Loading safetensors checkpoint shards:  27% Completed | 30/113 [00:53<02:22,  1.71s/it]

Loading safetensors checkpoint shards:  27% Completed | 31/113 [00:55<02:12,  1.61s/it]

Loading safetensors checkpoint shards:  28% Completed | 32/113 [00:56<02:13,  1.65s/it]

Loading safetensors checkpoint shards:  29% Completed | 33/113 [00:57<01:55,  1.44s/it]

Loading safetensors checkpoint shards:  30% Completed | 34/113 [01:00<02:24,  1.83s/it]

Loading safetensors checkpoint shards:  31% Completed | 35/113 [01:01<01:59,  1.54s/it]

Loading safetensors checkpoint shards:  32% Completed | 36/113 [01:02<01:44,  1.36s/it]

Loading safetensors checkpoint shards:  33% Completed | 37/113 [01:03<01:39,  1.30s/it]

Loading safetensors checkpoint shards:  34% Completed | 38/113 [01:04<01:21,  1.09s/it]

Loading safetensors checkpoint shards:  35% Completed | 39/113 [01:07<02:00,  1.63s/it]

Loading safetensors checkpoint shards:  35% Completed | 40/113 [01:07<01:44,  1.43s/it]

Loading safetensors checkpoint shards:  36% Completed | 41/113 [01:10<02:09,  1.80s/it]

Loading safetensors checkpoint shards:  37% Completed | 42/113 [01:11<01:47,  1.51s/it]

Loading safetensors checkpoint shards:  38% Completed | 43/113 [01:12<01:36,  1.38s/it]

Loading safetensors checkpoint shards:  39% Completed | 44/113 [01:13<01:28,  1.28s/it]

Loading safetensors checkpoint shards:  40% Completed | 45/113 [01:17<02:15,  1.99s/it]

Loading safetensors checkpoint shards:  41% Completed | 46/113 [01:18<01:49,  1.64s/it]

Loading safetensors checkpoint shards:  42% Completed | 47/113 [01:19<01:44,  1.58s/it]

Loading safetensors checkpoint shards:  42% Completed | 48/113 [01:20<01:30,  1.40s/it]

Loading safetensors checkpoint shards:  43% Completed | 49/113 [01:21<01:21,  1.27s/it]

Loading safetensors checkpoint shards:  44% Completed | 50/113 [01:24<02:03,  1.96s/it]

Loading safetensors checkpoint shards:  45% Completed | 51/113 [01:26<01:54,  1.85s/it]

Loading safetensors checkpoint shards:  46% Completed | 52/113 [01:27<01:35,  1.56s/it]

Loading safetensors checkpoint shards:  47% Completed | 53/113 [01:30<01:53,  1.89s/it]

Loading safetensors checkpoint shards:  48% Completed | 54/113 [01:31<01:43,  1.75s/it]

Loading safetensors checkpoint shards:  49% Completed | 55/113 [01:34<01:56,  2.00s/it]

Loading safetensors checkpoint shards:  50% Completed | 56/113 [01:34<01:32,  1.63s/it]

Loading safetensors checkpoint shards:  50% Completed | 57/113 [01:37<01:42,  1.83s/it]

Loading safetensors checkpoint shards:  51% Completed | 58/113 [01:38<01:30,  1.65s/it]

Loading safetensors checkpoint shards:  52% Completed | 59/113 [01:39<01:19,  1.46s/it]

Loading safetensors checkpoint shards:  53% Completed | 60/113 [01:41<01:24,  1.59s/it]

Loading safetensors checkpoint shards:  54% Completed | 61/113 [01:42<01:20,  1.55s/it]

Loading safetensors checkpoint shards:  55% Completed | 62/113 [01:44<01:13,  1.44s/it]

Loading safetensors checkpoint shards:  56% Completed | 63/113 [01:44<01:02,  1.25s/it]

Loading safetensors checkpoint shards:  57% Completed | 64/113 [01:46<01:02,  1.27s/it]

Loading safetensors checkpoint shards:  58% Completed | 65/113 [01:47<00:58,  1.21s/it]

Loading safetensors checkpoint shards:  58% Completed | 66/113 [01:48<00:53,  1.14s/it]

Loading safetensors checkpoint shards:  59% Completed | 67/113 [01:49<00:53,  1.17s/it]

Loading safetensors checkpoint shards:  60% Completed | 68/113 [01:50<00:54,  1.21s/it]

Loading safetensors checkpoint shards:  61% Completed | 69/113 [01:51<00:46,  1.06s/it]

Loading safetensors checkpoint shards:  62% Completed | 70/113 [01:52<00:40,  1.06it/s]

Loading safetensors checkpoint shards:  63% Completed | 71/113 [01:54<01:04,  1.53s/it]

Loading safetensors checkpoint shards:  64% Completed | 72/113 [01:56<01:01,  1.51s/it]

Loading safetensors checkpoint shards:  65% Completed | 73/113 [01:57<00:56,  1.40s/it]

Loading safetensors checkpoint shards:  65% Completed | 74/113 [01:58<00:45,  1.18s/it]

Loading safetensors checkpoint shards:  66% Completed | 75/113 [01:58<00:38,  1.02s/it]

Loading safetensors checkpoint shards:  67% Completed | 76/113 [02:01<00:53,  1.45s/it]

Loading safetensors checkpoint shards:  68% Completed | 77/113 [02:02<00:43,  1.21s/it]

Loading safetensors checkpoint shards:  69% Completed | 78/113 [02:04<00:53,  1.54s/it]

Loading safetensors checkpoint shards:  70% Completed | 79/113 [02:06<00:56,  1.65s/it]

Loading safetensors checkpoint shards:  71% Completed | 80/113 [02:07<00:46,  1.41s/it]

Loading safetensors checkpoint shards:  72% Completed | 81/113 [02:07<00:39,  1.23s/it]

Loading safetensors checkpoint shards:  73% Completed | 82/113 [02:10<00:48,  1.58s/it]

Loading safetensors checkpoint shards:  73% Completed | 83/113 [02:12<00:51,  1.73s/it]

Loading safetensors checkpoint shards:  74% Completed | 84/113 [02:13<00:43,  1.50s/it]

Loading safetensors checkpoint shards:  75% Completed | 85/113 [02:15<00:49,  1.76s/it]

Loading safetensors checkpoint shards:  76% Completed | 86/113 [02:18<00:54,  2.00s/it]

Loading safetensors checkpoint shards:  77% Completed | 87/113 [02:19<00:43,  1.66s/it]

Loading safetensors checkpoint shards:  78% Completed | 88/113 [02:19<00:34,  1.39s/it]

Loading safetensors checkpoint shards:  79% Completed | 89/113 [02:21<00:33,  1.38s/it]

Loading safetensors checkpoint shards:  80% Completed | 90/113 [02:22<00:29,  1.28s/it]

Loading safetensors checkpoint shards:  81% Completed | 91/113 [02:22<00:23,  1.08s/it]

Loading safetensors checkpoint shards:  81% Completed | 92/113 [02:23<00:19,  1.08it/s]

Loading safetensors checkpoint shards:  82% Completed | 93/113 [02:25<00:23,  1.17s/it]

Loading safetensors checkpoint shards:  83% Completed | 94/113 [02:26<00:25,  1.33s/it]

Loading safetensors checkpoint shards:  84% Completed | 95/113 [02:27<00:20,  1.13s/it]

Loading safetensors checkpoint shards:  85% Completed | 96/113 [02:28<00:20,  1.21s/it]

Loading safetensors checkpoint shards:  86% Completed | 97/113 [02:31<00:23,  1.48s/it]

Loading safetensors checkpoint shards:  87% Completed | 98/113 [02:32<00:19,  1.32s/it]

Loading safetensors checkpoint shards:  88% Completed | 99/113 [02:33<00:17,  1.24s/it]

Loading safetensors checkpoint shards:  88% Completed | 100/113 [02:34<00:15,  1.23s/it]

Loading safetensors checkpoint shards:  89% Completed | 101/113 [02:35<00:15,  1.32s/it]

Loading safetensors checkpoint shards:  90% Completed | 102/113 [02:36<00:13,  1.26s/it]

Loading safetensors checkpoint shards:  91% Completed | 103/113 [02:38<00:13,  1.32s/it]

Loading safetensors checkpoint shards:  92% Completed | 104/113 [02:40<00:13,  1.55s/it]

Loading safetensors checkpoint shards:  93% Completed | 105/113 [02:41<00:11,  1.39s/it]

Loading safetensors checkpoint shards:  94% Completed | 106/113 [02:42<00:09,  1.40s/it]

Loading safetensors checkpoint shards:  95% Completed | 107/113 [02:44<00:08,  1.45s/it]

Loading safetensors checkpoint shards:  96% Completed | 108/113 [02:46<00:08,  1.70s/it]

Loading safetensors checkpoint shards:  96% Completed | 109/113 [02:48<00:06,  1.63s/it]

Loading safetensors checkpoint shards:  97% Completed | 110/113 [02:49<00:04,  1.60s/it]

Loading safetensors checkpoint shards:  98% Completed | 111/113 [02:51<00:03,  1.77s/it]

Loading safetensors checkpoint shards:  99% Completed | 112/113 [02:52<00:01,  1.44s/it]

Loading safetensors checkpoint shards: 100% Completed | 113/113 [02:53<00:00,  1.36s/it]

Loading safetensors checkpoint shards: 100% Completed | 113/113 [02:53<00:00,  1.54s/it]

[2025-12-19 16:12:44 DP8 TP8 EP8] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.56 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP9 TP9 EP9] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.81 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP10 TP10 EP10] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.56 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP4 TP4 EP4] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.56 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP11 TP11 EP11] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.81 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP2 TP2 EP2] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.56 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP14 TP14 EP14] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.56 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP0 TP0 EP0] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.49 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP12 TP12 EP12] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.57 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP6 TP6 EP6] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.57 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP3 TP3 EP3] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.81 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP15 TP15 EP15] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.80 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP13 TP13 EP13] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.80 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP7 TP7 EP7] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.80 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP5 TP5 EP5] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.81 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP1 TP1 EP1] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=32.80 GB, mem usage=27.98 GB.
[2025-12-19 16:12:44 DP0 TP0 EP0] Using KV cache dtype: torch.bfloat16
[2025-12-19 16:12:44 DP2 TP2 EP2] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP6 TP6 EP6] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP14 TP14 EP14] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP8 TP8 EP8] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP0 TP0 EP0] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP4 TP4 EP4] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP12 TP12 EP12] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP10 TP10 EP10] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP3 TP3 EP3] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP11 TP11 EP11] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP7 TP7 EP7] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP1 TP1 EP1] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP9 TP9 EP9] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP5 TP5 EP5] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP13 TP13 EP13] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP15 TP15 EP15] KV Cache is allocated. #tokens: 73344, K size: 8.69 GB, V size: 8.69 GB
[2025-12-19 16:12:44 DP6 TP6 EP6] Memory pool end. avail mem=15.19 GB
[2025-12-19 16:12:44 DP2 TP2 EP2] Memory pool end. avail mem=15.17 GB
[2025-12-19 16:12:44 DP14 TP14 EP14] Memory pool end. avail mem=15.18 GB
[2025-12-19 16:12:44 DP8 TP8 EP8] Memory pool end. avail mem=15.17 GB
[2025-12-19 16:12:44 DP0 TP0 EP0] Memory pool end. avail mem=15.11 GB
[2025-12-19 16:12:44 DP4 TP4 EP4] Memory pool end. avail mem=15.17 GB
[2025-12-19 16:12:44 DP12 TP12 EP12] Memory pool end. avail mem=15.19 GB
[2025-12-19 16:12:44 DP10 TP10 EP10] Memory pool end. avail mem=15.18 GB
[2025-12-19 16:12:44 DP3 TP3 EP3] Memory pool end. avail mem=15.43 GB
[2025-12-19 16:12:44 DP11 TP11 EP11] Memory pool end. avail mem=15.43 GB
[2025-12-19 16:12:44 DP7 TP7 EP7] Memory pool end. avail mem=15.42 GB
[2025-12-19 16:12:44 DP1 TP1 EP1] Memory pool end. avail mem=15.42 GB
[2025-12-19 16:12:44 DP9 TP9 EP9] Memory pool end. avail mem=15.43 GB
[2025-12-19 16:12:44 DP5 TP5 EP5] Memory pool end. avail mem=15.43 GB
[2025-12-19 16:12:44 DP13 TP13 EP13] Memory pool end. avail mem=15.42 GB
[2025-12-19 16:12:44 DP15 TP15 EP15] Memory pool end. avail mem=15.42 GB
/data/d00662834/1211_dev/sglang/python/sglang/srt/utils/common.py:1223: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  tensor_data = torch.ByteTensor(
[2025-12-19 16:12:45 DP0 TP0 EP0] max_total_num_tokens=73344, chunked_prefill_size=-1, max_prefill_tokens=7168, max_running_requests=12, context_len=8192, available_gpu_mem=15.11 GB
[2025-12-19 16:12:46] INFO:     Started server process [813]
[2025-12-19 16:12:46] INFO:     Waiting for application startup.
[2025-12-19 16:12:46] Using default chat sampling params from model generation config: {'repetition_penalty': 1.05, 'temperature': 0.7, 'top_k': 20, 'top_p': 0.8}
[2025-12-19 16:12:46] Using default chat sampling params from model generation config: {'repetition_penalty': 1.05, 'temperature': 0.7, 'top_k': 20, 'top_p': 0.8}
[2025-12-19 16:12:46] INFO:     Application startup complete.
[2025-12-19 16:12:46] INFO:     Uvicorn running on http://192.168.0.184:6677 (Press CTRL+C to quit)
[2025-12-19 16:12:47] INFO:     192.168.0.184:58242 - "GET /model_info HTTP/1.1" 200 OK
[2025-12-19 16:12:47 DP9 TP9 EP9] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP8 TP8 EP8] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP12 TP12 EP12] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP10 TP10 EP10] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP11 TP11 EP11] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP7 TP7 EP7] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP13 TP13 EP13] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP6 TP6 EP6] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP14 TP14 EP14] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP15 TP15 EP15] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP5 TP5 EP5] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP4 TP4 EP4] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP3 TP3 EP3] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP2 TP2 EP2] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP1 TP1 EP1] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:12:47 DP0 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[rank8]:[W1219 16:12:47.609659699 compiler_depend.ts:117] Warning: Driver Version: �6��� is invalid or not supported yet. (function operator())
[rank9]:[W1219 16:12:47.609657919 compiler_depend.ts:117] Warning: Driver Version: (�V��� is invalid or not supported yet. (function operator())
[rank12]:[W1219 16:12:47.609718461 compiler_depend.ts:117] Warning: Driver Version: ������ is invalid or not supported yet. (function operator())
[rank10]:[W1219 16:12:47.609790494 compiler_depend.ts:117] Warning: Driver Version: Xa���� is invalid or not supported yet. (function operator())
[rank11]:[W1219 16:12:47.609791524 compiler_depend.ts:117] Warning: Driver Version: x`���� is invalid or not supported yet. (function operator())
[rank13]:[W1219 16:12:47.609813895 compiler_depend.ts:117] Warning: Driver Version: ��z��� is invalid or not supported yet. (function operator())
[rank14]:[W1219 16:12:47.609875098 compiler_depend.ts:117] Warning: Driver Version: �B9��� is invalid or not supported yet. (function operator())
[rank6]:[W1219 16:12:47.609889558 compiler_depend.ts:117] Warning: Driver Version: ���� is invalid or not supported yet. (function operator())
[rank7]:[W1219 16:12:47.609884978 compiler_depend.ts:117] Warning: Driver Version: �_~��� is invalid or not supported yet. (function operator())
[rank15]:[W1219 16:12:47.609951151 compiler_depend.ts:117] Warning: Driver Version: hS��� is invalid or not supported yet. (function operator())
[rank5]:[W1219 16:12:47.610029354 compiler_depend.ts:117] Warning: Driver Version: �#_��� is invalid or not supported yet. (function operator())
[rank4]:[W1219 16:12:47.610054195 compiler_depend.ts:117] Warning: Driver Version: X\���� is invalid or not supported yet. (function operator())
[rank3]:[W1219 16:12:47.610321636 compiler_depend.ts:117] Warning: Driver Version: x���� is invalid or not supported yet. (function operator())
[rank2]:[W1219 16:12:47.610363227 compiler_depend.ts:117] Warning: Driver Version: �jN��� is invalid or not supported yet. (function operator())
[rank0]:[W1219 16:12:47.610491412 compiler_depend.ts:117] Warning: Driver Version: 8�N��� is invalid or not supported yet. (function operator())
[rank1]:[W1219 16:12:47.610501433 compiler_depend.ts:117] Warning: Driver Version: ����� is invalid or not supported yet. (function operator())
[2025-12-19 16:12:52] INFO:     192.168.0.184:58260 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-19 16:12:52] INFO:     192.168.0.184:58276 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-19 16:13:02] INFO:     192.168.0.184:37542 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-19 16:13:02] INFO:     192.168.0.184:37556 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
................[2025-12-19 16:13:12] INFO:     192.168.0.184:53936 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-19 16:13:12] INFO:     192.168.0.184:53950 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-19 16:13:22] INFO:     192.168.0.184:46628 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-19 16:13:22] INFO:     192.168.0.184:46642 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
................[2025-12-19 16:13:32] INFO:     192.168.0.184:37158 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-19 16:13:32] INFO:     192.168.0.184:37160 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-19 16:13:39] INFO:     192.168.0.184:58244 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:13:39] The server is fired up and ready to roll!
[2025-12-19 16:13:42 DP0 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:13:44 DP1 TP1 EP1] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:13:44] INFO:     192.168.0.184:55586 - "GET /health HTTP/1.1" 200 OK
Server http://192.168.0.184:6677/health is ready!
Wait 120s, starting run benchmark ......
[2025-12-19 16:13:44] INFO:     192.168.0.184:55596 - "GET /health_generate HTTP/1.1" 200 OK
command:python3 -m sglang.bench_serving --backend sglang --model /root/.cache/modelscope/hub/models/Qwen3-Coder-480B-A35B-Instruct-w8a8-QuaRot --host 192.168.0.184 --port 6677 --dataset-name random  --max-concurrency 80 --num-prompts 320 --random-input-len 3500 --random-output-len 1500 --random-range-ratio 1
[2025-12-19 16:16:04] INFO:     192.168.0.184:43768 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:04 DP2 TP2 EP2] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:16:12 DP2 TP2 EP2] Decode batch, #running-req: 1, #token: 0, token usage: 0.00, cpu graph: False, gen throughput (token/s): 0.09, #queue-req: 0, 
[2025-12-19 16:16:13] INFO:     192.168.0.184:43240 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13 DP3 TP3 EP3] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-19 16:16:13] INFO:     192.168.0.184:43246 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43260 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43274 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43290 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43306 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43322 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43338 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43352 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43354 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43366 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43370 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43372 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43380 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43382 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43390 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43402 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43412 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43418 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43424 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43436 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43442 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43454 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43470 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43486 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43490 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43506 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43516 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43520 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43526 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43536 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43540 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43542 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43554 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43564 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43580 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43594 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43610 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43612 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43626 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43636 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43638 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43652 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43656 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43660 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43662 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43678 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43694 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43698 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43712 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43726 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43738 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43752 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43770 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43772 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43786 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43796 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43806 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43818 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43834 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43838 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43840 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43846 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43860 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43872 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43880 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43886 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43890 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43894 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43906 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43922 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43928 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43938 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43950 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43956 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43970 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43984 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:43998 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:44004 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:13] INFO:     192.168.0.184:44014 - "POST /generate HTTP/1.1" 200 OK
[2025-12-19 16:16:14 DP8 TP8 EP8] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP9 TP9 EP9] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP10 TP10 EP10] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP7 TP7 EP7] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP6 TP6 EP6] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP12 TP12 EP12] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP11 TP11 EP11] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP13 TP13 EP13] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP5 TP5 EP5] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP14 TP14 EP14] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP4 TP4 EP4] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP15 TP15 EP15] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 2, 
[2025-12-19 16:16:14 DP3 TP3 EP3] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.05, #running-req: 1, #queue-req: 1, 
[2025-12-19 16:16:14 DP2 TP2 EP2] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 1, 
[2025-12-19 16:16:14 DP1 TP1 EP1] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 1, 
[2025-12-19 16:16:14 DP0 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 1, 
[2025-12-19 16:16:19 DP14 TP14 EP14] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1779] 2025-12-19-16:16:19.703.686 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe2aa848c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe2aa2c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb35db8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb35dccddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb35da5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP15 TP15 EP15] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1780] 2025-12-19-16:16:19.703.509 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf93948c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf933c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb046f8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb0470cddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb046e5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP12 TP12 EP12] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1777] 2025-12-19-16:16:19.702.177 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdffb548c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdffafc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb0aec8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb0aedcddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb0aeb5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP13 TP13 EP13] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1778] 2025-12-19-16:16:19.703.080 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe18f848c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe18f2c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb242c8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb242dcddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb242b5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP9 TP9 EP9] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1774] 2025-12-19-16:16:19.702.038 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe067748c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0671c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb11ab8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb11accddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb11aa5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP4 TP4 EP4] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1769] 2025-12-19-16:16:19.703.044 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe233148c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe232bc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb2e668624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb2e67cddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb2e655b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP8 TP8 EP8] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1773] 2025-12-19-16:16:19.702.343 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe05bd48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe05b7c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb10f28624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb10f3cddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb10f15b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP5 TP5 EP5] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1770] 2025-12-19-16:16:19.703.187 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdfb8648c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdfb80c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb06bb8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb06bccddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb06ba5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP6 TP6 EP6] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1771] 2025-12-19-16:16:19.704.147 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe1b8348c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe1b7dc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb26b68624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb26b7cddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb26b55b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP7 TP7 EP7] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1772] 2025-12-19-16:16:19.703.245 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe167148c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe166bc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb21a38624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb21a4cddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb21a25b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP0 TP0 EP0] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1765] 2025-12-19-16:16:19.702.813 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdfcc648c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdfcc0c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb07fb8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb07fccddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb07fa5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP1 TP1 EP1] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1766] 2025-12-19-16:16:19.703.098 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf2ce48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf2c8c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffafe038624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffafe04cddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffafe025b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP2 TP2 EP2] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1767] 2025-12-19-16:16:19.702.265 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe136248c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe135cc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb1e968624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb1e97cddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb1e955b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP3 TP3 EP3] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1768] 2025-12-19-16:16:19.702.398 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe16d848c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe16d2c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb220b8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb220ccddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb220a5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP11 TP11 EP11] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1776] 2025-12-19-16:16:19.703.156 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdfe1548c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdfe0fc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb094b8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb094ccddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb094a5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-19 16:16:19 DP10 TP10 EP10] Scheduler hit an exception: Traceback (most recent call last):
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2796, in run_scheduler_process
    scheduler.event_loop_overlap()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 1065, in event_loop_overlap
    batch_result = self.run_batch(batch)
                   ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/scheduler.py", line 2103, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/managers/tp_worker.py", line 400, in forward_batch_generation
    logits_output, can_run_cuda_graph = self.model_runner.forward(
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2736, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2806, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/model_executor/model_runner.py", line 2681, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 936, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen2_moe.py", line 637, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 809, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 276, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/models/qwen3_moe.py", line 324, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/ep_moe/layer.py", line 163, in forward
    dispatch_output = self.dispatcher.dispatch(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1028, in dispatch
    return self._execute("dispatch", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/batch_overlap/two_batch_overlap.py", line 1025, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 782, in dispatch
    ret = self.dispatch_b()
          ^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 801, in dispatch_b
    return self._get_impl().dispatch_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 410, in dispatch_b
    ) = self._dispatch_core(hidden_states, topk_ids, topk_weights, previous_event)
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/python/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 458, in _dispatch_core
    ) = buffer.dispatch(
        ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 349, in dispatch
    ) = self.runtime.intranode_dispatch(
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeDispatchNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1775] 2025-12-19-16:16:19.702.457 AclNN_Inner_Error(EZ9999):  CamMoeDispatchNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_dispatch at /workspace/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:294 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe0dc548c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0dbfc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x28624 (0xfffb18fb8624 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x3cddc (0xfffb18fccddc in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15b70 (0xfffb18fa5b70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


