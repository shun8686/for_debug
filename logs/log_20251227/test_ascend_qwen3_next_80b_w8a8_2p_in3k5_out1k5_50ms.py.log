image: swr.cn-southwest-2.myhuaweicloud.com/base_image/dockerhub/lmsysorg/sglang:cann8.3.rc2-a3-release1226
KUBE_JOB_NAME: sglang-single-8a105a4c-6607-4b13-acd1-4864f13d0870
Apply k8s yaml... KUBE_NAME_SPACE:sglang-single-debug, KUBE_CONFIG_MAP:None, KUBE_JOB_TYPE:single, KUBE_YAML_FILE:yaml_sglang-single-8a105a4c-6607-4b13-acd1-4864f13d0870.yaml
job.batch.volcano.sh/sglang-single-8a105a4c-6607-4b13-acd1-4864f13d0870 created

Waiting all pods to running...
Pod: sglang-single-8a105a4c-6607-4b13-acd1-4864f13d0870-pod-0, status: Running
All sglang Pod is Running !
Starting to monitor logs for Pod: sglang-single-8a105a4c-6607-4b13-acd1-4864f13d0870-pod-0
Namespace: sglang-single-debug
Timeout set to: 10800 seconds
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting kubernetes
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/ca/ec/65f7d563aa4a62dd58777e8f6aa882f15db53b14eb29aba0c28a20f7eb26/kubernetes-34.1.0-py2.py3-none-any.whl (2.0 MB)
Requirement already satisfied: certifi>=14.05.14 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2025.11.12)
Requirement already satisfied: six>=1.9.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (1.17.0)
Requirement already satisfied: python-dateutil>=2.5.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.9.0.post0)
Requirement already satisfied: pyyaml>=5.4.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (6.0.3)
Collecting google-auth>=1.0.1 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c6/97/451d55e05487a5cd6279a01a7e34921858b16f7dc8aa38a2c684743cd2b3/google_auth-2.45.0-py2.py3-none-any.whl (233 kB)
Collecting websocket-client!=0.40.0,!=0.41.*,!=0.42.*,>=0.32.0 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/34/db/b10e48aa8fff7407e67470363eac595018441cf32d5e1001567a7aeba5d2/websocket_client-1.9.0-py3-none-any.whl (82 kB)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.32.5)
Collecting requests-oauthlib (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/3b/5d/63d4ae3b9daea098d5d6f5da83984853c1bbacd5dc826764b249fe119d24/requests_oauthlib-2.0.0-py2.py3-none-any.whl (24 kB)
Collecting urllib3<2.4.0,>=1.24.2 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c8/19/4ec628951a74043532ca2cf5d97b7b14863931476d117c471e8e2b1eb39f/urllib3-2.3.0-py3-none-any.whl (128 kB)
Collecting durationpy>=0.7 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/b0/0d/9feae160378a3553fa9a339b0e9c1a048e147a4127210e286ef18b730f03/durationpy-0.10-py3-none-any.whl (3.9 kB)
Collecting cachetools<7.0,>=2.0.0 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/2c/fc/1d7b80d0eb7b714984ce40efc78859c022cd930e402f599d8ca9e39c78a4/cachetools-6.2.4-py3-none-any.whl (11 kB)
Collecting pyasn1-modules>=0.2.1 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/47/8d/d529b5d697919ba8c11ad626e835d4039be708a35b0d22de83a269a6682c/pyasn1_modules-0.4.2-py3-none-any.whl (181 kB)
Collecting rsa<5,>=3.1.4 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/64/8d/0133e4eb4beed9e425d9a98ed6e081a55d195481b7632472be1af08d2f6b/rsa-4.9.1-py3-none-any.whl (34 kB)
Collecting pyasn1>=0.1.3 (from rsa<5,>=3.1.4->google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c8/f1/d6a797abb14f6283c0ddff96bbdd46937f64122b8c925cab503dd37f8214/pyasn1-0.6.1-py3-none-any.whl (83 kB)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.11)
Collecting oauthlib>=3.0.0 (from requests-oauthlib->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/be/9c/92789c596b8df838baa98fa71844d84283302f7604ed565dafe5a6b5041a/oauthlib-3.3.1-py3-none-any.whl (160 kB)
Installing collected packages: durationpy, websocket-client, urllib3, pyasn1, oauthlib, cachetools, rsa, pyasn1-modules, requests-oauthlib, google-auth, kubernetes
  Attempting uninstall: urllib3
    Found existing installation: urllib3 2.5.0
    Uninstalling urllib3-2.5.0:
      Successfully uninstalled urllib3-2.5.0

Successfully installed cachetools-6.2.4 durationpy-0.10 google-auth-2.45.0 kubernetes-34.1.0 oauthlib-3.3.1 pyasn1-0.6.1 pyasn1-modules-0.4.2 requests-oauthlib-2.0.0 rsa-4.9.1 urllib3-2.3.0 websocket-client-1.9.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100  732k  100  732k    0     0   931k      0 --:--:-- --:--:-- --:--:--  931k
performance
vm.swappiness = 0
kernel.numa_balancing = 0
kernel.sched_migration_cost_ns = 50000
Running test case test/nightly/ascend/performance/test_ascend_qwen3_next_80b_w8a8_2p_in3k5_out1k5_50ms.py
Nic name: lo
ENV_VAR PYTORCH_NPU_ALLOC_CONF:expandable_segments:True
ENV_VAR STREAMS_PER_DEVICE:32
ENV_VAR HCCL_SOCKET_IFNAME:lo
ENV_VAR GLOO_SOCKET_IFNAME:lo
ENV_VAR HCCL_OP_EXPANSION_MODE:AIV
ENV_VAR HCCL_ALGO:level0:NA;level1:ring
ENV_VAR SGLANG_DEEPEP_NUM_MAX_DISPATCH_TOKENS_PER_RANK:20
ENV_VAR HCCL_BUFFSIZE:2000
command=python3 -m sglang.launch_server --model-path /root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8 --trust-remote-code --attention-backend ascend --device npu --tp-size 4 --mem-fraction-static 0.685 --max-running-requests 80 --watchdog-timeout 9000 --disable-radix-cache --cuda-graph-bs 80 --max-prefill-tokens 16384 --max-total-tokens 450560 --moe-a2a-backend deepep --deepep-mode auto --quantization modelslim --chunked-prefill-size -1 --device npu --host 127.0.0.1 --port 21000
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-27 00:46:39] WARNING model_config.py:813: modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-27 00:46:39] WARNING server_args.py:1824: DeepEP MoE is enabled. The expert parallel size is adjusted to be the same as the tensor parallel size[4].
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-27 00:46:40] server_args=ServerArgs(model_path='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8', tokenizer_path='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8', tokenizer_mode='auto', tokenizer_worker_num=1, skip_tokenizer_init=False, load_format='auto', model_loader_extra_config='{}', trust_remote_code=True, context_length=None, is_embedding=False, enable_multimodal=None, limit_mm_data_per_request=None, revision=None, model_impl='auto', host='127.0.0.1', port=21000, fastapi_root_path='', grpc_mode=False, skip_server_warmup=False, warmups=None, nccl_port=None, checkpoint_engine_wait_weights_before_ready=False, dtype='auto', quantization='modelslim', quantization_param_path=None, kv_cache_dtype='auto', enable_fp32_lm_head=False, modelopt_quant=None, modelopt_checkpoint_restore_path=None, modelopt_checkpoint_save_path=None, modelopt_export_path=None, quantize_and_serve=False, rl_quant_profile=None, mem_fraction_static=0.685, max_running_requests=80, max_queued_requests=None, max_total_tokens=450560, chunked_prefill_size=-1, enable_dynamic_chunking=False, max_prefill_tokens=16384, prefill_max_requests=None, schedule_policy='fcfs', enable_priority_scheduling=False, abort_on_priority_when_disabled=False, schedule_low_priority_values_first=False, priority_scheduling_preemption_threshold=10, schedule_conservativeness=1.0, page_size=128, hybrid_kvcache_ratio=None, swa_full_tokens_ratio=0.8, disable_hybrid_swa_memory=False, radix_eviction_policy='lru', device='npu', tp_size=4, pp_size=1, pp_max_micro_batch_size=None, pp_async_batch_depth=0, stream_interval=1, stream_output=False, random_seed=713166460, constrained_json_whitespace_pattern=None, constrained_json_disable_any_whitespace=False, watchdog_timeout=9000.0, soft_watchdog_timeout=None, dist_timeout=None, download_dir=None, base_gpu_id=0, gpu_id_step=1, sleep_on_idle=False, custom_sigquit_handler=None, log_level='info', log_level_http=None, log_requests=False, log_requests_level=2, crash_dump_folder=None, show_time_cost=False, enable_metrics=False, enable_metrics_for_all_schedulers=False, tokenizer_metrics_custom_labels_header='x-custom-labels', tokenizer_metrics_allowed_custom_labels=None, bucket_time_to_first_token=None, bucket_inter_token_latency=None, bucket_e2e_request_latency=None, collect_tokens_histogram=False, prompt_tokens_buckets=None, generation_tokens_buckets=None, gc_warning_threshold_secs=0.0, decode_log_interval=40, enable_request_time_stats_logging=False, kv_events_config=None, enable_trace=False, otlp_traces_endpoint='localhost:4317', export_metrics_to_file=False, export_metrics_to_file_dir=None, api_key=None, served_model_name='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8', weight_version='default', chat_template=None, completion_template=None, file_storage_path='sglang_storage', enable_cache_report=False, reasoning_parser=None, tool_call_parser=None, tool_server=None, sampling_defaults='model', dp_size=1, load_balance_method='round_robin', load_watch_interval=0.1, prefill_round_robin_balance=False, dist_init_addr=None, nnodes=1, node_rank=0, json_model_override_args='{}', preferred_sampling_params=None, enable_lora=None, max_lora_rank=None, lora_target_modules=None, lora_paths=None, max_loaded_loras=None, max_loras_per_batch=8, lora_eviction_policy='lru', lora_backend='csgmv', max_lora_chunk_size=16, attention_backend='ascend', decode_attention_backend='ascend', prefill_attention_backend='ascend', sampling_backend='pytorch', grammar_backend='xgrammar', mm_attention_backend=None, fp8_gemm_runner_backend='auto', nsa_prefill_backend='flashmla_sparse', nsa_decode_backend='fa3', disable_flashinfer_autotune=False, speculative_algorithm=None, speculative_draft_model_path=None, speculative_draft_model_revision=None, speculative_draft_load_format=None, speculative_num_steps=None, speculative_eagle_topk=None, speculative_num_draft_tokens=None, speculative_accept_threshold_single=1.0, speculative_accept_threshold_acc=1.0, speculative_token_map=None, speculative_attention_mode='prefill', speculative_draft_attention_backend=None, speculative_moe_runner_backend='auto', speculative_moe_a2a_backend=None, speculative_draft_model_quantization='modelslim', speculative_ngram_min_match_window_size=1, speculative_ngram_max_match_window_size=12, speculative_ngram_min_bfs_breadth=1, speculative_ngram_max_bfs_breadth=10, speculative_ngram_match_type='BFS', speculative_ngram_branch_length=18, speculative_ngram_capacity=10000000, enable_mtp=False, ep_size=4, moe_a2a_backend='deepep', moe_runner_backend='auto', flashinfer_mxfp4_moe_precision='default', enable_flashinfer_allreduce_fusion=False, deepep_mode='auto', ep_num_redundant_experts=0, ep_dispatch_algorithm=None, init_expert_location='trivial', enable_eplb=False, enable_async_eplb=False, eplb_algorithm='auto', eplb_rebalance_num_iterations=1000, eplb_rebalance_layers_per_chunk=None, eplb_min_rebalancing_utilization_threshold=1.0, expert_distribution_recorder_mode=None, expert_distribution_recorder_buffer_size=1000, enable_expert_distribution_metrics=False, deepep_config=None, moe_dense_tp_size=None, elastic_ep_backend=None, mooncake_ib_device=None, max_mamba_cache_size=None, mamba_ssm_dtype='float32', mamba_full_memory_ratio=0.9, mamba_scheduler_strategy='no_buffer', mamba_track_interval=256, enable_hierarchical_cache=False, hicache_ratio=2.0, hicache_size=0, hicache_write_policy='write_through', hicache_io_backend='kernel', hicache_mem_layout='layer_first', hicache_storage_backend=None, hicache_storage_prefetch_policy='best_effort', hicache_storage_backend_extra_config=None, enable_lmcache=False, kt_weight_path=None, kt_method='AMXINT4', kt_cpuinfer=None, kt_threadpool_count=2, kt_num_gpu_experts=None, kt_max_deferred_experts_per_token=None, dllm_algorithm=None, dllm_algorithm_config=None, enable_double_sparsity=False, ds_channel_config_path=None, ds_heavy_channel_num=32, ds_heavy_token_num=256, ds_heavy_channel_type='qk', ds_sparse_decode_threshold=4096, cpu_offload_gb=0, offload_group_size=-1, offload_num_in_group=1, offload_prefetch_step=1, offload_mode='cpu', multi_item_scoring_delimiter=None, disable_radix_cache=True, cuda_graph_max_bs=80, cuda_graph_bs=[80], disable_cuda_graph=False, disable_cuda_graph_padding=False, enable_profile_cuda_graph=False, enable_cudagraph_gc=False, enable_layerwise_nvtx_marker=False, enable_nccl_nvls=False, enable_symm_mem=False, disable_flashinfer_cutlass_moe_fp4_allgather=False, enable_tokenizer_batch_encode=False, disable_tokenizer_batch_decode=False, disable_outlines_disk_cache=False, disable_custom_all_reduce=True, enable_mscclpp=False, enable_torch_symm_mem=False, disable_overlap_schedule=False, enable_mixed_chunk=False, enable_dp_attention=False, enable_dp_lm_head=False, enable_two_batch_overlap=False, enable_single_batch_overlap=False, tbo_token_distribution_threshold=0.48, enable_torch_compile=False, enable_piecewise_cuda_graph=False, enable_torch_compile_debug_mode=False, torch_compile_max_bs=32, piecewise_cuda_graph_max_tokens=4096, piecewise_cuda_graph_tokens=[4, 8, 12, 16, 20, 24, 28, 32, 48, 64, 80, 96, 112, 128, 144, 160, 176, 192, 208, 224, 240, 256, 288, 320, 352, 384, 416, 448, 480, 512, 640, 768, 896, 1024, 1152, 1280, 1408, 1536, 1664, 1792, 1920, 2048, 2176, 2304, 2432, 2560, 2688, 2816, 2944, 3072, 3200, 3328, 3456, 3584, 3712, 3840, 3968, 4096], piecewise_cuda_graph_compiler='eager', torchao_config='', enable_nan_detection=False, enable_p2p_check=False, triton_attention_reduce_in_fp32=False, triton_attention_num_kv_splits=8, triton_attention_split_tile_size=None, num_continuous_decode_steps=1, delete_ckpt_after_loading=False, enable_memory_saver=False, enable_weights_cpu_backup=False, enable_draft_weights_cpu_backup=False, allow_auto_truncate=False, enable_custom_logit_processor=False, flashinfer_mla_disable_ragged=False, disable_shared_experts_fusion=False, disable_chunked_prefix_cache=False, disable_fast_image_processor=False, keep_mm_feature_on_device=False, enable_return_hidden_states=False, enable_return_routed_experts=False, scheduler_recv_interval=1, numa_node=None, enable_deterministic_inference=False, rl_on_policy_target=None, enable_attn_tp_input_scattered=False, enable_nsa_prefill_context_parallel=False, enable_fused_qk_norm_rope=False, enable_dynamic_batch_tokenizer=False, dynamic_batch_tokenizer_batch_size=32, dynamic_batch_tokenizer_batch_timeout=0.002, debug_tensor_dump_output_folder=None, debug_tensor_dump_layers=None, debug_tensor_dump_input_file=None, debug_tensor_dump_inject=False, disaggregation_mode='null', disaggregation_transfer_backend='mooncake', disaggregation_bootstrap_port=8998, disaggregation_decode_tp=None, disaggregation_decode_dp=None, disaggregation_prefill_pp=1, disaggregation_ib_device=None, disaggregation_decode_enable_offload_kvcache=False, num_reserved_decode_tokens=512, disaggregation_decode_polling_interval=1, encoder_only=False, language_only=False, encoder_transfer_backend='zmq_to_scheduler', encoder_urls=[], custom_weight_loader=[], weight_loader_disable_mmap=False, remote_instance_weight_loader_seed_instance_ip=None, remote_instance_weight_loader_seed_instance_service_port=None, remote_instance_weight_loader_send_weights_group_ports=None, remote_instance_weight_loader_backend='nccl', remote_instance_weight_loader_start_seed_via_transfer_engine=False, enable_pdmux=False, pdmux_config_path=None, sm_group_num=8, mm_max_concurrent_calls=32, mm_per_request_timeout=10.0, enable_broadcast_mm_inputs_process=False, enable_prefix_mm_cache=False, mm_enable_dp_encoder=False, mm_process_config={}, decrypted_config_file=None, decrypted_draft_config_file=None, forward_hooks=None)
[2025-12-27 00:46:40] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-27 00:46:40] Using default HuggingFace chat template with detected content format: string
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-27 00:46:49 TP1 EP1] Process 1111 gpu_id 1 is running on CPUs: [80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99, 100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119, 120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139, 140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
[2025-12-27 00:46:49 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-27 00:46:49 TP0 EP0] Process 1110 gpu_id 0 is running on CPUs: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39, 40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
[2025-12-27 00:46:49 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-27 00:46:49 TP2 EP2] Process 1112 gpu_id 2 is running on CPUs: [160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179, 180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199, 200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219, 220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-27 00:46:49 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-27 00:46:49 TP3 EP3] Process 1113 gpu_id 3 is running on CPUs: [240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259, 260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279, 280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319]
[2025-12-27 00:46:49 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-27 00:46:50 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-27 00:46:50 TP1 EP1] Init torch distributed begin.
[2025-12-27 00:46:50 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-27 00:46:50 TP0 EP0] Init torch distributed begin.
[2025-12-27 00:46:50 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-27 00:46:50 TP2 EP2] Init torch distributed begin.
[2025-12-27 00:46:50 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-27 00:46:50 TP3 EP3] Init torch distributed begin.
[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 1 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 0 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 3 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[Gloo] Rank 2 is connected to 3 peer ranks. Expected number of connected peer ranks is : 3
[2025-12-27 00:46:51 TP0 EP0] Init torch distributed ends. mem usage=0.00 GB
[2025-12-27 00:46:51 TP3 EP3] Init torch distributed ends. mem usage=0.00 GB
[2025-12-27 00:46:51 TP1 EP1] Init torch distributed ends. mem usage=0.00 GB
[2025-12-27 00:46:51 TP2 EP2] Init torch distributed ends. mem usage=0.00 GB
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-27 00:46:52 TP2 EP2] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-27 00:46:52 TP1 EP1] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-27 00:46:52 TP0 EP0] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-27 00:46:52 TP3 EP3] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-27 00:46:52 TP2 EP2] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-27 00:46:52 TP1 EP1] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-27 00:46:52 TP0 EP0] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-27 00:46:52 TP3 EP3] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-27 00:46:54 TP2 EP2] Load weight begin. avail mem=60.79 GB
[2025-12-27 00:46:54 TP0 EP0] Load weight begin. avail mem=60.72 GB
[2025-12-27 00:46:54 TP1 EP1] Load weight begin. avail mem=61.02 GB
[2025-12-27 00:46:54 TP3 EP3] Load weight begin. avail mem=61.02 GB
`torch_dtype` is deprecated! Use `dtype` instead!
[2025-12-27 00:46:54 TP2 EP2] using attn output gate!
`torch_dtype` is deprecated! Use `dtype` instead!
`torch_dtype` is deprecated! Use `dtype` instead!
[2025-12-27 00:46:54 TP1 EP1] using attn output gate!
[2025-12-27 00:46:54 TP0 EP0] using attn output gate!
`torch_dtype` is deprecated! Use `dtype` instead!
[2025-12-27 00:46:54 TP3 EP3] using attn output gate!

Loading safetensors checkpoint shards:   0% Completed | 0/19 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:   5% Completed | 1/19 [00:05<01:39,  5.52s/it]

Loading safetensors checkpoint shards:  11% Completed | 2/19 [00:11<01:35,  5.65s/it]

Loading safetensors checkpoint shards:  16% Completed | 3/19 [00:16<01:29,  5.57s/it]

Loading safetensors checkpoint shards:  21% Completed | 4/19 [00:22<01:25,  5.71s/it]

Loading safetensors checkpoint shards:  26% Completed | 5/19 [00:28<01:19,  5.68s/it]

Loading safetensors checkpoint shards:  32% Completed | 6/19 [00:32<01:05,  5.06s/it]

Loading safetensors checkpoint shards:  37% Completed | 7/19 [00:37<01:02,  5.24s/it]

Loading safetensors checkpoint shards:  42% Completed | 8/19 [00:43<00:58,  5.30s/it]

Loading safetensors checkpoint shards:  47% Completed | 9/19 [00:48<00:53,  5.40s/it]

Loading safetensors checkpoint shards:  53% Completed | 10/19 [00:54<00:49,  5.46s/it]

Loading safetensors checkpoint shards:  58% Completed | 11/19 [01:00<00:44,  5.51s/it]

Loading safetensors checkpoint shards:  63% Completed | 12/19 [01:05<00:38,  5.55s/it]

Loading safetensors checkpoint shards:  68% Completed | 13/19 [01:11<00:33,  5.60s/it]

Loading safetensors checkpoint shards:  74% Completed | 14/19 [01:17<00:28,  5.69s/it]

Loading safetensors checkpoint shards:  79% Completed | 15/19 [01:22<00:22,  5.66s/it]

Loading safetensors checkpoint shards:  84% Completed | 16/19 [01:28<00:16,  5.60s/it]

Loading safetensors checkpoint shards:  89% Completed | 17/19 [01:34<00:11,  5.65s/it]

Loading safetensors checkpoint shards:  95% Completed | 18/19 [01:39<00:05,  5.56s/it]

Loading safetensors checkpoint shards: 100% Completed | 19/19 [01:45<00:00,  5.61s/it]

Loading safetensors checkpoint shards: 100% Completed | 19/19 [01:45<00:00,  5.54s/it]

[2025-12-27 00:49:02 TP3 EP3] Load weight end. type=Qwen3NextForCausalLM, dtype=torch.bfloat16, avail mem=41.07 GB, mem usage=19.96 GB.
[2025-12-27 00:49:02 TP1 EP1] Load weight end. type=Qwen3NextForCausalLM, dtype=torch.bfloat16, avail mem=41.07 GB, mem usage=19.96 GB.
[2025-12-27 00:49:02 TP2 EP2] Load weight end. type=Qwen3NextForCausalLM, dtype=torch.bfloat16, avail mem=40.84 GB, mem usage=19.96 GB.
[2025-12-27 00:49:02 TP0 EP0] Load weight end. type=Qwen3NextForCausalLM, dtype=torch.bfloat16, avail mem=40.76 GB, mem usage=19.96 GB.
[2025-12-27 00:49:02 TP0 EP0] Using KV cache dtype: torch.bfloat16
[2025-12-27 00:49:02 TP1 EP1] The available memory for KV cache is 20.12 GB.
[2025-12-27 00:49:02 TP0 EP0] The available memory for KV cache is 20.12 GB.
[2025-12-27 00:49:02 TP2 EP2] The available memory for KV cache is 20.12 GB.
[2025-12-27 00:49:02 TP3 EP3] The available memory for KV cache is 20.12 GB.
[2025-12-27 00:49:02 TP3 EP3] Mamba Cache is allocated. max_mamba_cache_size: 80, conv_state size: 0.03GB, ssm_state size: 1.42GB 
[2025-12-27 00:49:02 TP1 EP1] Mamba Cache is allocated. max_mamba_cache_size: 80, conv_state size: 0.03GB, ssm_state size: 1.42GB 
[2025-12-27 00:49:02 TP2 EP2] Mamba Cache is allocated. max_mamba_cache_size: 80, conv_state size: 0.03GB, ssm_state size: 1.42GB 
[2025-12-27 00:49:02 TP0 EP0] Mamba Cache is allocated. max_mamba_cache_size: 80, conv_state size: 0.03GB, ssm_state size: 1.42GB 
[2025-12-27 00:49:02 TP1 EP1] KV Cache is allocated. #tokens: 450560, K size: 10.32 GB, V size: 10.32 GB
[2025-12-27 00:49:02 TP0 EP0] KV Cache is allocated. #tokens: 450560, K size: 10.32 GB, V size: 10.32 GB
[2025-12-27 00:49:02 TP2 EP2] KV Cache is allocated. #tokens: 450560, K size: 10.32 GB, V size: 10.32 GB
[2025-12-27 00:49:02 TP1 EP1] Memory pool end. avail mem=18.86 GB
[2025-12-27 00:49:02 TP3 EP3] KV Cache is allocated. #tokens: 450560, K size: 10.32 GB, V size: 10.32 GB
[2025-12-27 00:49:02 TP0 EP0] Memory pool end. avail mem=18.55 GB
[2025-12-27 00:49:02 TP2 EP2] Memory pool end. avail mem=18.63 GB
[2025-12-27 00:49:02 TP3 EP3] Memory pool end. avail mem=18.86 GB
[2025-12-27 00:49:03 TP1 EP1] Using hybrid linear attention backend for hybrid GDN models.
[2025-12-27 00:49:03 TP1 EP1] Capture cuda graph begin. This can take up to several minutes. avail mem=18.86 GB
[2025-12-27 00:49:03 TP0 EP0] Using hybrid linear attention backend for hybrid GDN models.
[2025-12-27 00:49:03 TP0 EP0] Capture cuda graph begin. This can take up to several minutes. avail mem=18.55 GB
[2025-12-27 00:49:03 TP0 EP0] Capture cuda graph bs [80]
[2025-12-27 00:49:03 TP2 EP2] Using hybrid linear attention backend for hybrid GDN models.
[2025-12-27 00:49:03 TP2 EP2] Capture cuda graph begin. This can take up to several minutes. avail mem=18.63 GB
[2025-12-27 00:49:03 TP3 EP3] Using hybrid linear attention backend for hybrid GDN models.
[2025-12-27 00:49:03 TP3 EP3] Capture cuda graph begin. This can take up to several minutes. avail mem=18.86 GB

  0%|          | 0/1 [00:00<?, ?it/s]
Capturing batches (bs=80 avail_mem=18.50 GB):   0%|          | 0/1 [00:00<?, ?it/s][rank0]:[W1227 00:49:28.412735055 compiler_depend.ts:207] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank3]:[W1227 00:49:28.412740776 compiler_depend.ts:207] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank1]:[W1227 00:49:28.412751426 compiler_depend.ts:207] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank2]:[W1227 00:49:28.412748536 compiler_depend.ts:207] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/utils/storage.py:90: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if self.device.type != 'cpu':
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/utils/storage.py:90: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if self.device.type != 'cpu':
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/utils/storage.py:90: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if self.device.type != 'cpu':
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/utils/storage.py:90: UserWarning: TypedStorage is deprecated. It will be removed in the future and UntypedStorage will be the only storage class. This should only matter to you if you are using storages directly.  To access UntypedStorage directly, use tensor.untyped_storage() instead of tensor.storage()
  if self.device.type != 'cpu':

Capturing batches (bs=80 avail_mem=18.50 GB): 100%|| 1/1 [00:26<00:00, 26.30s/it]
Capturing batches (bs=80 avail_mem=18.50 GB): 100%|| 1/1 [00:26<00:00, 26.30s/it]
[2025-12-27 00:49:30 TP2 EP2] Capture cuda graph end. Time elapsed: 27.25 s. mem usage=8.34 GB. avail mem=10.29 GB.
[2025-12-27 00:49:30 TP1 EP1] Capture cuda graph end. Time elapsed: 27.38 s. mem usage=8.33 GB. avail mem=10.52 GB.
[2025-12-27 00:49:30 TP0 EP0] Capture cuda graph end. Time elapsed: 27.41 s. mem usage=8.34 GB. avail mem=10.22 GB.
[2025-12-27 00:49:30 TP3 EP3] Capture cuda graph end. Time elapsed: 27.43 s. mem usage=8.34 GB. avail mem=10.52 GB.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:1204: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  tensor_data = torch.ByteTensor(
[2025-12-27 00:49:30 TP0 EP0] max_total_num_tokens=450560, chunked_prefill_size=-1, max_prefill_tokens=16384, max_running_requests=80, context_len=262144, available_gpu_mem=10.22 GB
[2025-12-27 00:49:31] INFO:     Started server process [798]
[2025-12-27 00:49:31] INFO:     Waiting for application startup.
[2025-12-27 00:49:31] Using default chat sampling params from model generation config: {'repetition_penalty': 1.0, 'temperature': 0.7, 'top_k': 20, 'top_p': 0.8}
[2025-12-27 00:49:31] Using default chat sampling params from model generation config: {'repetition_penalty': 1.0, 'temperature': 0.7, 'top_k': 20, 'top_p': 0.8}
[2025-12-27 00:49:31] INFO:     Application startup complete.
[2025-12-27 00:49:31] INFO:     Uvicorn running on http://127.0.0.1:21000 (Press CTRL+C to quit)
[2025-12-27 00:49:32] INFO:     127.0.0.1:60896 - "GET /model_info HTTP/1.1" 200 OK
[2025-12-27 00:49:32 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, full token usage: 0.00, mamba usage: 0.00, #running-req: 0, #queue-req: 0, 
[rank2]:[W1227 00:49:32.169557171 compiler_depend.ts:198] Warning: Driver Version: "" is invalid or not supported yet. (function operator())
[rank1]:[W1227 00:49:32.169698186 compiler_depend.ts:198] Warning: Driver Version: "" is invalid or not supported yet. (function operator())
[rank0]:[W1227 00:49:32.169786339 compiler_depend.ts:198] Warning: Driver Version: "" is invalid or not supported yet. (function operator())
[rank3]:[W1227 00:49:32.169823791 compiler_depend.ts:198] Warning: Driver Version: "" is invalid or not supported yet. (function operator())
[2025-12-27 00:49:38] INFO:     127.0.0.1:51076 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
....[2025-12-27 00:49:48] INFO:     127.0.0.1:33466 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-27 00:49:58] INFO:     127.0.0.1:49334 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-27 00:50:08] INFO:     127.0.0.1:36788 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
....[2025-12-27 00:50:15] INFO:     127.0.0.1:60912 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:15] The server is fired up and ready to roll!
[2025-12-27 00:50:18 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, full token usage: 0.00, mamba usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-27 00:50:24] INFO:     127.0.0.1:57556 - "GET /health_generate HTTP/1.1" 200 OK
[CI Test Method] TestQwen3_Next_80B_A3B.test_qwen3_next_80b_a3b
The metrics result file: /data/d00662834/metrics/20251227/test_ascend_qwen3_next_80b_w8a8_2p_in3k5_out1k5_50ms.txt
command:python3 -m sglang.bench_serving --backend sglang --model /root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8 --host 127.0.0.1 --port 21000 --dataset-name random  --max-concurrency 80 --num-prompts 160 --random-input-len 3500 --random-output-len 1500 --random-range-ratio 1
[2025-12-27 00:50:48] INFO:     127.0.0.1:57568 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:48 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, full token usage: 0.00, mamba usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-27 00:50:54 TP0 EP0] Decode batch, #running-req: 1, #full token: 0, full token usage: 0.00, mamba num: 0, mamba usage: 0.00, cpu graph: True, gen throughput (token/s): 0.16, #queue-req: 0, 
[2025-12-27 00:50:55] INFO:     127.0.0.1:57574 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57582 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, full token usage: 0.00, mamba usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-27 00:50:55] INFO:     127.0.0.1:57584 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57592 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57598 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57602 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57608 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57624 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57636 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57652 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57654 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57660 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57666 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57682 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57688 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57704 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57718 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57726 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57738 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57754 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57764 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57778 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57786 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57796 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57798 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57814 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57828 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57832 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57834 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57850 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57866 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57880 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57888 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57898 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57902 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57910 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57924 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57940 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57956 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57958 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57968 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57974 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:55] INFO:     127.0.0.1:57986 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:57988 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:57996 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58000 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58016 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58018 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58024 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58028 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58042 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58044 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58048 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58054 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58062 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58074 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58086 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.01, mamba usage: 0.01, #running-req: 1, #queue-req: 50, 
[2025-12-27 00:50:56] INFO:     127.0.0.1:58090 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58092 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58102 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58104 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58120 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58132 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58146 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58158 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58168 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58178 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58192 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58196 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58198 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58210 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58212 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58216 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58226 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58240 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58254 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58266 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58268 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58272 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:50:56] INFO:     127.0.0.1:58280 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:51:00 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.05, mamba usage: 0.07, #running-req: 6, #queue-req: 69, 
[2025-12-27 00:51:01 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.09, mamba usage: 0.14, #running-req: 11, #queue-req: 64, 
[2025-12-27 00:51:02 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 18304, #cached-token: 0, full token usage: 0.13, mamba usage: 0.20, #running-req: 16, #queue-req: 59, 
[2025-12-27 00:51:04 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17792, #cached-token: 0, full token usage: 0.17, mamba usage: 0.26, #running-req: 21, #queue-req: 54, 
[2025-12-27 00:51:07 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.21, mamba usage: 0.33, #running-req: 26, #queue-req: 49, 
[2025-12-27 00:51:08 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.25, mamba usage: 0.39, #running-req: 31, #queue-req: 44, 
[2025-12-27 00:51:09 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 18816, #cached-token: 0, full token usage: 0.29, mamba usage: 0.45, #running-req: 36, #queue-req: 39, 
[2025-12-27 00:51:11 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.33, mamba usage: 0.51, #running-req: 41, #queue-req: 34, 
[2025-12-27 00:51:12 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.37, mamba usage: 0.57, #running-req: 46, #queue-req: 29, 
[2025-12-27 00:51:15 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.41, mamba usage: 0.64, #running-req: 51, #queue-req: 24, 
[2025-12-27 00:51:16 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.45, mamba usage: 0.70, #running-req: 56, #queue-req: 19, 
[2025-12-27 00:51:18 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.49, mamba usage: 0.76, #running-req: 61, #queue-req: 14, 
[2025-12-27 00:51:19 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.53, mamba usage: 0.82, #running-req: 66, #queue-req: 9, 
[2025-12-27 00:51:21 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.57, mamba usage: 0.89, #running-req: 71, #queue-req: 4, 
[2025-12-27 00:51:22 TP0 EP0] Prefill batch, #new-seq: 4, #new-token: 14336, #cached-token: 0, full token usage: 0.61, mamba usage: 0.95, #running-req: 76, #queue-req: 0, 
[2025-12-27 00:51:26 TP0 EP0] Decode batch, #running-req: 80, #full token: 287872, full token usage: 0.64, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 97.41, #queue-req: 0, 
[2025-12-27 00:51:28 TP0 EP0] Decode batch, #running-req: 80, #full token: 288512, full token usage: 0.64, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1808.24, #queue-req: 0, 
[2025-12-27 00:51:30 TP0 EP0] Decode batch, #running-req: 80, #full token: 298112, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1786.80, #queue-req: 0, 
[2025-12-27 00:51:31 TP0 EP0] Decode batch, #running-req: 80, #full token: 298112, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1759.16, #queue-req: 0, 
[2025-12-27 00:51:33 TP0 EP0] Decode batch, #running-req: 80, #full token: 298752, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1756.59, #queue-req: 0, 
[2025-12-27 00:51:35 TP0 EP0] Decode batch, #running-req: 80, #full token: 308352, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1632.10, #queue-req: 0, 
[2025-12-27 00:51:37 TP0 EP0] Decode batch, #running-req: 80, #full token: 308352, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1738.30, #queue-req: 0, 
[2025-12-27 00:51:39 TP0 EP0] Decode batch, #running-req: 80, #full token: 308608, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1738.99, #queue-req: 0, 
[2025-12-27 00:51:41 TP0 EP0] Decode batch, #running-req: 80, #full token: 318336, full token usage: 0.71, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1736.85, #queue-req: 0, 
[2025-12-27 00:51:43 TP0 EP0] Decode batch, #running-req: 80, #full token: 318592, full token usage: 0.71, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1731.11, #queue-req: 0, 
[2025-12-27 00:51:44 TP0 EP0] Decode batch, #running-req: 80, #full token: 318720, full token usage: 0.71, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1727.50, #queue-req: 0, 
[2025-12-27 00:51:46 TP0 EP0] Decode batch, #running-req: 80, #full token: 327424, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1726.84, #queue-req: 0, 
[2025-12-27 00:51:48 TP0 EP0] Decode batch, #running-req: 80, #full token: 328832, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1721.64, #queue-req: 0, 
[2025-12-27 00:51:50 TP0 EP0] Decode batch, #running-req: 80, #full token: 328832, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1720.31, #queue-req: 0, 
[2025-12-27 00:51:52 TP0 EP0] Decode batch, #running-req: 80, #full token: 336384, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1719.41, #queue-req: 0, 
[2025-12-27 00:51:54 TP0 EP0] Decode batch, #running-req: 80, #full token: 339072, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1715.47, #queue-req: 0, 
[2025-12-27 00:51:56 TP0 EP0] Decode batch, #running-req: 80, #full token: 339072, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1704.53, #queue-req: 0, 
[2025-12-27 00:51:57 TP0 EP0] Decode batch, #running-req: 80, #full token: 339712, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1702.99, #queue-req: 0, 
[2025-12-27 00:51:59 TP0 EP0] Decode batch, #running-req: 80, #full token: 349312, full token usage: 0.78, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1701.28, #queue-req: 0, 
[2025-12-27 00:52:01 TP0 EP0] Decode batch, #running-req: 80, #full token: 349312, full token usage: 0.78, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1703.82, #queue-req: 0, 
[2025-12-27 00:52:03 TP0 EP0] Decode batch, #running-req: 80, #full token: 349952, full token usage: 0.78, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1706.20, #queue-req: 0, 
[2025-12-27 00:52:05 TP0 EP0] Decode batch, #running-req: 80, #full token: 359552, full token usage: 0.80, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1704.99, #queue-req: 0, 
[2025-12-27 00:52:07 TP0 EP0] Decode batch, #running-req: 80, #full token: 359552, full token usage: 0.80, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1698.07, #queue-req: 0, 
[2025-12-27 00:52:09 TP0 EP0] Decode batch, #running-req: 80, #full token: 359808, full token usage: 0.80, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1696.50, #queue-req: 0, 
[2025-12-27 00:52:11 TP0 EP0] Decode batch, #running-req: 80, #full token: 369536, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1692.59, #queue-req: 0, 
[2025-12-27 00:52:13 TP0 EP0] Decode batch, #running-req: 80, #full token: 369792, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1693.90, #queue-req: 0, 
[2025-12-27 00:52:14 TP0 EP0] Decode batch, #running-req: 80, #full token: 369920, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1696.22, #queue-req: 0, 
[2025-12-27 00:52:16 TP0 EP0] Decode batch, #running-req: 80, #full token: 378624, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1686.84, #queue-req: 0, 
[2025-12-27 00:52:18 TP0 EP0] Decode batch, #running-req: 80, #full token: 380032, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1689.90, #queue-req: 0, 
[2025-12-27 00:52:20 TP0 EP0] Decode batch, #running-req: 80, #full token: 380032, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1685.74, #queue-req: 0, 
[2025-12-27 00:52:22 TP0 EP0] Decode batch, #running-req: 80, #full token: 387584, full token usage: 0.86, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1684.31, #queue-req: 0, 
[2025-12-27 00:52:24 TP0 EP0] Decode batch, #running-req: 80, #full token: 390272, full token usage: 0.87, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1683.09, #queue-req: 0, 
[2025-12-27 00:52:26 TP0 EP0] Decode batch, #running-req: 80, #full token: 390272, full token usage: 0.87, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1685.06, #queue-req: 0, 
[2025-12-27 00:52:28 TP0 EP0] Decode batch, #running-req: 80, #full token: 390912, full token usage: 0.87, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1682.06, #queue-req: 0, 
[2025-12-27 00:52:30 TP0 EP0] Decode batch, #running-req: 80, #full token: 400512, full token usage: 0.89, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1682.67, #queue-req: 0, 
[2025-12-27 00:52:32 TP0 EP0] Decode batch, #running-req: 80, #full token: 400512, full token usage: 0.89, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1680.39, #queue-req: 0, 
[2025-12-27 00:52:33 TP0 EP0] Decode batch, #running-req: 80, #full token: 401152, full token usage: 0.89, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1686.07, #queue-req: 0, 
[2025-12-27 00:52:34] INFO:     127.0.0.1:58328 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:34 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, full token usage: 0.00, mamba usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-27 00:52:34] INFO:     127.0.0.1:58336 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58340 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58350 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58358 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58370 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58374 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58390 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58394 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58396 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58412 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58420 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58430 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58438 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58446 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58460 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58464 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58474 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58478 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58480 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58488 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58504 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58508 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58514 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58530 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58546 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58556 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58568 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58578 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58584 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58600 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58604 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58610 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58612 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58620 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58630 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58640 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58650 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58656 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58670 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58682 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58686 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58692 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58708 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58718 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58726 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58734 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58738 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58752 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58768 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58774 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58784 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58796 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58802 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58804 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58820 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58826 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.01, mamba usage: 0.01, #running-req: 1, #queue-req: 49, 
[2025-12-27 00:52:35] INFO:     127.0.0.1:58842 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58850 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58862 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58870 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58884 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58886 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58888 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58896 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58904 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58920 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58926 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58930 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58934 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58946 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58950 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58960 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58966 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58970 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58984 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:58998 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:59000 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:59014 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:35] INFO:     127.0.0.1:59016 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:52:36 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.05, mamba usage: 0.07, #running-req: 6, #queue-req: 69, 
[2025-12-27 00:52:38 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.09, mamba usage: 0.14, #running-req: 11, #queue-req: 64, 
[2025-12-27 00:52:39 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.13, mamba usage: 0.20, #running-req: 16, #queue-req: 59, 
[2025-12-27 00:52:41 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.17, mamba usage: 0.26, #running-req: 21, #queue-req: 54, 
[2025-12-27 00:52:42 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.21, mamba usage: 0.33, #running-req: 26, #queue-req: 49, 
[2025-12-27 00:52:43 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.25, mamba usage: 0.39, #running-req: 31, #queue-req: 44, 
[2025-12-27 00:52:45 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.29, mamba usage: 0.45, #running-req: 36, #queue-req: 39, 
[2025-12-27 00:52:46 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17792, #cached-token: 0, full token usage: 0.33, mamba usage: 0.51, #running-req: 41, #queue-req: 34, 
[2025-12-27 00:52:48 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.37, mamba usage: 0.57, #running-req: 46, #queue-req: 29, 
[2025-12-27 00:52:49 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17792, #cached-token: 0, full token usage: 0.41, mamba usage: 0.64, #running-req: 51, #queue-req: 24, 
[2025-12-27 00:52:51 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.44, mamba usage: 0.70, #running-req: 56, #queue-req: 19, 
[2025-12-27 00:52:52 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.48, mamba usage: 0.76, #running-req: 61, #queue-req: 14, 
[2025-12-27 00:52:53 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17792, #cached-token: 0, full token usage: 0.52, mamba usage: 0.82, #running-req: 66, #queue-req: 9, 
[2025-12-27 00:52:55 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.56, mamba usage: 0.89, #running-req: 71, #queue-req: 4, 
[2025-12-27 00:52:56 TP0 EP0] Prefill batch, #new-seq: 4, #new-token: 14080, #cached-token: 0, full token usage: 0.60, mamba usage: 0.95, #running-req: 76, #queue-req: 0, 
[2025-12-27 00:52:58 TP0 EP0] Decode batch, #running-req: 80, #full token: 286208, full token usage: 0.64, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 127.91, #queue-req: 0, 
[2025-12-27 00:53:00 TP0 EP0] Decode batch, #running-req: 80, #full token: 286464, full token usage: 0.64, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1814.48, #queue-req: 0, 
[2025-12-27 00:53:02 TP0 EP0] Decode batch, #running-req: 80, #full token: 295296, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1809.69, #queue-req: 0, 
[2025-12-27 00:53:04 TP0 EP0] Decode batch, #running-req: 80, #full token: 296320, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1813.45, #queue-req: 0, 
[2025-12-27 00:53:06 TP0 EP0] Decode batch, #running-req: 80, #full token: 296704, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1800.90, #queue-req: 0, 
[2025-12-27 00:53:07 TP0 EP0] Decode batch, #running-req: 80, #full token: 304640, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1798.22, #queue-req: 0, 
[2025-12-27 00:53:09 TP0 EP0] Decode batch, #running-req: 80, #full token: 306560, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1788.11, #queue-req: 0, 
[2025-12-27 00:53:11 TP0 EP0] Decode batch, #running-req: 80, #full token: 306944, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1785.71, #queue-req: 0, 
[2025-12-27 00:53:13 TP0 EP0] Decode batch, #running-req: 80, #full token: 307200, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1784.59, #queue-req: 0, 
[2025-12-27 00:53:14 TP0 EP0] Decode batch, #running-req: 80, #full token: 316800, full token usage: 0.70, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1776.84, #queue-req: 0, 
[2025-12-27 00:53:16 TP0 EP0] Decode batch, #running-req: 80, #full token: 317056, full token usage: 0.70, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1761.51, #queue-req: 0, 
[2025-12-27 00:53:18 TP0 EP0] Decode batch, #running-req: 80, #full token: 317312, full token usage: 0.70, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1759.95, #queue-req: 0, 
[2025-12-27 00:53:20 TP0 EP0] Decode batch, #running-req: 80, #full token: 326656, full token usage: 0.72, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1752.12, #queue-req: 0, 
[2025-12-27 00:53:22 TP0 EP0] Decode batch, #running-req: 80, #full token: 327296, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1744.96, #queue-req: 0, 
[2025-12-27 00:53:24 TP0 EP0] Decode batch, #running-req: 80, #full token: 327424, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1732.52, #queue-req: 0, 
[2025-12-27 00:53:25 TP0 EP0] Decode batch, #running-req: 80, #full token: 336768, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1725.55, #queue-req: 0, 
[2025-12-27 00:53:27 TP0 EP0] Decode batch, #running-req: 80, #full token: 337408, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1726.42, #queue-req: 0, 
[2025-12-27 00:53:29 TP0 EP0] Decode batch, #running-req: 80, #full token: 337664, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1715.32, #queue-req: 0, 
[2025-12-27 00:53:31 TP0 EP0] Decode batch, #running-req: 80, #full token: 346496, full token usage: 0.77, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1712.40, #queue-req: 0, 
[2025-12-27 00:53:33 TP0 EP0] Decode batch, #running-req: 80, #full token: 347520, full token usage: 0.77, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1714.12, #queue-req: 0, 
[2025-12-27 00:53:35 TP0 EP0] Decode batch, #running-req: 80, #full token: 347904, full token usage: 0.77, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1691.65, #queue-req: 0, 
[2025-12-27 00:53:37 TP0 EP0] Decode batch, #running-req: 80, #full token: 355840, full token usage: 0.79, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1715.57, #queue-req: 0, 
[2025-12-27 00:53:39 TP0 EP0] Decode batch, #running-req: 80, #full token: 357760, full token usage: 0.79, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1715.24, #queue-req: 0, 
[2025-12-27 00:53:40 TP0 EP0] Decode batch, #running-req: 80, #full token: 358144, full token usage: 0.79, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1716.14, #queue-req: 0, 
[2025-12-27 00:53:42 TP0 EP0] Decode batch, #running-req: 80, #full token: 358400, full token usage: 0.80, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1711.16, #queue-req: 0, 
[2025-12-27 00:53:44 TP0 EP0] Decode batch, #running-req: 80, #full token: 368000, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1710.47, #queue-req: 0, 
[2025-12-27 00:53:46 TP0 EP0] Decode batch, #running-req: 80, #full token: 368256, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1706.90, #queue-req: 0, 
[2025-12-27 00:53:48 TP0 EP0] Decode batch, #running-req: 80, #full token: 368512, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1704.84, #queue-req: 0, 
[2025-12-27 00:53:50 TP0 EP0] Decode batch, #running-req: 80, #full token: 377856, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1706.60, #queue-req: 0, 
[2025-12-27 00:53:52 TP0 EP0] Decode batch, #running-req: 80, #full token: 378496, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1698.79, #queue-req: 0, 
[2025-12-27 00:53:54 TP0 EP0] Decode batch, #running-req: 80, #full token: 378624, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1697.30, #queue-req: 0, 
[2025-12-27 00:53:55 TP0 EP0] Decode batch, #running-req: 80, #full token: 387968, full token usage: 0.86, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1695.17, #queue-req: 0, 
[2025-12-27 00:53:57 TP0 EP0] Decode batch, #running-req: 80, #full token: 388608, full token usage: 0.86, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1692.59, #queue-req: 0, 
[2025-12-27 00:53:59 TP0 EP0] Decode batch, #running-req: 80, #full token: 388864, full token usage: 0.86, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1698.49, #queue-req: 0, 
[2025-12-27 00:54:01 TP0 EP0] Decode batch, #running-req: 80, #full token: 397696, full token usage: 0.88, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1697.98, #queue-req: 0, 
[2025-12-27 00:54:03 TP0 EP0] Decode batch, #running-req: 80, #full token: 398720, full token usage: 0.88, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1696.04, #queue-req: 0, 
[2025-12-27 00:54:05 TP0 EP0] Decode batch, #running-req: 80, #full token: 399104, full token usage: 0.89, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1696.20, #queue-req: 0, 
[2025-12-27 00:54:07 TP0 EP0] Decode batch, #running-req: 80, #full token: 0, full token usage: 0.00, mamba num: 0, mamba usage: 0.00, cpu graph: True, gen throughput (token/s): 1672.39, #queue-req: 0, 
[2025-12-27 00:54:07] Endpoint '/get_server_info' is deprecated and will be removed in a future version. Please use '/server_info' instead.
[2025-12-27 00:54:07] INFO:     127.0.0.1:53640 - "GET /get_server_info HTTP/1.1" 200 OK
[2025-12-27 00:54:08] Endpoint '/get_server_info' is deprecated and will be removed in a future version. Please use '/server_info' instead.
[2025-12-27 00:54:08] INFO:     127.0.0.1:53652 - "GET /get_server_info HTTP/1.1" 200 OK
metrics is benchmark_args=Namespace(backend='sglang', base_url=None, host='127.0.0.1', port=21000, dataset_name='random', dataset_path='', model='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8', served_model_name=None, tokenizer=None, num_prompts=160, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=3500, random_output_len=1500, random_range_ratio=1.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=inf, use_trace_timestamps=False, max_concurrency=80, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, return_routed_experts=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, gsp_send_routing_id=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)
Namespace(backend='sglang', base_url=None, host='127.0.0.1', port=21000, dataset_name='random', dataset_path='', model='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8', served_model_name=None, tokenizer=None, num_prompts=160, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=3500, random_output_len=1500, random_range_ratio=1.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=inf, use_trace_timestamps=False, max_concurrency=80, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, return_routed_experts=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, gsp_send_routing_id=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

#Input tokens: 560000
#Output tokens: 240000
Starting warmup with 1 sequences...
Warmup completed with 1 sequences. Starting main benchmark run...

============ Serving Benchmark Result ============
Backend:                                 sglang    
Traffic request rate:                    inf       
Max request concurrency:                 80        
Successful requests:                     160       
Benchmark duration (s):                  191.83    
Total input tokens:                      560000    
Total input text tokens:                 560000    
Total input vision tokens:               0         
Total generated tokens:                  240000    
Total generated tokens (retokenized):    239983    
Request throughput (req/s):              0.83      
Input token throughput (tok/s):          2919.29   
Output token throughput (tok/s):         1251.12   
Peak output token throughput (tok/s):    1840.00   
Peak concurrent requests:                160       
Total token throughput (tok/s):          4170.41   
Concurrency:                             79.97     
----------------End-to-End Latency----------------
Mean E2E Latency (ms):                   95874.45  
Median E2E Latency (ms):                 95859.83  
---------------Time to First Token----------------
Mean TTFT (ms):                          15794.73  
Median TTFT (ms):                        15817.72  
P99 TTFT (ms):                           29248.06  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          53.42     
Median TPOT (ms):                        52.99     
P99 TPOT (ms):                           62.40     
---------------Inter-Token Latency----------------
Mean ITL (ms):                           53.42     
Median ITL (ms):                         46.69     
P95 ITL (ms):                            47.67     
P99 ITL (ms):                            48.02     
Max ITL (ms):                            24747.47  
==================================================

The metrics result file: /data/d00662834/metrics/20251227/test_ascend_qwen3_next_80b_w8a8_2p_in3k5_out1k5_50ms.txt
command:python3 -m sglang.bench_serving --backend sglang --model /root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8 --host 127.0.0.1 --port 21000 --dataset-name random  --max-concurrency 80 --num-prompts 160 --random-input-len 3500 --random-output-len 1500 --random-range-ratio 1
[2025-12-27 00:54:22] INFO:     127.0.0.1:50080 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:22 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, full token usage: 0.00, mamba usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-27 00:54:25] INFO:     127.0.0.1:50084 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, full token usage: 0.00, mamba usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-27 00:54:25] INFO:     127.0.0.1:50092 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50096 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50112 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50114 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50116 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50128 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50132 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50140 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50146 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50150 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50152 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50154 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50168 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50170 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50184 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50188 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50204 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50216 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50224 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50236 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50250 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50254 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50256 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50268 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50284 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50286 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50292 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50296 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50306 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50312 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50328 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50330 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50336 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50344 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50360 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50366 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50376 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50382 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50386 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50388 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50392 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50396 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50410 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50418 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50420 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50426 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50434 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50446 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50460 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50474 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50482 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50484 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50486 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50502 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50506 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50518 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.01, mamba usage: 0.01, #running-req: 1, #queue-req: 49, 
[2025-12-27 00:54:25] INFO:     127.0.0.1:50522 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50534 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50544 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50554 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50556 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50568 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50576 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50592 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50604 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50610 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50618 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50628 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50636 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:25] INFO:     127.0.0.1:50652 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:26] INFO:     127.0.0.1:50656 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:26] INFO:     127.0.0.1:50660 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:26] INFO:     127.0.0.1:50672 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:26] INFO:     127.0.0.1:50684 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:26] INFO:     127.0.0.1:50690 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:26] INFO:     127.0.0.1:50706 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:26] INFO:     127.0.0.1:50712 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:26] INFO:     127.0.0.1:50718 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:26] INFO:     127.0.0.1:50724 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:54:27 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.05, mamba usage: 0.07, #running-req: 6, #queue-req: 69, 
[2025-12-27 00:54:28 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.09, mamba usage: 0.14, #running-req: 11, #queue-req: 64, 
[2025-12-27 00:54:29 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 18304, #cached-token: 0, full token usage: 0.13, mamba usage: 0.20, #running-req: 16, #queue-req: 59, 
[2025-12-27 00:54:31 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17792, #cached-token: 0, full token usage: 0.17, mamba usage: 0.26, #running-req: 21, #queue-req: 54, 
[2025-12-27 00:54:32 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.21, mamba usage: 0.33, #running-req: 26, #queue-req: 49, 
[2025-12-27 00:54:34 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.25, mamba usage: 0.39, #running-req: 31, #queue-req: 44, 
[2025-12-27 00:54:35 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 18816, #cached-token: 0, full token usage: 0.29, mamba usage: 0.45, #running-req: 36, #queue-req: 39, 
[2025-12-27 00:54:37 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.33, mamba usage: 0.51, #running-req: 41, #queue-req: 34, 
[2025-12-27 00:54:38 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.37, mamba usage: 0.57, #running-req: 46, #queue-req: 29, 
[2025-12-27 00:54:39 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.41, mamba usage: 0.64, #running-req: 51, #queue-req: 24, 
[2025-12-27 00:54:41 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.45, mamba usage: 0.70, #running-req: 56, #queue-req: 19, 
[2025-12-27 00:54:42 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.49, mamba usage: 0.76, #running-req: 61, #queue-req: 14, 
[2025-12-27 00:54:43 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.53, mamba usage: 0.82, #running-req: 66, #queue-req: 9, 
[2025-12-27 00:54:45 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.57, mamba usage: 0.89, #running-req: 71, #queue-req: 4, 
[2025-12-27 00:54:46 TP0 EP0] Prefill batch, #new-seq: 4, #new-token: 14336, #cached-token: 0, full token usage: 0.61, mamba usage: 0.95, #running-req: 76, #queue-req: 0, 
[2025-12-27 00:54:48 TP0 EP0] Decode batch, #running-req: 80, #full token: 287872, full token usage: 0.64, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 16.47, #queue-req: 0, 
[2025-12-27 00:54:49 TP0 EP0] Decode batch, #running-req: 80, #full token: 287872, full token usage: 0.64, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1814.17, #queue-req: 0, 
[2025-12-27 00:54:51 TP0 EP0] Decode batch, #running-req: 80, #full token: 295424, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1808.06, #queue-req: 0, 
[2025-12-27 00:54:53 TP0 EP0] Decode batch, #running-req: 80, #full token: 298112, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1788.01, #queue-req: 0, 
[2025-12-27 00:54:55 TP0 EP0] Decode batch, #running-req: 80, #full token: 298112, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1772.61, #queue-req: 0, 
[2025-12-27 00:54:57 TP0 EP0] Decode batch, #running-req: 80, #full token: 298752, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1766.96, #queue-req: 0, 
[2025-12-27 00:54:58 TP0 EP0] Decode batch, #running-req: 80, #full token: 308352, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1756.60, #queue-req: 0, 
[2025-12-27 00:55:00 TP0 EP0] Decode batch, #running-req: 80, #full token: 308352, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1750.42, #queue-req: 0, 
[2025-12-27 00:55:02 TP0 EP0] Decode batch, #running-req: 80, #full token: 308992, full token usage: 0.69, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1755.51, #queue-req: 0, 
[2025-12-27 00:55:04 TP0 EP0] Decode batch, #running-req: 80, #full token: 318592, full token usage: 0.71, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1747.87, #queue-req: 0, 
[2025-12-27 00:55:06 TP0 EP0] Decode batch, #running-req: 80, #full token: 318592, full token usage: 0.71, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1741.73, #queue-req: 0, 
[2025-12-27 00:55:07 TP0 EP0] Decode batch, #running-req: 80, #full token: 318848, full token usage: 0.71, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1734.54, #queue-req: 0, 
[2025-12-27 00:55:09 TP0 EP0] Decode batch, #running-req: 80, #full token: 328576, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1737.67, #queue-req: 0, 
[2025-12-27 00:55:11 TP0 EP0] Decode batch, #running-req: 80, #full token: 328832, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1734.54, #queue-req: 0, 
[2025-12-27 00:55:13 TP0 EP0] Decode batch, #running-req: 80, #full token: 328960, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1725.84, #queue-req: 0, 
[2025-12-27 00:55:15 TP0 EP0] Decode batch, #running-req: 80, #full token: 337664, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1728.96, #queue-req: 0, 
[2025-12-27 00:55:17 TP0 EP0] Decode batch, #running-req: 80, #full token: 339072, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1723.72, #queue-req: 0, 
[2025-12-27 00:55:19 TP0 EP0] Decode batch, #running-req: 80, #full token: 339072, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1711.97, #queue-req: 0, 
[2025-12-27 00:55:20 TP0 EP0] Decode batch, #running-req: 80, #full token: 346624, full token usage: 0.77, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1708.31, #queue-req: 0, 
[2025-12-27 00:55:22 TP0 EP0] Decode batch, #running-req: 80, #full token: 349312, full token usage: 0.78, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1709.90, #queue-req: 0, 
[2025-12-27 00:55:24 TP0 EP0] Decode batch, #running-req: 80, #full token: 349312, full token usage: 0.78, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1706.26, #queue-req: 0, 
[2025-12-27 00:55:26 TP0 EP0] Decode batch, #running-req: 80, #full token: 349952, full token usage: 0.78, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1705.54, #queue-req: 0, 
[2025-12-27 00:55:28 TP0 EP0] Decode batch, #running-req: 80, #full token: 359552, full token usage: 0.80, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1707.47, #queue-req: 0, 
[2025-12-27 00:55:30 TP0 EP0] Decode batch, #running-req: 80, #full token: 359552, full token usage: 0.80, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1709.53, #queue-req: 0, 
[2025-12-27 00:55:32 TP0 EP0] Decode batch, #running-req: 80, #full token: 360192, full token usage: 0.80, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1699.87, #queue-req: 0, 
[2025-12-27 00:55:34 TP0 EP0] Decode batch, #running-req: 80, #full token: 369792, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1702.84, #queue-req: 0, 
[2025-12-27 00:55:36 TP0 EP0] Decode batch, #running-req: 80, #full token: 369792, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1700.70, #queue-req: 0, 
[2025-12-27 00:55:37 TP0 EP0] Decode batch, #running-req: 80, #full token: 370048, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1698.73, #queue-req: 0, 
[2025-12-27 00:55:39 TP0 EP0] Decode batch, #running-req: 80, #full token: 379776, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1697.31, #queue-req: 0, 
[2025-12-27 00:55:41 TP0 EP0] Decode batch, #running-req: 80, #full token: 380032, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1693.17, #queue-req: 0, 
[2025-12-27 00:55:43 TP0 EP0] Decode batch, #running-req: 80, #full token: 380160, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1692.49, #queue-req: 0, 
[2025-12-27 00:55:45 TP0 EP0] Decode batch, #running-req: 80, #full token: 388864, full token usage: 0.86, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1689.90, #queue-req: 0, 
[2025-12-27 00:55:47 TP0 EP0] Decode batch, #running-req: 80, #full token: 390272, full token usage: 0.87, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1692.57, #queue-req: 0, 
[2025-12-27 00:55:49 TP0 EP0] Decode batch, #running-req: 80, #full token: 390272, full token usage: 0.87, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1693.18, #queue-req: 0, 
[2025-12-27 00:55:51 TP0 EP0] Decode batch, #running-req: 80, #full token: 397824, full token usage: 0.88, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1694.90, #queue-req: 0, 
[2025-12-27 00:55:53 TP0 EP0] Decode batch, #running-req: 80, #full token: 400512, full token usage: 0.89, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1687.85, #queue-req: 0, 
[2025-12-27 00:55:54 TP0 EP0] Decode batch, #running-req: 80, #full token: 400512, full token usage: 0.89, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1691.12, #queue-req: 0, 
[2025-12-27 00:55:56 TP0 EP0] Decode batch, #running-req: 80, #full token: 401152, full token usage: 0.89, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1693.72, #queue-req: 0, 
[2025-12-27 00:55:57] INFO:     127.0.0.1:52696 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 3584, #cached-token: 0, full token usage: 0.00, mamba usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-27 00:55:57] INFO:     127.0.0.1:52698 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52706 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52716 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52720 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52726 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52738 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52742 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52750 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52766 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52778 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52788 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52796 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52808 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52824 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52840 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52848 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52852 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52864 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52866 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52868 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52880 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52884 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52892 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52900 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52916 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52932 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52938 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52948 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52958 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52974 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:52990 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53004 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53012 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53028 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53034 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53036 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53044 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53048 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53056 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53060 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53072 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53078 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53090 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53104 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53110 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53112 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53120 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53136 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53140 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53152 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53168 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53178 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53192 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53194 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53208 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53218 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.01, mamba usage: 0.01, #running-req: 1, #queue-req: 49, 
[2025-12-27 00:55:57] INFO:     127.0.0.1:53230 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53234 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:57] INFO:     127.0.0.1:53238 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53240 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53246 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53262 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53270 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53282 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53284 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53290 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53292 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53298 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53312 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53324 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53340 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53350 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53366 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53376 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53378 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53388 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53400 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53412 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:58] INFO:     127.0.0.1:53422 - "POST /generate HTTP/1.1" 200 OK
[2025-12-27 00:55:59 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.05, mamba usage: 0.07, #running-req: 6, #queue-req: 69, 
[2025-12-27 00:56:00 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.09, mamba usage: 0.14, #running-req: 11, #queue-req: 64, 
[2025-12-27 00:56:02 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.13, mamba usage: 0.20, #running-req: 16, #queue-req: 59, 
[2025-12-27 00:56:03 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.17, mamba usage: 0.26, #running-req: 21, #queue-req: 54, 
[2025-12-27 00:56:05 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.21, mamba usage: 0.33, #running-req: 26, #queue-req: 49, 
[2025-12-27 00:56:06 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.25, mamba usage: 0.39, #running-req: 31, #queue-req: 44, 
[2025-12-27 00:56:07 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.29, mamba usage: 0.45, #running-req: 36, #queue-req: 39, 
[2025-12-27 00:56:09 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17792, #cached-token: 0, full token usage: 0.33, mamba usage: 0.51, #running-req: 41, #queue-req: 34, 
[2025-12-27 00:56:10 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.37, mamba usage: 0.57, #running-req: 46, #queue-req: 29, 
[2025-12-27 00:56:11 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17792, #cached-token: 0, full token usage: 0.41, mamba usage: 0.64, #running-req: 51, #queue-req: 24, 
[2025-12-27 00:56:13 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.44, mamba usage: 0.70, #running-req: 56, #queue-req: 19, 
[2025-12-27 00:56:15 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.48, mamba usage: 0.76, #running-req: 61, #queue-req: 14, 
[2025-12-27 00:56:16 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17792, #cached-token: 0, full token usage: 0.52, mamba usage: 0.82, #running-req: 66, #queue-req: 9, 
[2025-12-27 00:56:17 TP0 EP0] Prefill batch, #new-seq: 5, #new-token: 17920, #cached-token: 0, full token usage: 0.56, mamba usage: 0.89, #running-req: 71, #queue-req: 4, 
[2025-12-27 00:56:19 TP0 EP0] Prefill batch, #new-seq: 4, #new-token: 14080, #cached-token: 0, full token usage: 0.60, mamba usage: 0.95, #running-req: 76, #queue-req: 0, 
[2025-12-27 00:56:21 TP0 EP0] Decode batch, #running-req: 80, #full token: 286336, full token usage: 0.64, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 128.56, #queue-req: 0, 
[2025-12-27 00:56:23 TP0 EP0] Decode batch, #running-req: 80, #full token: 286464, full token usage: 0.64, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1809.51, #queue-req: 0, 
[2025-12-27 00:56:25 TP0 EP0] Decode batch, #running-req: 80, #full token: 295808, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1804.39, #queue-req: 0, 
[2025-12-27 00:56:26 TP0 EP0] Decode batch, #running-req: 80, #full token: 296448, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1807.33, #queue-req: 0, 
[2025-12-27 00:56:28 TP0 EP0] Decode batch, #running-req: 80, #full token: 296704, full token usage: 0.66, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1795.79, #queue-req: 0, 
[2025-12-27 00:56:30 TP0 EP0] Decode batch, #running-req: 80, #full token: 305536, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1793.16, #queue-req: 0, 
[2025-12-27 00:56:32 TP0 EP0] Decode batch, #running-req: 80, #full token: 306560, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1784.64, #queue-req: 0, 
[2025-12-27 00:56:34 TP0 EP0] Decode batch, #running-req: 80, #full token: 306944, full token usage: 0.68, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1782.74, #queue-req: 0, 
[2025-12-27 00:56:35 TP0 EP0] Decode batch, #running-req: 80, #full token: 314880, full token usage: 0.70, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1785.86, #queue-req: 0, 
[2025-12-27 00:56:37 TP0 EP0] Decode batch, #running-req: 80, #full token: 316800, full token usage: 0.70, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1774.34, #queue-req: 0, 
[2025-12-27 00:56:39 TP0 EP0] Decode batch, #running-req: 80, #full token: 317184, full token usage: 0.70, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1763.60, #queue-req: 0, 
[2025-12-27 00:56:41 TP0 EP0] Decode batch, #running-req: 80, #full token: 317440, full token usage: 0.70, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1762.75, #queue-req: 0, 
[2025-12-27 00:56:43 TP0 EP0] Decode batch, #running-req: 80, #full token: 327040, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1747.63, #queue-req: 0, 
[2025-12-27 00:56:45 TP0 EP0] Decode batch, #running-req: 80, #full token: 327296, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1741.99, #queue-req: 0, 
[2025-12-27 00:56:46 TP0 EP0] Decode batch, #running-req: 80, #full token: 327552, full token usage: 0.73, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1732.60, #queue-req: 0, 
[2025-12-27 00:56:48 TP0 EP0] Decode batch, #running-req: 80, #full token: 336896, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1729.44, #queue-req: 0, 
[2025-12-27 00:56:50 TP0 EP0] Decode batch, #running-req: 80, #full token: 337536, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1726.47, #queue-req: 0, 
[2025-12-27 00:56:52 TP0 EP0] Decode batch, #running-req: 80, #full token: 337664, full token usage: 0.75, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1722.38, #queue-req: 0, 
[2025-12-27 00:56:54 TP0 EP0] Decode batch, #running-req: 80, #full token: 347008, full token usage: 0.77, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1714.29, #queue-req: 0, 
[2025-12-27 00:56:56 TP0 EP0] Decode batch, #running-req: 80, #full token: 347648, full token usage: 0.77, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1718.68, #queue-req: 0, 
[2025-12-27 00:56:58 TP0 EP0] Decode batch, #running-req: 80, #full token: 347904, full token usage: 0.77, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1721.72, #queue-req: 0, 
[2025-12-27 00:56:59 TP0 EP0] Decode batch, #running-req: 80, #full token: 356736, full token usage: 0.79, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1720.13, #queue-req: 0, 
[2025-12-27 00:57:01 TP0 EP0] Decode batch, #running-req: 80, #full token: 357760, full token usage: 0.79, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1714.99, #queue-req: 0, 
[2025-12-27 00:57:03 TP0 EP0] Decode batch, #running-req: 80, #full token: 358144, full token usage: 0.79, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1715.67, #queue-req: 0, 
[2025-12-27 00:57:05 TP0 EP0] Decode batch, #running-req: 80, #full token: 366080, full token usage: 0.81, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1717.53, #queue-req: 0, 
[2025-12-27 00:57:07 TP0 EP0] Decode batch, #running-req: 80, #full token: 368000, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1711.94, #queue-req: 0, 
[2025-12-27 00:57:09 TP0 EP0] Decode batch, #running-req: 80, #full token: 368384, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1708.89, #queue-req: 0, 
[2025-12-27 00:57:11 TP0 EP0] Decode batch, #running-req: 80, #full token: 368640, full token usage: 0.82, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1708.76, #queue-req: 0, 
[2025-12-27 00:57:12 TP0 EP0] Decode batch, #running-req: 80, #full token: 378240, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1702.82, #queue-req: 0, 
[2025-12-27 00:57:14 TP0 EP0] Decode batch, #running-req: 80, #full token: 378496, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1703.72, #queue-req: 0, 
[2025-12-27 00:57:16 TP0 EP0] Decode batch, #running-req: 80, #full token: 378752, full token usage: 0.84, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1703.13, #queue-req: 0, 
[2025-12-27 00:57:18 TP0 EP0] Decode batch, #running-req: 80, #full token: 388096, full token usage: 0.86, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1699.71, #queue-req: 0, 
[2025-12-27 00:57:20 TP0 EP0] Decode batch, #running-req: 80, #full token: 388736, full token usage: 0.86, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1698.80, #queue-req: 0, 
[2025-12-27 00:57:22 TP0 EP0] Decode batch, #running-req: 80, #full token: 388864, full token usage: 0.86, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1700.51, #queue-req: 0, 
[2025-12-27 00:57:24 TP0 EP0] Decode batch, #running-req: 80, #full token: 398208, full token usage: 0.88, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1696.50, #queue-req: 0, 
[2025-12-27 00:57:26 TP0 EP0] Decode batch, #running-req: 80, #full token: 398848, full token usage: 0.89, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1695.98, #queue-req: 0, 
[2025-12-27 00:57:28 TP0 EP0] Decode batch, #running-req: 80, #full token: 399104, full token usage: 0.89, mamba num: 80, mamba usage: 1.00, cpu graph: True, gen throughput (token/s): 1695.04, #queue-req: 0, 
[2025-12-27 00:57:29] Endpoint '/get_server_info' is deprecated and will be removed in a future version. Please use '/server_info' instead.
[2025-12-27 00:57:29] INFO:     127.0.0.1:50472 - "GET /get_server_info HTTP/1.1" 200 OK
[2025-12-27 00:57:30] Endpoint '/get_server_info' is deprecated and will be removed in a future version. Please use '/server_info' instead.
[2025-12-27 00:57:30] INFO:     127.0.0.1:50478 - "GET /get_server_info HTTP/1.1" 200 OK
metrics is benchmark_args=Namespace(backend='sglang', base_url=None, host='127.0.0.1', port=21000, dataset_name='random', dataset_path='', model='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8', served_model_name=None, tokenizer=None, num_prompts=160, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=3500, random_output_len=1500, random_range_ratio=1.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=inf, use_trace_timestamps=False, max_concurrency=80, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, return_routed_experts=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, gsp_send_routing_id=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)
Namespace(backend='sglang', base_url=None, host='127.0.0.1', port=21000, dataset_name='random', dataset_path='', model='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-Next-80B-A3B-Instruct-W8A8', served_model_name=None, tokenizer=None, num_prompts=160, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=3500, random_output_len=1500, random_range_ratio=1.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=inf, use_trace_timestamps=False, max_concurrency=80, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, return_routed_experts=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, gsp_send_routing_id=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

#Input tokens: 560000
#Output tokens: 240000
Starting warmup with 1 sequences...
Warmup completed with 1 sequences. Starting main benchmark run...

============ Serving Benchmark Result ============
Backend:                                 sglang    
Traffic request rate:                    inf       
Max request concurrency:                 80        
Successful requests:                     160       
Benchmark duration (s):                  184.38    
Total input tokens:                      560000    
Total input text tokens:                 560000    
Total input vision tokens:               0         
Total generated tokens:                  240000    
Total generated tokens (retokenized):    239982    
Request throughput (req/s):              0.87      
Input token throughput (tok/s):          3037.21   
Output token throughput (tok/s):         1301.66   
Peak output token throughput (tok/s):    1840.00   
Peak concurrent requests:                160       
Total token throughput (tok/s):          4338.87   
Concurrency:                             79.96     
----------------End-to-End Latency----------------
Mean E2E Latency (ms):                   92145.88  
Median E2E Latency (ms):                 92156.27  
---------------Time to First Token----------------
Mean TTFT (ms):                          13481.41  
Median TTFT (ms):                        13194.07  
P99 TTFT (ms):                           23054.45  
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          52.48     
Median TPOT (ms):                        52.68     
P99 TPOT (ms):                           59.63     
---------------Inter-Token Latency----------------
Mean ITL (ms):                           52.48     
Median ITL (ms):                         46.55     
P95 ITL (ms):                            47.47     
P99 ITL (ms):                            47.79     
Max ITL (ms):                            21232.40  
==================================================

Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py", line 2527, in retry
    return fn()
           ^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/test/test_utils.py", line 1704, in <lambda>
    lambda: super(CustomTestCase, self)._callTestMethod(method),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/unittest/case.py", line 579, in _callTestMethod
    if method() is not None:
       ^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/test/nightly/ascend/performance/test_ascend_qwen3_next_80b_w8a8_2p_in3k5_out1k5_50ms.py", line 65, in test_qwen3_next_80b_a3b
    self.run_throughput()
  File "/data/d00662834/1211_dev/sglang/test/nightly/ascend/performance/test_ascend_single_mix_utils.py", line 141, in run_throughput
    self.assertLessEqual(
  File "/usr/local/python3.11.13/lib/python3.11/unittest/case.py", line 1265, in assertLessEqual
    self.fail(self._formatMessage(msg, standardMsg))
  File "/usr/local/python3.11.13/lib/python3.11/unittest/case.py", line 703, in fail
    raise self.failureException(msg)
AssertionError: 52.48 not less than or equal to 51.0
E
======================================================================
ERROR: test_qwen3_next_80b_a3b (__main__.TestQwen3_Next_80B_A3B.test_qwen3_next_80b_a3b)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py", line 2527, in retry
    return fn()
           ^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/test/test_utils.py", line 1704, in <lambda>
    lambda: super(CustomTestCase, self)._callTestMethod(method),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
AssertionError: 52.48 not less than or equal to 51.0

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/test/test_utils.py", line 1703, in _callTestMethod
    retry(
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py", line 2535, in retry
    raise Exception(f"retry() exceed maximum number of retries.")
Exception: retry() exceed maximum number of retries.

----------------------------------------------------------------------
Ran 1 test in 665.538s

FAILED (errors=1)
Finished test case test/nightly/ascend/performance/test_ascend_qwen3_next_80b_w8a8_2p_in3k5_out1k5_50ms.py

Error: Pod logs ended but target pattern was not detected
job.batch.volcano.sh "sglang-single-8a105a4c-6607-4b13-acd1-4864f13d0870" deleted
