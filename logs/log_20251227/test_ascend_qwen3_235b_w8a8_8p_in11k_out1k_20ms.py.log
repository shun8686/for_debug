image: swr.cn-southwest-2.myhuaweicloud.com/base_image/dockerhub/lmsysorg/sglang:cann8.3.rc2-a3-release1223
KUBE_JOB_NAME: sglang-single-45924635-647e-4ad5-8f8a-1ab40c72fcd8
Apply k8s yaml... KUBE_NAME_SPACE:sglang-single-debug, KUBE_CONFIG_MAP:None, KUBE_JOB_TYPE:single, KUBE_YAML_FILE:yaml_sglang-single-45924635-647e-4ad5-8f8a-1ab40c72fcd8.yaml
job.batch.volcano.sh/sglang-single-45924635-647e-4ad5-8f8a-1ab40c72fcd8 created

Waiting all pods to running...
No sglang pod, waiting...
Pod: sglang-single-45924635-647e-4ad5-8f8a-1ab40c72fcd8-pod-0, status: Running
All sglang Pod is Running !
Starting to monitor logs for Pod: sglang-single-45924635-647e-4ad5-8f8a-1ab40c72fcd8-pod-0
Namespace: sglang-single-debug
Timeout set to: 10800 seconds
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting kubernetes
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/ca/ec/65f7d563aa4a62dd58777e8f6aa882f15db53b14eb29aba0c28a20f7eb26/kubernetes-34.1.0-py2.py3-none-any.whl (2.0 MB)
Requirement already satisfied: certifi>=14.05.14 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2025.11.12)
Requirement already satisfied: six>=1.9.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (1.17.0)
Requirement already satisfied: python-dateutil>=2.5.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.9.0.post0)
Requirement already satisfied: pyyaml>=5.4.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (6.0.3)
Collecting google-auth>=1.0.1 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c6/97/451d55e05487a5cd6279a01a7e34921858b16f7dc8aa38a2c684743cd2b3/google_auth-2.45.0-py2.py3-none-any.whl (233 kB)
Collecting websocket-client!=0.40.0,!=0.41.*,!=0.42.*,>=0.32.0 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/34/db/b10e48aa8fff7407e67470363eac595018441cf32d5e1001567a7aeba5d2/websocket_client-1.9.0-py3-none-any.whl (82 kB)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.32.5)
Collecting requests-oauthlib (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/3b/5d/63d4ae3b9daea098d5d6f5da83984853c1bbacd5dc826764b249fe119d24/requests_oauthlib-2.0.0-py2.py3-none-any.whl (24 kB)
Collecting urllib3<2.4.0,>=1.24.2 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c8/19/4ec628951a74043532ca2cf5d97b7b14863931476d117c471e8e2b1eb39f/urllib3-2.3.0-py3-none-any.whl (128 kB)
Collecting durationpy>=0.7 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/b0/0d/9feae160378a3553fa9a339b0e9c1a048e147a4127210e286ef18b730f03/durationpy-0.10-py3-none-any.whl (3.9 kB)
Collecting cachetools<7.0,>=2.0.0 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/2c/fc/1d7b80d0eb7b714984ce40efc78859c022cd930e402f599d8ca9e39c78a4/cachetools-6.2.4-py3-none-any.whl (11 kB)
Collecting pyasn1-modules>=0.2.1 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/47/8d/d529b5d697919ba8c11ad626e835d4039be708a35b0d22de83a269a6682c/pyasn1_modules-0.4.2-py3-none-any.whl (181 kB)
Collecting rsa<5,>=3.1.4 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/64/8d/0133e4eb4beed9e425d9a98ed6e081a55d195481b7632472be1af08d2f6b/rsa-4.9.1-py3-none-any.whl (34 kB)
Collecting pyasn1>=0.1.3 (from rsa<5,>=3.1.4->google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c8/f1/d6a797abb14f6283c0ddff96bbdd46937f64122b8c925cab503dd37f8214/pyasn1-0.6.1-py3-none-any.whl (83 kB)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.11)
Collecting oauthlib>=3.0.0 (from requests-oauthlib->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/be/9c/92789c596b8df838baa98fa71844d84283302f7604ed565dafe5a6b5041a/oauthlib-3.3.1-py3-none-any.whl (160 kB)
Installing collected packages: durationpy, websocket-client, urllib3, pyasn1, oauthlib, cachetools, rsa, pyasn1-modules, requests-oauthlib, google-auth, kubernetes
  Attempting uninstall: urllib3
    Found existing installation: urllib3 2.5.0
    Uninstalling urllib3-2.5.0:
      Successfully uninstalled urllib3-2.5.0

Successfully installed cachetools-6.2.4 durationpy-0.10 google-auth-2.45.0 kubernetes-34.1.0 oauthlib-3.3.1 pyasn1-0.6.1 pyasn1-modules-0.4.2 requests-oauthlib-2.0.0 rsa-4.9.1 urllib3-2.3.0 websocket-client-1.9.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting xgrammar==0.1.25
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/55/04/55a87e814bcab771d3e4159281fa382b3d5f14a36114f2f9e572728da831/xgrammar-0.1.25-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (8.5 MB)
Requirement already satisfied: pydantic in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.12.5)
Requirement already satisfied: torch>=1.10.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.8.0+cpu)
Requirement already satisfied: transformers>=4.38.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (4.57.1)
Requirement already satisfied: ninja in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (1.13.0)
Requirement already satisfied: numpy in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.4.0)
Requirement already satisfied: typing-extensions>=4.9.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (4.15.0)
Requirement already satisfied: filelock in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.20.0)
Requirement already satisfied: sympy>=1.13.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (1.14.0)
Requirement already satisfied: networkx in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.6.1)
Requirement already satisfied: jinja2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.1.6)
Requirement already satisfied: fsspec in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (2025.10.0)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from sympy>=1.13.3->torch>=1.10.0->xgrammar==0.1.25) (1.3.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.34.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.36.0)
Requirement already satisfied: packaging>=20.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (25.0)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (6.0.3)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (2025.11.3)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (2.32.5)
Requirement already satisfied: tokenizers<=0.23.0,>=0.22.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.22.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.7.0)
Requirement already satisfied: tqdm>=4.27 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (4.67.1)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers>=4.38.0->xgrammar==0.1.25) (1.2.0)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from jinja2->torch>=1.10.0->xgrammar==0.1.25) (2.1.5)
Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (2.41.5)
Requirement already satisfied: typing-inspection>=0.4.2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (0.4.2)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (2025.11.12)
Installing collected packages: xgrammar
  Attempting uninstall: xgrammar
    Found existing installation: xgrammar 0.1.27
    Uninstalling xgrammar-0.1.27:
      Successfully uninstalled xgrammar-0.1.27
Successfully installed xgrammar-0.1.25
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Requirement already satisfied: transformers==4.57.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (4.57.1)
Requirement already satisfied: filelock in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (3.20.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.34.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.36.0)
Requirement already satisfied: numpy>=1.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2.4.0)
Requirement already satisfied: packaging>=20.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (25.0)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (6.0.3)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2025.11.3)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2.32.5)
Requirement already satisfied: tokenizers<=0.23.0,>=0.22.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.22.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.7.0)
Requirement already satisfied: tqdm>=4.27 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (4.67.1)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (2025.10.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (4.15.0)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (1.2.0)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (2025.11.12)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0  732k    0  7276    0     0  13263      0  0:00:56 --:--:--  0:00:56 13253
100  732k  100  732k    0     0  1000k      0 --:--:-- --:--:-- --:--:-- 1000k
performance
vm.swappiness = 0
kernel.numa_balancing = 0
kernel.sched_migration_cost_ns = 50000
Running test case test/nightly/ascend/performance/test_ascend_qwen3_235b_w8a8_8p_in11k_out1k_20ms.py
Nic name: lo
ENV_VAR PYTORCH_NPU_ALLOC_CONF:expandable_segments:True
ENV_VAR SGLANG_DISAGGREGATION_BOOTSTRAP_TIMEOUT:600
ENV_VAR HCCL_BUFFSIZE:1600
ENV_VAR HCCL_SOCKET_IFNAME:lo
ENV_VAR GLOO_SOCKET_IFNAME:lo
ENV_VAR HCCL_OP_EXPANSION_MODE:AIV
ENV_VAR SGLANG_ENABLE_OVERLAP_PLAN_STREAM:1
ENV_VAR SGLANG_ENABLE_SPEC_V2:1
command=python3 -m sglang.launch_server --model-path /root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8 --trust-remote-code --nnodes 1 --node-rank 0 --attention-backend ascend --device npu --quantization modelslim --max-running-requests 1 --dtype bfloat16 --chunked-prefill-size -1 --max-prefill-tokens 2048 --speculative-draft-model-quantization unquant --speculative-algorithm EAGLE3 --speculative-draft-model-path /root/.cache/modelscope/hub/models/Qwen/Qwen3-235B-A22B-Eagle3 --speculative-num-steps 3 --speculative-eagle-topk 1 --speculative-num-draft-tokens 4 --disable-radix-cache --enable-dp-lm-head --tp 16 --mem-fraction-static 0.78 --cuda-graph-bs 1 --device npu --host 127.0.0.1 --port 21000
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-25 08:07:17] WARNING model_config.py:812: modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:18] server_args=ServerArgs(model_path='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8', tokenizer_path='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8', tokenizer_mode='auto', tokenizer_worker_num=1, skip_tokenizer_init=False, load_format='auto', model_loader_extra_config='{}', trust_remote_code=True, context_length=None, is_embedding=False, enable_multimodal=None, limit_mm_data_per_request=None, revision=None, model_impl='auto', host='127.0.0.1', port=21000, fastapi_root_path='', grpc_mode=False, skip_server_warmup=False, warmups=None, nccl_port=None, checkpoint_engine_wait_weights_before_ready=False, dtype='bfloat16', quantization='modelslim', quantization_param_path=None, kv_cache_dtype='auto', enable_fp32_lm_head=False, modelopt_quant=None, modelopt_checkpoint_restore_path=None, modelopt_checkpoint_save_path=None, modelopt_export_path=None, quantize_and_serve=False, rl_quant_profile=None, mem_fraction_static=0.78, max_running_requests=1, max_queued_requests=None, max_total_tokens=None, chunked_prefill_size=-1, enable_dynamic_chunking=False, max_prefill_tokens=2048, prefill_max_requests=None, schedule_policy='fcfs', enable_priority_scheduling=False, abort_on_priority_when_disabled=False, schedule_low_priority_values_first=False, priority_scheduling_preemption_threshold=10, schedule_conservativeness=1.0, page_size=128, hybrid_kvcache_ratio=None, swa_full_tokens_ratio=0.8, disable_hybrid_swa_memory=False, radix_eviction_policy='lru', device='npu', tp_size=16, pp_size=1, pp_max_micro_batch_size=None, pp_async_batch_depth=0, stream_interval=1, stream_output=False, random_seed=842405712, constrained_json_whitespace_pattern=None, constrained_json_disable_any_whitespace=False, watchdog_timeout=300, soft_watchdog_timeout=None, dist_timeout=None, download_dir=None, base_gpu_id=0, gpu_id_step=1, sleep_on_idle=False, custom_sigquit_handler=None, log_level='info', log_level_http=None, log_requests=False, log_requests_level=2, crash_dump_folder=None, show_time_cost=False, enable_metrics=False, enable_metrics_for_all_schedulers=False, tokenizer_metrics_custom_labels_header='x-custom-labels', tokenizer_metrics_allowed_custom_labels=None, bucket_time_to_first_token=None, bucket_inter_token_latency=None, bucket_e2e_request_latency=None, collect_tokens_histogram=False, prompt_tokens_buckets=None, generation_tokens_buckets=None, gc_warning_threshold_secs=0.0, decode_log_interval=40, enable_request_time_stats_logging=False, kv_events_config=None, enable_trace=False, otlp_traces_endpoint='localhost:4317', export_metrics_to_file=False, export_metrics_to_file_dir=None, api_key=None, served_model_name='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8', weight_version='default', chat_template=None, completion_template=None, file_storage_path='sglang_storage', enable_cache_report=False, reasoning_parser=None, tool_call_parser=None, tool_server=None, sampling_defaults='model', dp_size=1, load_balance_method='round_robin', load_watch_interval=0.1, prefill_round_robin_balance=False, dist_init_addr=None, nnodes=1, node_rank=0, json_model_override_args='{}', preferred_sampling_params=None, enable_lora=None, max_lora_rank=None, lora_target_modules=None, lora_paths=None, max_loaded_loras=None, max_loras_per_batch=8, lora_eviction_policy='lru', lora_backend='csgmv', max_lora_chunk_size=16, attention_backend='ascend', decode_attention_backend='ascend', prefill_attention_backend='ascend', sampling_backend='pytorch', grammar_backend='xgrammar', mm_attention_backend=None, fp8_gemm_runner_backend='auto', nsa_prefill_backend='flashmla_sparse', nsa_decode_backend='fa3', disable_flashinfer_autotune=False, speculative_algorithm='EAGLE3', speculative_draft_model_path='/root/.cache/modelscope/hub/models/Qwen/Qwen3-235B-A22B-Eagle3', speculative_draft_model_revision='main', speculative_draft_load_format=None, speculative_num_steps=3, speculative_eagle_topk=1, speculative_num_draft_tokens=4, speculative_accept_threshold_single=1.0, speculative_accept_threshold_acc=1.0, speculative_token_map=None, speculative_attention_mode='prefill', speculative_draft_attention_backend=None, speculative_moe_runner_backend='auto', speculative_moe_a2a_backend=None, speculative_draft_model_quantization=None, speculative_ngram_min_match_window_size=1, speculative_ngram_max_match_window_size=12, speculative_ngram_min_bfs_breadth=1, speculative_ngram_max_bfs_breadth=10, speculative_ngram_match_type='BFS', speculative_ngram_branch_length=18, speculative_ngram_capacity=10000000, enable_mtp=False, ep_size=1, moe_a2a_backend='none', moe_runner_backend='auto', flashinfer_mxfp4_moe_precision='default', enable_flashinfer_allreduce_fusion=False, deepep_mode='auto', ep_num_redundant_experts=0, ep_dispatch_algorithm=None, init_expert_location='trivial', enable_eplb=False, eplb_algorithm='auto', eplb_rebalance_num_iterations=1000, eplb_rebalance_layers_per_chunk=None, eplb_min_rebalancing_utilization_threshold=1.0, expert_distribution_recorder_mode=None, expert_distribution_recorder_buffer_size=1000, enable_expert_distribution_metrics=False, deepep_config=None, moe_dense_tp_size=None, elastic_ep_backend=None, mooncake_ib_device=None, max_mamba_cache_size=None, mamba_ssm_dtype='float32', mamba_full_memory_ratio=0.9, mamba_scheduler_strategy='no_buffer', mamba_track_interval=256, enable_hierarchical_cache=False, hicache_ratio=2.0, hicache_size=0, hicache_write_policy='write_through', hicache_io_backend='kernel', hicache_mem_layout='layer_first', hicache_storage_backend=None, hicache_storage_prefetch_policy='best_effort', hicache_storage_backend_extra_config=None, enable_lmcache=False, kt_weight_path=None, kt_method='AMXINT4', kt_cpuinfer=None, kt_threadpool_count=2, kt_num_gpu_experts=None, kt_max_deferred_experts_per_token=None, dllm_algorithm=None, dllm_algorithm_config=None, enable_double_sparsity=False, ds_channel_config_path=None, ds_heavy_channel_num=32, ds_heavy_token_num=256, ds_heavy_channel_type='qk', ds_sparse_decode_threshold=4096, cpu_offload_gb=0, offload_group_size=-1, offload_num_in_group=1, offload_prefetch_step=1, offload_mode='cpu', multi_item_scoring_delimiter=None, disable_radix_cache=True, cuda_graph_max_bs=1, cuda_graph_bs=[1], disable_cuda_graph=False, disable_cuda_graph_padding=False, enable_profile_cuda_graph=False, enable_cudagraph_gc=False, enable_layerwise_nvtx_marker=False, enable_nccl_nvls=False, enable_symm_mem=False, disable_flashinfer_cutlass_moe_fp4_allgather=False, enable_tokenizer_batch_encode=False, disable_tokenizer_batch_decode=False, disable_outlines_disk_cache=False, disable_custom_all_reduce=True, enable_mscclpp=False, enable_torch_symm_mem=False, disable_overlap_schedule=False, enable_mixed_chunk=False, enable_dp_attention=False, enable_dp_lm_head=False, enable_two_batch_overlap=False, enable_single_batch_overlap=False, tbo_token_distribution_threshold=0.48, enable_torch_compile=False, enable_piecewise_cuda_graph=False, enable_torch_compile_debug_mode=False, torch_compile_max_bs=32, piecewise_cuda_graph_max_tokens=4096, piecewise_cuda_graph_tokens=[4, 8, 12, 16, 20, 24, 28, 32, 48, 64, 80, 96, 112, 128, 144, 160, 176, 192, 208, 224, 240, 256, 288, 320, 352, 384, 416, 448, 480, 512, 640, 768, 896, 1024, 1152, 1280, 1408, 1536, 1664, 1792, 1920, 2048, 2176, 2304, 2432, 2560, 2688, 2816, 2944, 3072, 3200, 3328, 3456, 3584, 3712, 3840, 3968, 4096], piecewise_cuda_graph_compiler='eager', torchao_config='', enable_nan_detection=False, enable_p2p_check=False, triton_attention_reduce_in_fp32=False, triton_attention_num_kv_splits=8, triton_attention_split_tile_size=None, num_continuous_decode_steps=1, delete_ckpt_after_loading=False, enable_memory_saver=False, enable_weights_cpu_backup=False, enable_draft_weights_cpu_backup=False, allow_auto_truncate=False, enable_custom_logit_processor=False, flashinfer_mla_disable_ragged=False, disable_shared_experts_fusion=False, disable_chunked_prefix_cache=False, disable_fast_image_processor=False, keep_mm_feature_on_device=False, enable_return_hidden_states=False, enable_return_routed_experts=False, scheduler_recv_interval=1, numa_node=None, enable_deterministic_inference=False, rl_on_policy_target=None, enable_attn_tp_input_scattered=False, enable_nsa_prefill_context_parallel=False, enable_fused_qk_norm_rope=False, enable_dynamic_batch_tokenizer=False, dynamic_batch_tokenizer_batch_size=32, dynamic_batch_tokenizer_batch_timeout=0.002, debug_tensor_dump_output_folder=None, debug_tensor_dump_layers=None, debug_tensor_dump_input_file=None, debug_tensor_dump_inject=False, disaggregation_mode='null', disaggregation_transfer_backend='mooncake', disaggregation_bootstrap_port=8998, disaggregation_decode_tp=None, disaggregation_decode_dp=None, disaggregation_prefill_pp=1, disaggregation_ib_device=None, disaggregation_decode_enable_offload_kvcache=False, num_reserved_decode_tokens=512, disaggregation_decode_polling_interval=1, encoder_only=False, language_only=False, encoder_transfer_backend='zmq_to_scheduler', encoder_urls=[], custom_weight_loader=[], weight_loader_disable_mmap=False, remote_instance_weight_loader_seed_instance_ip=None, remote_instance_weight_loader_seed_instance_service_port=None, remote_instance_weight_loader_send_weights_group_ports=None, remote_instance_weight_loader_backend='nccl', remote_instance_weight_loader_start_seed_via_transfer_engine=False, enable_pdmux=False, pdmux_config_path=None, sm_group_num=8, mm_max_concurrent_calls=32, mm_per_request_timeout=10.0, enable_broadcast_mm_inputs_process=False, enable_prefix_mm_cache=False, mm_enable_dp_encoder=False, mm_process_config={}, decrypted_config_file=None, decrypted_draft_config_file=None, forward_hooks=None)
[2025-12-25 08:07:18] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:18] Using default HuggingFace chat template with detected content format: string
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
[2025-12-25 08:07:28 TP4] Process 1120 gpu_id 4 is running on CPUs: [80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
[2025-12-25 08:07:28 TP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-25 08:07:29 TP0] Process 1116 gpu_id 0 is running on CPUs: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[2025-12-25 08:07:29 TP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:29 TP3] Process 1119 gpu_id 3 is running on CPUs: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
[2025-12-25 08:07:29 TP2] Process 1118 gpu_id 2 is running on CPUs: [40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
[2025-12-25 08:07:29 TP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:29 TP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-25 08:07:29 TP12] Process 1506 gpu_id 12 is running on CPUs: [240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259]
[2025-12-25 08:07:29 TP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 08:07:29 TP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:29 TP4] Init torch distributed begin.
[2025-12-25 08:07:29 TP8] Process 1502 gpu_id 8 is running on CPUs: [160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
[2025-12-25 08:07:29 TP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:29 TP1] Process 1117 gpu_id 1 is running on CPUs: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-25 08:07:29 TP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:29 TP10] Process 1504 gpu_id 10 is running on CPUs: [200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219]
[2025-12-25 08:07:29 TP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 08:07:29 TP9] Process 1503 gpu_id 9 is running on CPUs: [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
[2025-12-25 08:07:29 TP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:29 TP14] Process 1508 gpu_id 14 is running on CPUs: [280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299]
[2025-12-25 08:07:29 TP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:29 TP11] Process 1505 gpu_id 11 is running on CPUs: [220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[2025-12-25 08:07:29 TP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP13] Process 1507 gpu_id 13 is running on CPUs: [260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279]
[2025-12-25 08:07:30 TP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
[2025-12-25 08:07:30 TP7] Process 1501 gpu_id 7 is running on CPUs: [140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 08:07:30 TP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP6] Process 1500 gpu_id 6 is running on CPUs: [120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
[2025-12-25 08:07:30 TP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP0] Init torch distributed begin.
[2025-12-25 08:07:30 TP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
[2025-12-25 08:07:30 TP5] Process 1121 gpu_id 5 is running on CPUs: [100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
[2025-12-25 08:07:30 TP15] Process 1509 gpu_id 15 is running on CPUs: [300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319]
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 08:07:30 TP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP2] Init torch distributed begin.
[2025-12-25 08:07:30 TP3] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 08:07:30 TP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP12] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 08:07:30 TP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP8] Init torch distributed begin.
[2025-12-25 08:07:30 TP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP1] Init torch distributed begin.
[2025-12-25 08:07:30 TP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP10] Init torch distributed begin.
[2025-12-25 08:07:30 TP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP9] Init torch distributed begin.
[2025-12-25 08:07:30 TP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP14] Init torch distributed begin.
[2025-12-25 08:07:30 TP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP11] Init torch distributed begin.
[2025-12-25 08:07:30 TP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP13] Init torch distributed begin.
[2025-12-25 08:07:30 TP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP7] Init torch distributed begin.
[2025-12-25 08:07:30 TP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP5] Init torch distributed begin.
[2025-12-25 08:07:30 TP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP6] Init torch distributed begin.
[2025-12-25 08:07:30 TP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 08:07:30 TP15] Init torch distributed begin.
[Gloo] Rank 13 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 8 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 12 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 11 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 9 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 5 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 1 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 3 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 2 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 6 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 7 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 10 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 14 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 15 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 4 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 9 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 7 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 11 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 2 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 3 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 1 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 5 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 4 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 6 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 8 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 12 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 10 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 15 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 14 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 13 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 2 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 1 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 14 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 3 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 9 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 4 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 5 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 6 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 7 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 8 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 12 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 10 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 11 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 13 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 15 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[2025-12-25 08:07:32 TP0] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP15] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP14] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP13] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP12] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP11] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP10] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP9] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP8] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP6] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP7] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP5] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP4] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP1] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP2] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:32 TP3] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:07:33 TP5] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP15] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP0] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP12] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP11] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP13] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP14] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP4] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP6] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP7] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP9] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP1] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP8] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP10] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP3] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP2] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 08:07:33 TP12] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP5] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP14] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP15] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP7] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP2] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP3] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP11] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP13] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP8] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP0] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP4] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP10] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP9] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP1] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:33 TP6] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 08:07:34 TP0] Load weight begin. avail mem=60.81 GB
[2025-12-25 08:07:34 TP12] Load weight begin. avail mem=60.87 GB
[2025-12-25 08:07:34 TP13] Load weight begin. avail mem=61.10 GB
[2025-12-25 08:07:34 TP7] Load weight begin. avail mem=61.10 GB
[2025-12-25 08:07:34 TP11] Load weight begin. avail mem=61.10 GB
[2025-12-25 08:07:34 TP5] Load weight begin. avail mem=61.10 GB
[2025-12-25 08:07:34 TP4] Load weight begin. avail mem=60.87 GB
[2025-12-25 08:07:34 TP1] Load weight begin. avail mem=61.10 GB
[2025-12-25 08:07:34 TP15] Load weight begin. avail mem=61.10 GB
[2025-12-25 08:07:34 TP6] Load weight begin. avail mem=60.87 GB
[2025-12-25 08:07:34 TP14] Load weight begin. avail mem=60.88 GB
[2025-12-25 08:07:34 TP8] Load weight begin. avail mem=60.87 GB
[2025-12-25 08:07:34 TP9] Load weight begin. avail mem=61.10 GB
[2025-12-25 08:07:34 TP10] Load weight begin. avail mem=60.88 GB
[2025-12-25 08:07:34 TP3] Load weight begin. avail mem=61.10 GB
[2025-12-25 08:07:34 TP2] Load weight begin. avail mem=60.87 GB

Loading safetensors checkpoint shards:   0% Completed | 0/56 [00:00<?, ?it/s]

Loading safetensors checkpoint shards:   2% Completed | 1/56 [00:05<05:12,  5.68s/it]

Loading safetensors checkpoint shards:   4% Completed | 2/56 [00:11<05:11,  5.77s/it]

Loading safetensors checkpoint shards:   5% Completed | 3/56 [00:17<05:12,  5.89s/it]

Loading safetensors checkpoint shards:   7% Completed | 4/56 [00:23<05:05,  5.88s/it]

Loading safetensors checkpoint shards:   9% Completed | 5/56 [00:28<04:52,  5.74s/it]

Loading safetensors checkpoint shards:  11% Completed | 6/56 [00:34<04:52,  5.85s/it]

Loading safetensors checkpoint shards:  12% Completed | 7/56 [00:40<04:47,  5.88s/it]

Loading safetensors checkpoint shards:  14% Completed | 8/56 [00:46<04:40,  5.85s/it]

Loading safetensors checkpoint shards:  16% Completed | 9/56 [00:52<04:32,  5.80s/it]

Loading safetensors checkpoint shards:  18% Completed | 10/56 [00:57<04:20,  5.66s/it]

Loading safetensors checkpoint shards:  20% Completed | 11/56 [01:03<04:14,  5.67s/it]

Loading safetensors checkpoint shards:  21% Completed | 12/56 [01:09<04:09,  5.67s/it]

Loading safetensors checkpoint shards:  23% Completed | 13/56 [01:14<04:06,  5.74s/it]

Loading safetensors checkpoint shards:  25% Completed | 14/56 [01:20<03:55,  5.61s/it]

Loading safetensors checkpoint shards:  27% Completed | 15/56 [01:26<03:51,  5.65s/it]

Loading safetensors checkpoint shards:  29% Completed | 16/56 [01:32<03:52,  5.81s/it]

Loading safetensors checkpoint shards:  30% Completed | 17/56 [01:38<03:49,  5.89s/it]

Loading safetensors checkpoint shards:  32% Completed | 18/56 [01:44<03:42,  5.85s/it]

Loading safetensors checkpoint shards:  34% Completed | 19/56 [01:50<03:38,  5.90s/it]

Loading safetensors checkpoint shards:  36% Completed | 20/56 [01:50<02:31,  4.20s/it]

Loading safetensors checkpoint shards:  38% Completed | 21/56 [01:56<02:45,  4.74s/it]

Loading safetensors checkpoint shards:  39% Completed | 22/56 [02:01<02:49,  4.99s/it]

Loading safetensors checkpoint shards:  41% Completed | 23/56 [02:07<02:50,  5.17s/it]

Loading safetensors checkpoint shards:  43% Completed | 24/56 [02:13<02:50,  5.34s/it]

Loading safetensors checkpoint shards:  45% Completed | 25/56 [02:18<02:48,  5.45s/it]

Loading safetensors checkpoint shards:  46% Completed | 26/56 [02:24<02:46,  5.55s/it]

Loading safetensors checkpoint shards:  48% Completed | 27/56 [02:29<02:35,  5.37s/it]

Loading safetensors checkpoint shards:  50% Completed | 28/56 [02:35<02:34,  5.52s/it]

Loading safetensors checkpoint shards:  52% Completed | 29/56 [02:41<02:32,  5.67s/it]

Loading safetensors checkpoint shards:  54% Completed | 30/56 [02:47<02:26,  5.65s/it]

Loading safetensors checkpoint shards:  55% Completed | 31/56 [02:53<02:25,  5.81s/it]

Loading safetensors checkpoint shards:  57% Completed | 32/56 [02:59<02:19,  5.82s/it]

Loading safetensors checkpoint shards:  59% Completed | 33/56 [03:04<02:11,  5.71s/it]

Loading safetensors checkpoint shards:  61% Completed | 34/56 [03:10<02:07,  5.79s/it]

Loading safetensors checkpoint shards:  62% Completed | 35/56 [03:16<02:05,  5.96s/it]

Loading safetensors checkpoint shards:  64% Completed | 36/56 [03:22<01:56,  5.85s/it]

Loading safetensors checkpoint shards:  66% Completed | 37/56 [03:28<01:52,  5.91s/it]

Loading safetensors checkpoint shards:  68% Completed | 38/56 [03:34<01:46,  5.91s/it]

Loading safetensors checkpoint shards:  70% Completed | 39/56 [03:40<01:42,  6.00s/it]

Loading safetensors checkpoint shards:  71% Completed | 40/56 [03:46<01:35,  5.96s/it]

Loading safetensors checkpoint shards:  73% Completed | 41/56 [03:52<01:28,  5.89s/it]

Loading safetensors checkpoint shards:  75% Completed | 42/56 [03:58<01:21,  5.83s/it]

Loading safetensors checkpoint shards:  77% Completed | 43/56 [04:03<01:15,  5.82s/it]

Loading safetensors checkpoint shards:  79% Completed | 44/56 [04:09<01:09,  5.82s/it]

Loading safetensors checkpoint shards:  80% Completed | 45/56 [04:15<01:03,  5.78s/it]

Loading safetensors checkpoint shards:  82% Completed | 46/56 [04:21<00:59,  5.97s/it]

Loading safetensors checkpoint shards:  84% Completed | 47/56 [04:27<00:53,  5.95s/it]

Loading safetensors checkpoint shards:  86% Completed | 48/56 [04:33<00:47,  5.91s/it]

Loading safetensors checkpoint shards:  88% Completed | 49/56 [04:39<00:41,  5.94s/it]

Loading safetensors checkpoint shards:  89% Completed | 50/56 [04:44<00:34,  5.80s/it]

Loading safetensors checkpoint shards:  91% Completed | 51/56 [04:50<00:29,  5.81s/it]

Loading safetensors checkpoint shards:  93% Completed | 52/56 [04:56<00:23,  5.87s/it]

Loading safetensors checkpoint shards:  95% Completed | 53/56 [05:02<00:17,  5.89s/it]

Loading safetensors checkpoint shards:  96% Completed | 54/56 [05:08<00:11,  5.84s/it]

Loading safetensors checkpoint shards:  98% Completed | 55/56 [05:13<00:05,  5.73s/it]

Loading safetensors checkpoint shards: 100% Completed | 56/56 [05:20<00:00,  5.90s/it]

Loading safetensors checkpoint shards: 100% Completed | 56/56 [05:20<00:00,  5.72s/it]

[2025-12-25 08:13:52 TP7] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.94 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP6] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.71 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP5] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.94 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP1] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.93 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP4] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.71 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP11] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.94 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP9] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.94 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP3] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.94 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP0] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.64 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP13] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.94 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP12] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.71 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP8] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.71 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP2] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.71 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP14] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.71 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP10] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.71 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP15] Load weight end. type=Qwen3MoeForCausalLM, dtype=torch.bfloat16, avail mem=44.94 GB, mem usage=16.16 GB.
[2025-12-25 08:13:52 TP0] Using KV cache dtype: torch.bfloat16
[2025-12-25 08:13:52 TP0] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP15] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP14] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP13] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP12] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP11] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP10] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP9] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP8] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP5] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP7] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP6] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP4] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP3] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP2] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP1] The available memory for KV cache is 31.28 GB.
[2025-12-25 08:13:52 TP6] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP0] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP3] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP11] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP12] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP5] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP14] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP9] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP10] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP2] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP1] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP7] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP13] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP15] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP4] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP8] KV Cache is allocated. #tokens: 697984, K size: 15.65 GB, V size: 15.65 GB
[2025-12-25 08:13:52 TP6] Memory pool end. avail mem=13.44 GB
[2025-12-25 08:13:52 TP0] Memory pool end. avail mem=13.37 GB
[2025-12-25 08:13:52 TP3] Memory pool end. avail mem=13.67 GB
[2025-12-25 08:13:52 TP11] Memory pool end. avail mem=13.67 GB
[2025-12-25 08:13:52 TP12] Memory pool end. avail mem=13.44 GB
[2025-12-25 08:13:52 TP5] Memory pool end. avail mem=13.67 GB
[2025-12-25 08:13:52 TP14] Memory pool end. avail mem=13.44 GB
[2025-12-25 08:13:52 TP9] Memory pool end. avail mem=13.67 GB
[2025-12-25 08:13:52 TP10] Memory pool end. avail mem=13.44 GB
[2025-12-25 08:13:52 TP2] Memory pool end. avail mem=13.44 GB
[2025-12-25 08:13:52 TP1] Memory pool end. avail mem=13.66 GB
[2025-12-25 08:13:52 TP7] Memory pool end. avail mem=13.67 GB
[2025-12-25 08:13:52 TP13] Memory pool end. avail mem=13.67 GB
[2025-12-25 08:13:52 TP15] Memory pool end. avail mem=13.67 GB
[2025-12-25 08:13:52 TP4] Memory pool end. avail mem=13.44 GB
[2025-12-25 08:13:52 TP8] Memory pool end. avail mem=13.44 GB
[2025-12-25 08:13:53 TP9] Capture cuda graph begin. This can take up to several minutes. avail mem=13.67 GB
[2025-12-25 08:13:53 TP14] Capture cuda graph begin. This can take up to several minutes. avail mem=13.44 GB
[2025-12-25 08:13:53 TP0] Capture cuda graph begin. This can take up to several minutes. avail mem=13.37 GB
[2025-12-25 08:13:53 TP5] Capture cuda graph begin. This can take up to several minutes. avail mem=13.67 GB
[2025-12-25 08:13:53 TP0] Capture cuda graph bs [1]
[2025-12-25 08:13:53 TP12] Capture cuda graph begin. This can take up to several minutes. avail mem=13.44 GB
[2025-12-25 08:13:53 TP3] Capture cuda graph begin. This can take up to several minutes. avail mem=13.67 GB
[2025-12-25 08:13:53 TP11] Capture cuda graph begin. This can take up to several minutes. avail mem=13.67 GB
[2025-12-25 08:13:53 TP2] Capture cuda graph begin. This can take up to several minutes. avail mem=13.44 GB
[2025-12-25 08:13:53 TP10] Capture cuda graph begin. This can take up to several minutes. avail mem=13.44 GB
[2025-12-25 08:13:53 TP1] Capture cuda graph begin. This can take up to several minutes. avail mem=13.66 GB
[2025-12-25 08:13:53 TP7] Capture cuda graph begin. This can take up to several minutes. avail mem=13.67 GB
[2025-12-25 08:13:53 TP15] Capture cuda graph begin. This can take up to several minutes. avail mem=13.67 GB
[2025-12-25 08:13:53 TP13] Capture cuda graph begin. This can take up to several minutes. avail mem=13.67 GB
[2025-12-25 08:13:53 TP4] Capture cuda graph begin. This can take up to several minutes. avail mem=13.44 GB
[2025-12-25 08:13:53 TP8] Capture cuda graph begin. This can take up to several minutes. avail mem=13.44 GB
[2025-12-25 08:13:53 TP6] Capture cuda graph begin. This can take up to several minutes. avail mem=13.44 GB

  0%|          | 0/1 [00:00<?, ?it/s]
Capturing batches (bs=1 avail_mem=13.36 GB):   0%|          | 0/1 [00:00<?, ?it/s][rank12]:[W1225 08:14:32.463928061 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank13]:[W1225 08:14:32.463928161 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank1]:[W1225 08:14:32.503879772 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank3]:[W1225 08:14:32.512022563 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank14]:[W1225 08:14:32.605052073 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank15]:[W1225 08:14:32.605052123 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank2]:[W1225 08:14:32.626130479 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank8]:[W1225 08:14:32.644458162 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank9]:[W1225 08:14:32.644674413 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank11]:[W1225 08:14:32.673055316 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank10]:[W1225 08:14:32.673676179 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank6]:[W1225 08:14:32.690624825 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank7]:[W1225 08:14:32.690625065 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank5]:[W1225 08:14:32.693314028 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank4]:[W1225 08:14:32.693313988 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank0]:[W1225 08:14:32.826093568 compiler_depend.ts:28] Warning: The oprator of MoeInitRouting will be removed from Pytorch and switch to AscendSpeed after 630. (function operator())
[rank3]:[W1225 08:14:33.263742776 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank0]:[W1225 08:14:33.263749196 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank1]:[W1225 08:14:33.263747556 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank8]:[W1225 08:14:33.263758436 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank2]:[W1225 08:14:33.263786017 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank10]:[W1225 08:14:33.263786817 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank4]:[W1225 08:14:33.263793367 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank5]:[W1225 08:14:33.263798287 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank15]:[W1225 08:14:33.263799307 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank14]:[W1225 08:14:33.263799357 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank6]:[W1225 08:14:33.263804947 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank7]:[W1225 08:14:33.263801887 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank13]:[W1225 08:14:33.263808427 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank12]:[W1225 08:14:33.263808397 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank9]:[W1225 08:14:33.263810017 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())
[rank11]:[W1225 08:14:33.263810167 compiler_depend.ts:171] Warning: Waiting for pending NCCL work to finish before starting graph capture. (function operator())

Capturing batches (bs=1 avail_mem=13.36 GB): 100%|| 1/1 [00:41<00:00, 41.09s/it]
Capturing batches (bs=1 avail_mem=13.36 GB): 100%|| 1/1 [00:41<00:00, 41.09s/it]
[2025-12-25 08:14:34 TP12] Capture cuda graph end. Time elapsed: 41.83 s. mem usage=3.55 GB. avail mem=9.89 GB.
[2025-12-25 08:14:34 TP13] Capture cuda graph end. Time elapsed: 41.86 s. mem usage=3.55 GB. avail mem=10.12 GB.
[2025-12-25 08:14:34 TP7] Capture cuda graph end. Time elapsed: 41.88 s. mem usage=3.55 GB. avail mem=10.12 GB.
[2025-12-25 08:14:34 TP0] Capture cuda graph end. Time elapsed: 41.90 s. mem usage=3.55 GB. avail mem=9.82 GB.
[2025-12-25 08:14:34 TP11] Capture cuda graph end. Time elapsed: 41.91 s. mem usage=3.55 GB. avail mem=10.11 GB.
[2025-12-25 08:14:34 TP5] Capture cuda graph end. Time elapsed: 41.96 s. mem usage=3.55 GB. avail mem=10.11 GB.
[2025-12-25 08:14:35 TP4] Capture cuda graph end. Time elapsed: 42.08 s. mem usage=3.55 GB. avail mem=9.89 GB.
[2025-12-25 08:14:35 TP1] Capture cuda graph end. Time elapsed: 42.08 s. mem usage=3.55 GB. avail mem=10.11 GB.
[2025-12-25 08:14:35 TP6] Capture cuda graph end. Time elapsed: 42.07 s. mem usage=3.55 GB. avail mem=9.88 GB.
[2025-12-25 08:14:35 TP15] Capture cuda graph end. Time elapsed: 42.10 s. mem usage=3.55 GB. avail mem=10.11 GB.
[2025-12-25 08:14:35 TP14] Capture cuda graph end. Time elapsed: 42.11 s. mem usage=3.55 GB. avail mem=9.89 GB.
[2025-12-25 08:14:35 TP8] Capture cuda graph end. Time elapsed: 42.11 s. mem usage=3.55 GB. avail mem=9.88 GB.
[2025-12-25 08:14:35 TP10] Capture cuda graph end. Time elapsed: 42.13 s. mem usage=3.55 GB. avail mem=9.89 GB.
[2025-12-25 08:14:35 TP9] Capture cuda graph end. Time elapsed: 42.15 s. mem usage=3.55 GB. avail mem=10.12 GB.
[2025-12-25 08:14:35 TP2] Capture cuda graph end. Time elapsed: 42.16 s. mem usage=3.55 GB. avail mem=9.88 GB.
[2025-12-25 08:14:35 TP3] Capture cuda graph end. Time elapsed: 42.16 s. mem usage=3.55 GB. avail mem=10.12 GB.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:1204: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  tensor_data = torch.ByteTensor(
[2025-12-25 08:14:35 TP12] Init torch distributed begin.
[2025-12-25 08:14:35 TP13] Init torch distributed begin.
[2025-12-25 08:14:35 TP5] Init torch distributed begin.
[2025-12-25 08:14:35 TP11] Init torch distributed begin.
[2025-12-25 08:14:35 TP0] Init torch distributed begin.
[2025-12-25 08:14:35 TP7] Init torch distributed begin.
[2025-12-25 08:14:35 TP4] Init torch distributed begin.
[2025-12-25 08:14:35 TP15] Init torch distributed begin.
[2025-12-25 08:14:35 TP14] Init torch distributed begin.
[2025-12-25 08:14:35 TP6] Init torch distributed begin.
[2025-12-25 08:14:35 TP1] Init torch distributed begin.
[2025-12-25 08:14:35 TP8] Init torch distributed begin.
[2025-12-25 08:14:35 TP9] Init torch distributed begin.
[2025-12-25 08:14:35 TP3] Init torch distributed begin.
[2025-12-25 08:14:35 TP2] Init torch distributed begin.
[2025-12-25 08:14:35 TP10] Init torch distributed begin.
[2025-12-25 08:14:35 TP0] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP14] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP12] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP15] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP13] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP9] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP10] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP11] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP8] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP6] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP7] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP4] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP5] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP1] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP2] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP3] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 08:14:35 TP0] Load weight begin. avail mem=9.82 GB
[2025-12-25 08:14:35 TP12] Load weight begin. avail mem=9.89 GB
[2025-12-25 08:14:35 TP14] Load weight begin. avail mem=9.89 GB
[2025-12-25 08:14:35 TP13] Load weight begin. avail mem=10.12 GB
[2025-12-25 08:14:35 TP15] Load weight begin. avail mem=10.11 GB
[2025-12-25 08:14:35 TP4] Load weight begin. avail mem=9.89 GB
[2025-12-25 08:14:35 TP8] Load weight begin. avail mem=9.89 GB
[2025-12-25 08:14:35 TP10] Load weight begin. avail mem=9.89 GB
[2025-12-25 08:14:35 TP11] Load weight begin. avail mem=10.11 GB
[2025-12-25 08:14:35 TP6] Load weight begin. avail mem=9.88 GB
[2025-12-25 08:14:35 TP1] Load weight begin. avail mem=10.11 GB
[2025-12-25 08:14:35 TP2] Load weight begin. avail mem=9.88 GB
[2025-12-25 08:14:35 TP9] Load weight begin. avail mem=10.12 GB
[2025-12-25 08:14:35 TP7] Load weight begin. avail mem=10.12 GB
[2025-12-25 08:14:35 TP5] Load weight begin. avail mem=10.11 GB
[2025-12-25 08:14:35 TP3] Load weight begin. avail mem=10.12 GB

Loading safetensors checkpoint shards:   0% Completed | 0/1 [00:00<?, ?it/s]

Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.24s/it]

Loading safetensors checkpoint shards: 100% Completed | 1/1 [00:01<00:00,  1.24s/it]

[2025-12-25 08:14:36 TP2] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.65 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP1] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.88 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP3] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.88 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP0] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.59 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP13] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.88 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP12] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.65 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP14] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.66 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP15] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.88 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP5] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.88 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP6] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.65 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP4] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.65 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP7] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.88 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP8] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.65 GB, mem usage=0.24 GB.
[2025-12-25 08:14:36 TP9] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.88 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP11] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.88 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP10] Load weight end. type=LlamaForCausalLMEagle3, dtype=torch.bfloat16, avail mem=9.66 GB, mem usage=0.23 GB.
[2025-12-25 08:14:36 TP0] Using KV cache dtype: torch.bfloat16
[2025-12-25 08:14:36 TP0] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP15] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP14] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP13] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP12] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP11] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP10] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP9] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP8] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP7] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP6] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP5] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP4] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP3] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP2] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP1] The available memory for KV cache is 7.43 GB.
[2025-12-25 08:14:36 TP0] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP12] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP15] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP14] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP11] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP13] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP10] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP9] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP5] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP4] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP6] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP7] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP8] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP3] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP1] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP2] KV Cache is allocated. #tokens: 697984, K size: 0.17 GB, V size: 0.17 GB
[2025-12-25 08:14:36 TP0] Memory pool end. avail mem=9.25 GB
[2025-12-25 08:14:36 TP12] Memory pool end. avail mem=9.32 GB
[2025-12-25 08:14:36 TP11] Memory pool end. avail mem=9.55 GB
[2025-12-25 08:14:36 TP14] Memory pool end. avail mem=9.32 GB
[2025-12-25 08:14:36 TP15] Memory pool end. avail mem=9.55 GB
[2025-12-25 08:14:36 TP13] Memory pool end. avail mem=9.55 GB
[2025-12-25 08:14:36 TP10] Memory pool end. avail mem=9.32 GB
[2025-12-25 08:14:36 TP4] Memory pool end. avail mem=9.32 GB
[2025-12-25 08:14:36 TP9] Memory pool end. avail mem=9.55 GB
[2025-12-25 08:14:36 TP5] Memory pool end. avail mem=9.55 GB
[2025-12-25 08:14:36 TP6] Memory pool end. avail mem=9.32 GB
[2025-12-25 08:14:36 TP7] Memory pool end. avail mem=9.55 GB
[2025-12-25 08:14:36 TP3] Memory pool end. avail mem=9.55 GB
[2025-12-25 08:14:36 TP8] Memory pool end. avail mem=9.32 GB
[2025-12-25 08:14:36 TP1] Memory pool end. avail mem=9.54 GB
[2025-12-25 08:14:36 TP2] Memory pool end. avail mem=9.32 GB
[2025-12-25 08:14:37 TP11] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.64 GB
[2025-12-25 08:14:37 TP10] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.42 GB
[2025-12-25 08:14:37 TP0] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.35 GB
[2025-12-25 08:14:37 TP13] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.65 GB
[2025-12-25 08:14:37 TP12] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.42 GB
[2025-12-25 08:14:37 TP9] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.65 GB
[2025-12-25 08:14:37 TP4] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.42 GB
[2025-12-25 08:14:37 TP8] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.42 GB
[2025-12-25 08:14:37 TP5] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.65 GB
[2025-12-25 08:14:37 TP1] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.64 GB
[2025-12-25 08:14:37 TP6] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.42 GB
[2025-12-25 08:14:37 TP7] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.65 GB
[2025-12-25 08:14:37 TP14] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.42 GB
[2025-12-25 08:14:37 TP15] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.64 GB
[2025-12-25 08:14:37 TP3] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.65 GB
[2025-12-25 08:14:37 TP2] Capture draft cuda graph begin. This can take up to several minutes. avail mem=9.41 GB

  0%|          | 0/1 [00:00<?, ?it/s]
Capturing batches (bs=1 avail_mem=9.35 GB):   0%|          | 0/1 [00:00<?, ?it/s]
Capturing batches (bs=1 avail_mem=9.35 GB): 100%|| 1/1 [00:03<00:00,  3.67s/it]
Capturing batches (bs=1 avail_mem=9.35 GB): 100%|| 1/1 [00:03<00:00,  3.67s/it]
[2025-12-25 08:14:42 TP12] Capture draft cuda graph end. Time elapsed: 4.40 s. mem usage=0.06 GB. avail mem=9.35 GB.
[2025-12-25 08:14:42 TP12] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.35 GB
[2025-12-25 08:14:42 TP13] Capture draft cuda graph end. Time elapsed: 4.44 s. mem usage=0.06 GB. avail mem=9.58 GB.
[2025-12-25 08:14:42 TP13] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.58 GB
[2025-12-25 08:14:42 TP0] Capture draft cuda graph end. Time elapsed: 4.45 s. mem usage=0.07 GB. avail mem=9.29 GB.
[2025-12-25 08:14:42 TP0] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.29 GB
[2025-12-25 08:14:42 TP11] Capture draft cuda graph end. Time elapsed: 4.46 s. mem usage=0.06 GB. avail mem=9.58 GB.
[2025-12-25 08:14:42 TP11] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.58 GB
[2025-12-25 08:14:42 TP7] Capture draft cuda graph end. Time elapsed: 4.54 s. mem usage=0.06 GB. avail mem=9.59 GB.
[2025-12-25 08:14:42 TP7] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.59 GB
[2025-12-25 08:14:42 TP5] Capture draft cuda graph end. Time elapsed: 4.61 s. mem usage=0.06 GB. avail mem=9.58 GB.
[2025-12-25 08:14:42 TP5] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.58 GB
[2025-12-25 08:14:42 TP8] Capture draft cuda graph end. Time elapsed: 4.71 s. mem usage=0.06 GB. avail mem=9.35 GB.
[2025-12-25 08:14:42 TP8] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.35 GB
[2025-12-25 08:14:42 TP9] Capture draft cuda graph end. Time elapsed: 4.72 s. mem usage=0.06 GB. avail mem=9.58 GB.
[2025-12-25 08:14:42 TP9] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.58 GB
[2025-12-25 08:14:42 TP4] Capture draft cuda graph end. Time elapsed: 4.75 s. mem usage=0.07 GB. avail mem=9.35 GB.
[2025-12-25 08:14:42 TP4] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.35 GB
[2025-12-25 08:14:42 TP1] Capture draft cuda graph end. Time elapsed: 4.76 s. mem usage=0.06 GB. avail mem=9.58 GB.
[2025-12-25 08:14:42 TP1] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.58 GB
[2025-12-25 08:14:42 TP15] Capture draft cuda graph end. Time elapsed: 4.78 s. mem usage=0.06 GB. avail mem=9.58 GB.
[2025-12-25 08:14:42 TP6] Capture draft cuda graph end. Time elapsed: 4.78 s. mem usage=0.07 GB. avail mem=9.35 GB.
[2025-12-25 08:14:42 TP15] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.58 GB
[2025-12-25 08:14:42 TP6] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.35 GB
[2025-12-25 08:14:42 TP14] Capture draft cuda graph end. Time elapsed: 4.79 s. mem usage=0.07 GB. avail mem=9.36 GB.
[2025-12-25 08:14:42 TP14] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.36 GB

  0%|          | 0/1 [00:00<?, ?it/s]
Capturing batches (bs=1 avail_mem=9.29 GB):   0%|          | 0/1 [00:00<?, ?it/s][2025-12-25 08:14:42 TP2] Capture draft cuda graph end. Time elapsed: 4.82 s. mem usage=0.06 GB. avail mem=9.35 GB.
[2025-12-25 08:14:42 TP2] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.35 GB
[2025-12-25 08:14:42 TP3] Capture draft cuda graph end. Time elapsed: 4.83 s. mem usage=0.06 GB. avail mem=9.59 GB.
[2025-12-25 08:14:42 TP3] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.59 GB
[2025-12-25 08:14:42 TP10] Capture draft cuda graph end. Time elapsed: 4.85 s. mem usage=0.06 GB. avail mem=9.36 GB.
[2025-12-25 08:14:42 TP10] Capture draft extend cuda graph begin. This can take up to several minutes. avail mem=9.36 GB

Capturing batches (bs=1 avail_mem=9.29 GB): 100%|| 1/1 [00:02<00:00,  2.24s/it]
Capturing batches (bs=1 avail_mem=9.29 GB): 100%|| 1/1 [00:02<00:00,  2.24s/it]
[2025-12-25 08:14:45 TP12] Capture draft extend cuda graph end. Time elapsed: 2.98 s. mem usage=0.18 GB. avail mem=9.17 GB.
[2025-12-25 08:14:45 TP13] Capture draft extend cuda graph end. Time elapsed: 2.99 s. mem usage=0.18 GB. avail mem=9.40 GB.
[2025-12-25 08:14:45 TP0] Capture draft extend cuda graph end. Time elapsed: 2.98 s. mem usage=0.18 GB. avail mem=9.11 GB.
[2025-12-25 08:14:45 TP0] max_total_num_tokens=697984, chunked_prefill_size=-1, max_prefill_tokens=2048, max_running_requests=1, context_len=40960, available_gpu_mem=9.11 GB
[2025-12-25 08:14:45 TP11] Capture draft extend cuda graph end. Time elapsed: 3.00 s. mem usage=0.18 GB. avail mem=9.40 GB.
[2025-12-25 08:14:45 TP7] Capture draft extend cuda graph end. Time elapsed: 3.00 s. mem usage=0.18 GB. avail mem=9.41 GB.
[2025-12-25 08:14:45 TP5] Capture draft extend cuda graph end. Time elapsed: 3.00 s. mem usage=0.18 GB. avail mem=9.40 GB.
[2025-12-25 08:14:45 TP8] Capture draft extend cuda graph end. Time elapsed: 2.98 s. mem usage=0.18 GB. avail mem=9.17 GB.
[2025-12-25 08:14:45 TP9] Capture draft extend cuda graph end. Time elapsed: 2.98 s. mem usage=0.18 GB. avail mem=9.40 GB.
[2025-12-25 08:14:45 TP4] Capture draft extend cuda graph end. Time elapsed: 2.97 s. mem usage=0.18 GB. avail mem=9.17 GB.
[2025-12-25 08:14:45 TP1] Capture draft extend cuda graph end. Time elapsed: 2.96 s. mem usage=0.18 GB. avail mem=9.40 GB.
[2025-12-25 08:14:45 TP15] Capture draft extend cuda graph end. Time elapsed: 2.97 s. mem usage=0.18 GB. avail mem=9.40 GB.
[2025-12-25 08:14:45 TP6] Capture draft extend cuda graph end. Time elapsed: 2.97 s. mem usage=0.18 GB. avail mem=9.17 GB.
[2025-12-25 08:14:45 TP14] Capture draft extend cuda graph end. Time elapsed: 2.97 s. mem usage=0.18 GB. avail mem=9.18 GB.
[2025-12-25 08:14:45 TP10] Capture draft extend cuda graph end. Time elapsed: 2.96 s. mem usage=0.18 GB. avail mem=9.18 GB.
[2025-12-25 08:14:45 TP2] Capture draft extend cuda graph end. Time elapsed: 2.98 s. mem usage=0.18 GB. avail mem=9.17 GB.
[2025-12-25 08:14:45 TP3] Capture draft extend cuda graph end. Time elapsed: 2.98 s. mem usage=0.18 GB. avail mem=9.41 GB.
[2025-12-25 08:14:46] INFO:     Started server process [804]
[2025-12-25 08:14:46] INFO:     Waiting for application startup.
[2025-12-25 08:14:46] Using default chat sampling params from model generation config: {'repetition_penalty': 1.0, 'temperature': 0.6, 'top_k': 20, 'top_p': 0.95}
[2025-12-25 08:14:46] Using default chat sampling params from model generation config: {'repetition_penalty': 1.0, 'temperature': 0.6, 'top_k': 20, 'top_p': 0.95}
[2025-12-25 08:14:46] INFO:     Application startup complete.
[2025-12-25 08:14:46] INFO:     Uvicorn running on http://127.0.0.1:21000 (Press CTRL+C to quit)
................................[2025-12-25 08:14:47] INFO:     127.0.0.1:49324 - "GET /model_info HTTP/1.1" 200 OK
[2025-12-25 08:14:47 TP0] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[rank0]:[W1225 08:14:47.288111034 compiler_depend.ts:117] Warning: Driver Version:  is invalid or not supported yet. (function operator())
[rank1]:[W1225 08:14:47.288116795 compiler_depend.ts:117] Warning: Driver Version: k is invalid or not supported yet. (function operator())
[rank11]:[W1225 08:14:47.288158065 compiler_depend.ts:117] Warning: Driver Version: w is invalid or not supported yet. (function operator())
[rank5]:[W1225 08:14:47.288159625 compiler_depend.ts:117] Warning: Driver Version: w is invalid or not supported yet. (function operator())
[rank8]:[W1225 08:14:47.288170335 compiler_depend.ts:117] Warning: Driver Version: s is invalid or not supported yet. (function operator())
[rank7]:[W1225 08:14:47.288189175 compiler_depend.ts:117] Warning: Driver Version:  is invalid or not supported yet. (function operator())
[rank9]:[W1225 08:14:47.288196815 compiler_depend.ts:117] Warning: Driver Version:  is invalid or not supported yet. (function operator())
[rank12]:[W1225 08:14:47.288211565 compiler_depend.ts:117] Warning: Driver Version:  is invalid or not supported yet. (function operator())
[rank13]:[W1225 08:14:47.288218395 compiler_depend.ts:117] Warning: Driver Version: o is invalid or not supported yet. (function operator())
[rank6]:[W1225 08:14:47.288217355 compiler_depend.ts:117] Warning: Driver Version:  is invalid or not supported yet. (function operator())
[rank14]:[W1225 08:14:47.288249795 compiler_depend.ts:117] Warning: Driver Version: c is invalid or not supported yet. (function operator())
[rank15]:[W1225 08:14:47.288255135 compiler_depend.ts:117] Warning: Driver Version:  is invalid or not supported yet. (function operator())
[rank10]:[W1225 08:14:47.288263785 compiler_depend.ts:117] Warning: Driver Version: _ is invalid or not supported yet. (function operator())
[rank4]:[W1225 08:14:47.288283205 compiler_depend.ts:117] Warning: Driver Version: s is invalid or not supported yet. (function operator())
[rank3]:[W1225 08:14:47.288299665 compiler_depend.ts:117] Warning: Driver Version:  is invalid or not supported yet. (function operator())
[rank2]:[W1225 08:14:47.288299245 compiler_depend.ts:117] Warning: Driver Version:  is invalid or not supported yet. (function operator())
[2025-12-25 08:14:55] INFO:     127.0.0.1:38608 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 08:15:05] INFO:     127.0.0.1:40674 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 08:15:14] INFO:     127.0.0.1:49332 - "POST /generate HTTP/1.1" 200 OK
[2025-12-25 08:15:14] The server is fired up and ready to roll!
[2025-12-25 08:15:15 TP0] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-25 08:15:23] INFO:     127.0.0.1:60852 - "GET /health_generate HTTP/1.1" 200 OK
[CI Test Method] TestQwen3_235B.test_qwen3_235b
The metrics result file: /data/d00662834/metrics/20251225/test_ascend_qwen3_235b_w8a8_8p_in11k_out1k_20ms.txt
command:python3 -m sglang.bench_serving --backend sglang --model /root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8 --host 127.0.0.1 --port 21000 --dataset-name random  --max-concurrency 1 --num-prompts 1 --random-input-len 11000 --random-output-len 1000 --random-range-ratio 1
[2025-12-25 08:15:42] INFO:     127.0.0.1:39922 - "POST /generate HTTP/1.1" 200 OK
[2025-12-25 08:15:42 TP0] Prefill batch, #new-seq: 1, #new-token: 11008, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-25 08:15:52] INFO:     127.0.0.1:45188 - "POST /generate HTTP/1.1" 200 OK
[2025-12-25 08:15:52 TP0] Prefill batch, #new-seq: 1, #new-token: 11008, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, 
[2025-12-25 08:15:54 TP0] Decode batch, #running-req: 1, #token: 11136, token usage: 0.02, accept len: 3.23, accept rate: 0.81, cpu graph: True, gen throughput (token/s): 0.26, #queue-req: 0, 
[2025-12-25 08:15:55 TP0] Decode batch, #running-req: 1, #token: 11264, token usage: 0.02, accept len: 3.40, accept rate: 0.85, cpu graph: True, gen throughput (token/s): 78.77, #queue-req: 0, 
[2025-12-25 08:15:57 TP0] Decode batch, #running-req: 1, #token: 11392, token usage: 0.02, accept len: 3.40, accept rate: 0.85, cpu graph: True, gen throughput (token/s): 79.26, #queue-req: 0, 
[2025-12-25 08:15:59 TP0] Decode batch, #running-req: 1, #token: 11520, token usage: 0.02, accept len: 3.40, accept rate: 0.85, cpu graph: True, gen throughput (token/s): 78.55, #queue-req: 0, 
[2025-12-25 08:16:01 TP0] Decode batch, #running-req: 1, #token: 11648, token usage: 0.02, accept len: 3.40, accept rate: 0.85, cpu graph: True, gen throughput (token/s): 78.32, #queue-req: 0, 
[2025-12-25 08:16:02 TP0] Decode batch, #running-req: 1, #token: 11776, token usage: 0.02, accept len: 3.40, accept rate: 0.85, cpu graph: True, gen throughput (token/s): 75.15, #queue-req: 0, 
[2025-12-25 08:16:04 TP0] Decode batch, #running-req: 1, #token: 11904, token usage: 0.02, accept len: 3.40, accept rate: 0.85, cpu graph: True, gen throughput (token/s): 78.53, #queue-req: 0, 
[2025-12-25 08:16:05] Endpoint '/get_server_info' is deprecated and will be removed in a future version. Please use '/server_info' instead.
[2025-12-25 08:16:05] INFO:     127.0.0.1:40080 - "GET /get_server_info HTTP/1.1" 200 OK
[2025-12-25 08:16:06] Endpoint '/get_server_info' is deprecated and will be removed in a future version. Please use '/server_info' instead.
[2025-12-25 08:16:06] INFO:     127.0.0.1:40086 - "GET /get_server_info HTTP/1.1" 200 OK
metrics is benchmark_args=Namespace(backend='sglang', base_url=None, host='127.0.0.1', port=21000, dataset_name='random', dataset_path='', model='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8', served_model_name=None, tokenizer=None, num_prompts=1, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=11000, random_output_len=1000, random_range_ratio=1.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=inf, use_trace_timestamps=False, max_concurrency=1, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, return_routed_experts=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, gsp_send_routing_id=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)
Namespace(backend='sglang', base_url=None, host='127.0.0.1', port=21000, dataset_name='random', dataset_path='', model='/root/.cache/modelscope/hub/models/vllm-ascend/Qwen3-235B-A22B-W8A8', served_model_name=None, tokenizer=None, num_prompts=1, sharegpt_output_len=None, sharegpt_context_len=None, random_input_len=11000, random_output_len=1000, random_range_ratio=1.0, image_count=1, image_resolution='1080p', random_image_count=False, image_format='jpeg', image_content='random', request_rate=inf, use_trace_timestamps=False, max_concurrency=1, output_file=None, output_details=False, print_requests=False, disable_tqdm=False, disable_stream=False, return_logprob=False, return_routed_experts=False, seed=1, disable_ignore_eos=False, extra_request_body=None, apply_chat_template=False, profile=False, plot_throughput=False, profile_activities=['CPU', 'GPU'], profile_num_steps=None, profile_by_stage=False, profile_stages=None, lora_name=None, lora_request_distribution='uniform', lora_zipf_alpha=1.5, prompt_suffix='', pd_separated=False, profile_prefill_url=None, profile_decode_url=None, flush_cache=False, warmup_requests=1, tokenize_prompt=False, gsp_num_groups=64, gsp_prompts_per_group=16, gsp_system_prompt_len=2048, gsp_question_len=128, gsp_output_len=256, gsp_range_ratio=1.0, gsp_fast_prepare=False, gsp_send_routing_id=False, mooncake_slowdown_factor=1.0, mooncake_num_rounds=1, mooncake_workload='conversation', tag=None)

#Input tokens: 11000
#Output tokens: 1000
Starting warmup with 1 sequences...
Warmup completed with 1 sequences. Starting main benchmark run...

============ Serving Benchmark Result ============
Backend:                                 sglang    
Traffic request rate:                    inf       
Max request concurrency:                 1         
Successful requests:                     1         
Benchmark duration (s):                  13.78     
Total input tokens:                      11000     
Total input text tokens:                 11000     
Total input vision tokens:               0         
Total generated tokens:                  1000      
Total generated tokens (retokenized):    1000      
Request throughput (req/s):              0.07      
Input token throughput (tok/s):          798.04    
Output token throughput (tok/s):         72.55     
Peak output token throughput (tok/s):    81.00     
Peak concurrent requests:                1         
Total token throughput (tok/s):          870.59    
Concurrency:                             1.00      
Accept length:                           3.38      
----------------End-to-End Latency----------------
Mean E2E Latency (ms):                   13747.97  
Median E2E Latency (ms):                 13747.97  
---------------Time to First Token----------------
Mean TTFT (ms):                          1016.51   
Median TTFT (ms):                        1016.51   
P99 TTFT (ms):                           1016.51   
-----Time per Output Token (excl. 1st token)------
Mean TPOT (ms):                          12.74     
Median TPOT (ms):                        12.74     
P99 TPOT (ms):                           12.74     
---------------Inter-Token Latency----------------
Mean ITL (ms):                           12.74     
Median ITL (ms):                         13.95     
P95 ITL (ms):                            14.75     
P99 ITL (ms):                            15.08     
Max ITL (ms):                            37.14     
==================================================

Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py", line 2527, in retry
    return fn()
           ^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/test/test_utils.py", line 1704, in <lambda>
    lambda: super(CustomTestCase, self)._callTestMethod(method),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/unittest/case.py", line 579, in _callTestMethod
    if method() is not None:
       ^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/test/nightly/ascend/performance/test_ascend_qwen3_235b_w8a8_8p_in11k_out1k_20ms.py", line 85, in test_qwen3_235b
    self.run_throughput()
  File "/data/d00662834/1211_dev/sglang/test/nightly/ascend/performance/test_ascend_single_mix_utils.py", line 111, in run_throughput
    metrics = run_bench_serving(
              ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/test/nightly/ascend/performance/test_ascend_single_mix_utils.py", line 53, in run_bench_serving
    "cat {} | grep 'Mean TTFT' | awk '{print $4}'".format(result_file)
KeyError: 'print $4'
E
======================================================================
ERROR: test_qwen3_235b (__main__.TestQwen3_235B.test_qwen3_235b)
----------------------------------------------------------------------
Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py", line 2527, in retry
    return fn()
           ^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/test/test_utils.py", line 1704, in <lambda>
    lambda: super(CustomTestCase, self)._callTestMethod(method),
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/unittest/case.py", line 579, in _callTestMethod
    if method() is not None:
       ^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/test/nightly/ascend/performance/test_ascend_qwen3_235b_w8a8_8p_in11k_out1k_20ms.py", line 85, in test_qwen3_235b
    self.run_throughput()
  File "/data/d00662834/1211_dev/sglang/test/nightly/ascend/performance/test_ascend_single_mix_utils.py", line 111, in run_throughput
    metrics = run_bench_serving(
              ^^^^^^^^^^^^^^^^^^
  File "/data/d00662834/1211_dev/sglang/test/nightly/ascend/performance/test_ascend_single_mix_utils.py", line 53, in run_bench_serving
    "cat {} | grep 'Mean TTFT' | awk '{print $4}'".format(result_file)
KeyError: 'print $4'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/test/test_utils.py", line 1703, in _callTestMethod
    retry(
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py", line 2535, in retry
    raise Exception(f"retry() exceed maximum number of retries.")
Exception: retry() exceed maximum number of retries.

----------------------------------------------------------------------
Ran 1 test in 544.378s

FAILED (errors=1)
Finished test case test/nightly/ascend/performance/test_ascend_qwen3_235b_w8a8_8p_in11k_out1k_20ms.py

Error: Pod logs ended but target pattern was not detected
job.batch.volcano.sh "sglang-single-45924635-647e-4ad5-8f8a-1ab40c72fcd8" deleted
