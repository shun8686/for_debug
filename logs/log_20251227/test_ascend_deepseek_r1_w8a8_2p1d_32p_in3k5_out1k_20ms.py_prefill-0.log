Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting kubernetes
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/ca/ec/65f7d563aa4a62dd58777e8f6aa882f15db53b14eb29aba0c28a20f7eb26/kubernetes-34.1.0-py2.py3-none-any.whl (2.0 MB)
Requirement already satisfied: certifi>=14.05.14 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2025.11.12)
Requirement already satisfied: six>=1.9.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (1.17.0)
Requirement already satisfied: python-dateutil>=2.5.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.9.0.post0)
Requirement already satisfied: pyyaml>=5.4.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (6.0.3)
Collecting google-auth>=1.0.1 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c6/97/451d55e05487a5cd6279a01a7e34921858b16f7dc8aa38a2c684743cd2b3/google_auth-2.45.0-py2.py3-none-any.whl (233 kB)
Collecting websocket-client!=0.40.0,!=0.41.*,!=0.42.*,>=0.32.0 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/34/db/b10e48aa8fff7407e67470363eac595018441cf32d5e1001567a7aeba5d2/websocket_client-1.9.0-py3-none-any.whl (82 kB)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from kubernetes) (2.32.5)
Collecting requests-oauthlib (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/3b/5d/63d4ae3b9daea098d5d6f5da83984853c1bbacd5dc826764b249fe119d24/requests_oauthlib-2.0.0-py2.py3-none-any.whl (24 kB)
Collecting urllib3<2.4.0,>=1.24.2 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c8/19/4ec628951a74043532ca2cf5d97b7b14863931476d117c471e8e2b1eb39f/urllib3-2.3.0-py3-none-any.whl (128 kB)
Collecting durationpy>=0.7 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/b0/0d/9feae160378a3553fa9a339b0e9c1a048e147a4127210e286ef18b730f03/durationpy-0.10-py3-none-any.whl (3.9 kB)
Collecting cachetools<7.0,>=2.0.0 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/2c/fc/1d7b80d0eb7b714984ce40efc78859c022cd930e402f599d8ca9e39c78a4/cachetools-6.2.4-py3-none-any.whl (11 kB)
Collecting pyasn1-modules>=0.2.1 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/47/8d/d529b5d697919ba8c11ad626e835d4039be708a35b0d22de83a269a6682c/pyasn1_modules-0.4.2-py3-none-any.whl (181 kB)
Collecting rsa<5,>=3.1.4 (from google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/64/8d/0133e4eb4beed9e425d9a98ed6e081a55d195481b7632472be1af08d2f6b/rsa-4.9.1-py3-none-any.whl (34 kB)
Collecting pyasn1>=0.1.3 (from rsa<5,>=3.1.4->google-auth>=1.0.1->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/c8/f1/d6a797abb14f6283c0ddff96bbdd46937f64122b8c925cab503dd37f8214/pyasn1-0.6.1-py3-none-any.whl (83 kB)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->kubernetes) (3.11)
Collecting oauthlib>=3.0.0 (from requests-oauthlib->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/be/9c/92789c596b8df838baa98fa71844d84283302f7604ed565dafe5a6b5041a/oauthlib-3.3.1-py3-none-any.whl (160 kB)
Installing collected packages: durationpy, websocket-client, urllib3, pyasn1, oauthlib, cachetools, rsa, pyasn1-modules, requests-oauthlib, google-auth, kubernetes
  Attempting uninstall: urllib3
    Found existing installation: urllib3 2.5.0
    Uninstalling urllib3-2.5.0:
      Successfully uninstalled urllib3-2.5.0

Successfully installed cachetools-6.2.4 durationpy-0.10 google-auth-2.45.0 kubernetes-34.1.0 oauthlib-3.3.1 pyasn1-0.6.1 pyasn1-modules-0.4.2 requests-oauthlib-2.0.0 rsa-4.9.1 urllib3-2.3.0 websocket-client-1.9.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Collecting xgrammar==0.1.25
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/55/04/55a87e814bcab771d3e4159281fa382b3d5f14a36114f2f9e572728da831/xgrammar-0.1.25-cp311-cp311-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (8.5 MB)
Requirement already satisfied: pydantic in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.12.5)
Requirement already satisfied: torch>=1.10.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.8.0+cpu)
Requirement already satisfied: transformers>=4.38.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (4.57.1)
Requirement already satisfied: ninja in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (1.13.0)
Requirement already satisfied: numpy in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (2.4.0)
Requirement already satisfied: typing-extensions>=4.9.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from xgrammar==0.1.25) (4.15.0)
Requirement already satisfied: filelock in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.20.0)
Requirement already satisfied: sympy>=1.13.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (1.14.0)
Requirement already satisfied: networkx in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.6.1)
Requirement already satisfied: jinja2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (3.1.6)
Requirement already satisfied: fsspec in /usr/local/python3.11.13/lib/python3.11/site-packages (from torch>=1.10.0->xgrammar==0.1.25) (2025.10.0)
Requirement already satisfied: mpmath<1.4,>=1.1.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from sympy>=1.13.3->torch>=1.10.0->xgrammar==0.1.25) (1.3.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.34.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.36.0)
Requirement already satisfied: packaging>=20.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (25.0)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (6.0.3)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (2025.11.3)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (2.32.5)
Requirement already satisfied: tokenizers<=0.23.0,>=0.22.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.22.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (0.7.0)
Requirement already satisfied: tqdm>=4.27 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers>=4.38.0->xgrammar==0.1.25) (4.67.1)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers>=4.38.0->xgrammar==0.1.25) (1.2.0)
Requirement already satisfied: MarkupSafe>=2.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from jinja2->torch>=1.10.0->xgrammar==0.1.25) (2.1.5)
Requirement already satisfied: annotated-types>=0.6.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (0.7.0)
Requirement already satisfied: pydantic-core==2.41.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (2.41.5)
Requirement already satisfied: typing-inspection>=0.4.2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from pydantic->xgrammar==0.1.25) (0.4.2)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers>=4.38.0->xgrammar==0.1.25) (2025.11.12)
Installing collected packages: xgrammar
  Attempting uninstall: xgrammar
    Found existing installation: xgrammar 0.1.27
    Uninstalling xgrammar-0.1.27:
      Successfully uninstalled xgrammar-0.1.27
Successfully installed xgrammar-0.1.25
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
Looking in indexes: http://cache-service.nginx-pypi-cache.svc.cluster.local/pypi/simple, https://pypi.tuna.tsinghua.edu.cn/simple
Requirement already satisfied: transformers==4.57.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (4.57.1)
Requirement already satisfied: filelock in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (3.20.0)
Requirement already satisfied: huggingface-hub<1.0,>=0.34.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.36.0)
Requirement already satisfied: numpy>=1.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2.4.0)
Requirement already satisfied: packaging>=20.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (25.0)
Requirement already satisfied: pyyaml>=5.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (6.0.3)
Requirement already satisfied: regex!=2019.12.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2025.11.3)
Requirement already satisfied: requests in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (2.32.5)
Requirement already satisfied: tokenizers<=0.23.0,>=0.22.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.22.1)
Requirement already satisfied: safetensors>=0.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (0.7.0)
Requirement already satisfied: tqdm>=4.27 in /usr/local/python3.11.13/lib/python3.11/site-packages (from transformers==4.57.1) (4.67.1)
Requirement already satisfied: fsspec>=2023.5.0 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (2025.10.0)
Requirement already satisfied: typing-extensions>=3.7.4.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (4.15.0)
Requirement already satisfied: hf-xet<2.0.0,>=1.1.3 in /usr/local/python3.11.13/lib/python3.11/site-packages (from huggingface-hub<1.0,>=0.34.0->transformers==4.57.1) (1.2.0)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (3.11)
Requirement already satisfied: urllib3<3,>=1.21.1 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (2.3.0)
Requirement already satisfied: certifi>=2017.4.17 in /usr/local/python3.11.13/lib/python3.11/site-packages (from requests->transformers==4.57.1) (2025.11.12)
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0100  732k  100  732k    0     0  1598k      0 --:--:-- --:--:-- --:--:-- 1598k
performance
vm.swappiness = 0
kernel.numa_balancing = 0
kernel.sched_migration_cost_ns = 50000
Running test case test/nightly/ascend/performance/test_ascend_deepseek_r1_w8a8_2p1d_32p_in3k5_out1k_20ms.py
The nic name matched is enp23s0f3
The nic name matched is enp23s0f3
Nic name: enp23s0f3
Init 192.168.0.234 cls.role=None!
[CI Test Method] Test_DeepSeek_R1_W8A8_2P1D_In3500_Out1024.test_throughput
launch_node start ......
query_configmap successfully!
monitor configmap.data={'sglang-multi-debug-sglang-decode-0': '192.168.0.60', 'sglang-multi-debug-sglang-decode-1': '192.168.0.102', 'sglang-multi-debug-sglang-prefill-0': '192.168.0.234', 'sglang-multi-debug-sglang-prefill-1': '192.168.0.184', 'sglang-multi-debug-sglang-router-0': '192.168.0.184'}
launch_node mf_addr='tcp://192.168.0.234:24666'
ENV_VAR SGLANG_SET_CPU_AFFINITY=1
ENV_VAR PYTORCH_NPU_ALLOC_CONF=expandable_segments:True
ENV_VAR STREAMS_PER_DEVICE=32
ENV_VAR SGLANG_NPU_USE_MLAPO=1
ENV_VAR SGLANG_USE_FIA_NZ=1
ENV_VAR HCCL_BUFFSIZE=1536
ENV_VAR DEEP_NORMAL_MODE_USE_INT8_QUANT=1
ENV_VAR TASK_QUEUE_ENABLE=2
ENV_VAR HCCL_SOCKET_IFNAME=enp23s0f3
ENV_VAR GLOO_SOCKET_IFNAME=enp23s0f3
query_configmap successfully!
sglang-multi-debug-sglang-prefill-0 get hot map in /data/.cache/hot_map/aisbench_hot_map_p0.pt
Starting node, node_ip='192.168.0.234' service_args=['--trust-remote-code', '--attention-backend', 'ascend', '--device', 'npu', '--disaggregation-transfer-backend', 'ascend', '--nnodes', '1', '--node-rank', '0', '--disaggregation-mode', 'prefill', '--tp-size', 16, '--mem-fraction-static', 0.81, '--quantization', 'modelslim', '--max-running-requests', 4, '--context-length', 8192, '--disable-radix-cache', '--chunked-prefill-size', -1, '--max-prefill-tokens', 28680, '--moe-a2a-backend', 'deepep', '--deepep-mode', 'normal', '--speculative-algorithm', 'NEXTN', '--speculative-num-steps', 1, '--speculative-eagle-topk', 1, '--speculative-num-draft-tokens', 2, '--dp-size', 2, '--enable-dp-attention', '--disable-shared-experts-fusion', '--dtype', 'bfloat16', '--enable-attn-tp-input-scattered', '--dist-init-addr', '192.168.0.234:5000', '--disaggregation-bootstrap-port', 8995]
command=python3 -m sglang.launch_server --model-path /root/.cache/modelscope/hub/models/Howeee/DeepSeek-R1-0528-w8a8 --trust-remote-code --attention-backend ascend --device npu --disaggregation-transfer-backend ascend --nnodes 1 --node-rank 0 --disaggregation-mode prefill --tp-size 16 --mem-fraction-static 0.81 --quantization modelslim --max-running-requests 4 --context-length 8192 --disable-radix-cache --chunked-prefill-size -1 --max-prefill-tokens 28680 --moe-a2a-backend deepep --deepep-mode normal --speculative-algorithm NEXTN --speculative-num-steps 1 --speculative-eagle-topk 1 --speculative-num-draft-tokens 2 --dp-size 2 --enable-dp-attention --disable-shared-experts-fusion --dtype bfloat16 --enable-attn-tp-input-scattered --dist-init-addr 192.168.0.234:5000 --disaggregation-bootstrap-port 8995 --device npu --host 192.168.0.234 --port 8000
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-25 13:03:31] WARNING model_config.py:813: modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:31] WARNING server_args.py:1771: DP attention is enabled. The chunked prefill size is adjusted to -1 to avoid MoE kernel issues. 
[2025-12-25 13:03:31] WARNING server_args.py:1821: Cuda graph is disabled because deepep_mode=`normal`
[2025-12-25 13:03:31] WARNING server_args.py:1824: DeepEP MoE is enabled. The expert parallel size is adjusted to be the same as the tensor parallel size[16].
[2025-12-25 13:03:31] WARNING server_args.py:1972: Overlap scheduler is disabled because of using eagle3 or standalone speculative decoding.You can set env SGLANG_ENABLE_SPEC_V2=True to enable the experimental overlap scheduler.
[2025-12-25 13:03:31] WARNING server_args.py:2159: Cuda graph is disabled for prefill server when piecewise cuda graph is not enabled.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:31] server_args=ServerArgs(model_path='/root/.cache/modelscope/hub/models/Howeee/DeepSeek-R1-0528-w8a8', tokenizer_path='/root/.cache/modelscope/hub/models/Howeee/DeepSeek-R1-0528-w8a8', tokenizer_mode='auto', tokenizer_worker_num=1, skip_tokenizer_init=False, load_format='auto', model_loader_extra_config='{}', trust_remote_code=True, context_length=8192, is_embedding=False, enable_multimodal=None, limit_mm_data_per_request=None, revision=None, model_impl='auto', host='192.168.0.234', port=8000, fastapi_root_path='', grpc_mode=False, skip_server_warmup=False, warmups=None, nccl_port=None, checkpoint_engine_wait_weights_before_ready=False, dtype='bfloat16', quantization='modelslim', quantization_param_path=None, kv_cache_dtype='auto', enable_fp32_lm_head=False, modelopt_quant=None, modelopt_checkpoint_restore_path=None, modelopt_checkpoint_save_path=None, modelopt_export_path=None, quantize_and_serve=False, rl_quant_profile=None, mem_fraction_static=0.81, max_running_requests=4, max_queued_requests=None, max_total_tokens=None, chunked_prefill_size=-1, enable_dynamic_chunking=False, max_prefill_tokens=28680, prefill_max_requests=None, schedule_policy='fcfs', enable_priority_scheduling=False, abort_on_priority_when_disabled=False, schedule_low_priority_values_first=False, priority_scheduling_preemption_threshold=10, schedule_conservativeness=0.3, page_size=128, hybrid_kvcache_ratio=None, swa_full_tokens_ratio=0.8, disable_hybrid_swa_memory=False, radix_eviction_policy='lru', device='npu', tp_size=16, pp_size=1, pp_max_micro_batch_size=None, pp_async_batch_depth=0, stream_interval=1, stream_output=False, random_seed=485650030, constrained_json_whitespace_pattern=None, constrained_json_disable_any_whitespace=False, watchdog_timeout=300, soft_watchdog_timeout=None, dist_timeout=None, download_dir=None, base_gpu_id=0, gpu_id_step=1, sleep_on_idle=False, custom_sigquit_handler=None, log_level='info', log_level_http=None, log_requests=False, log_requests_level=2, crash_dump_folder=None, show_time_cost=False, enable_metrics=False, enable_metrics_for_all_schedulers=False, tokenizer_metrics_custom_labels_header='x-custom-labels', tokenizer_metrics_allowed_custom_labels=None, bucket_time_to_first_token=None, bucket_inter_token_latency=None, bucket_e2e_request_latency=None, collect_tokens_histogram=False, prompt_tokens_buckets=None, generation_tokens_buckets=None, gc_warning_threshold_secs=0.0, decode_log_interval=40, enable_request_time_stats_logging=False, kv_events_config=None, enable_trace=False, otlp_traces_endpoint='localhost:4317', export_metrics_to_file=False, export_metrics_to_file_dir=None, api_key=None, served_model_name='/root/.cache/modelscope/hub/models/Howeee/DeepSeek-R1-0528-w8a8', weight_version='default', chat_template=None, completion_template=None, file_storage_path='sglang_storage', enable_cache_report=False, reasoning_parser=None, tool_call_parser=None, tool_server=None, sampling_defaults='model', dp_size=2, load_balance_method='round_robin', load_watch_interval=0.1, prefill_round_robin_balance=False, dist_init_addr='192.168.0.234:5000', nnodes=1, node_rank=0, json_model_override_args='{}', preferred_sampling_params=None, enable_lora=None, max_lora_rank=None, lora_target_modules=None, lora_paths=None, max_loaded_loras=None, max_loras_per_batch=8, lora_eviction_policy='lru', lora_backend='csgmv', max_lora_chunk_size=16, attention_backend='ascend', decode_attention_backend='ascend', prefill_attention_backend='ascend', sampling_backend='pytorch', grammar_backend='xgrammar', mm_attention_backend=None, fp8_gemm_runner_backend='auto', nsa_prefill_backend='flashmla_sparse', nsa_decode_backend='fa3', disable_flashinfer_autotune=False, speculative_algorithm='EAGLE', speculative_draft_model_path='/root/.cache/modelscope/hub/models/Howeee/DeepSeek-R1-0528-w8a8', speculative_draft_model_revision=None, speculative_draft_load_format=None, speculative_num_steps=1, speculative_eagle_topk=1, speculative_num_draft_tokens=2, speculative_accept_threshold_single=1.0, speculative_accept_threshold_acc=1.0, speculative_token_map=None, speculative_attention_mode='prefill', speculative_draft_attention_backend=None, speculative_moe_runner_backend='auto', speculative_moe_a2a_backend=None, speculative_draft_model_quantization='modelslim', speculative_ngram_min_match_window_size=1, speculative_ngram_max_match_window_size=12, speculative_ngram_min_bfs_breadth=1, speculative_ngram_max_bfs_breadth=10, speculative_ngram_match_type='BFS', speculative_ngram_branch_length=18, speculative_ngram_capacity=10000000, enable_mtp=False, ep_size=16, moe_a2a_backend='deepep', moe_runner_backend='auto', flashinfer_mxfp4_moe_precision='default', enable_flashinfer_allreduce_fusion=False, deepep_mode='normal', ep_num_redundant_experts=0, ep_dispatch_algorithm=None, init_expert_location='trivial', enable_eplb=False, enable_async_eplb=False, eplb_algorithm='auto', eplb_rebalance_num_iterations=1000, eplb_rebalance_layers_per_chunk=None, eplb_min_rebalancing_utilization_threshold=1.0, expert_distribution_recorder_mode=None, expert_distribution_recorder_buffer_size=1000, enable_expert_distribution_metrics=False, deepep_config=None, moe_dense_tp_size=None, elastic_ep_backend=None, mooncake_ib_device=None, max_mamba_cache_size=None, mamba_ssm_dtype='float32', mamba_full_memory_ratio=0.9, mamba_scheduler_strategy='no_buffer', mamba_track_interval=256, enable_hierarchical_cache=False, hicache_ratio=2.0, hicache_size=0, hicache_write_policy='write_through', hicache_io_backend='kernel', hicache_mem_layout='layer_first', hicache_storage_backend=None, hicache_storage_prefetch_policy='best_effort', hicache_storage_backend_extra_config=None, enable_lmcache=False, kt_weight_path=None, kt_method='AMXINT4', kt_cpuinfer=None, kt_threadpool_count=2, kt_num_gpu_experts=None, kt_max_deferred_experts_per_token=None, dllm_algorithm=None, dllm_algorithm_config=None, enable_double_sparsity=False, ds_channel_config_path=None, ds_heavy_channel_num=32, ds_heavy_token_num=256, ds_heavy_channel_type='qk', ds_sparse_decode_threshold=4096, cpu_offload_gb=0, offload_group_size=-1, offload_num_in_group=1, offload_prefetch_step=1, offload_mode='cpu', multi_item_scoring_delimiter=None, disable_radix_cache=True, cuda_graph_max_bs=256, cuda_graph_bs=[1, 2, 3, 4, 5, 6, 7, 8, 10, 12, 14, 16, 18, 20, 22, 24, 26, 28, 30, 32, 40, 44, 48, 52, 56, 60, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256], disable_cuda_graph=True, disable_cuda_graph_padding=False, enable_profile_cuda_graph=False, enable_cudagraph_gc=False, enable_layerwise_nvtx_marker=False, enable_nccl_nvls=False, enable_symm_mem=False, disable_flashinfer_cutlass_moe_fp4_allgather=False, enable_tokenizer_batch_encode=False, disable_tokenizer_batch_decode=False, disable_outlines_disk_cache=False, disable_custom_all_reduce=True, enable_mscclpp=False, enable_torch_symm_mem=False, disable_overlap_schedule=True, enable_mixed_chunk=False, enable_dp_attention=True, enable_dp_lm_head=False, enable_two_batch_overlap=False, enable_single_batch_overlap=False, tbo_token_distribution_threshold=0.48, enable_torch_compile=False, enable_piecewise_cuda_graph=False, enable_torch_compile_debug_mode=False, torch_compile_max_bs=32, piecewise_cuda_graph_max_tokens=4096, piecewise_cuda_graph_tokens=[4, 8, 12, 16, 20, 24, 28, 32, 48, 64, 80, 96, 112, 128, 144, 160, 176, 192, 208, 224, 240, 256, 288, 320, 352, 384, 416, 448, 480, 512, 640, 768, 896, 1024, 1152, 1280, 1408, 1536, 1664, 1792, 1920, 2048, 2176, 2304, 2432, 2560, 2688, 2816, 2944, 3072, 3200, 3328, 3456, 3584, 3712, 3840, 3968, 4096], piecewise_cuda_graph_compiler='eager', torchao_config='', enable_nan_detection=False, enable_p2p_check=False, triton_attention_reduce_in_fp32=False, triton_attention_num_kv_splits=8, triton_attention_split_tile_size=None, num_continuous_decode_steps=1, delete_ckpt_after_loading=False, enable_memory_saver=False, enable_weights_cpu_backup=False, enable_draft_weights_cpu_backup=False, allow_auto_truncate=False, enable_custom_logit_processor=False, flashinfer_mla_disable_ragged=False, disable_shared_experts_fusion=True, disable_chunked_prefix_cache=False, disable_fast_image_processor=False, keep_mm_feature_on_device=False, enable_return_hidden_states=False, enable_return_routed_experts=False, scheduler_recv_interval=1, numa_node=None, enable_deterministic_inference=False, rl_on_policy_target=None, enable_attn_tp_input_scattered=True, enable_nsa_prefill_context_parallel=False, enable_fused_qk_norm_rope=False, enable_dynamic_batch_tokenizer=False, dynamic_batch_tokenizer_batch_size=32, dynamic_batch_tokenizer_batch_timeout=0.002, debug_tensor_dump_output_folder=None, debug_tensor_dump_layers=None, debug_tensor_dump_input_file=None, debug_tensor_dump_inject=False, disaggregation_mode='prefill', disaggregation_transfer_backend='ascend', disaggregation_bootstrap_port=8995, disaggregation_decode_tp=16, disaggregation_decode_dp=2, disaggregation_prefill_pp=1, disaggregation_ib_device=None, disaggregation_decode_enable_offload_kvcache=False, num_reserved_decode_tokens=512, disaggregation_decode_polling_interval=1, encoder_only=False, language_only=False, encoder_transfer_backend='zmq_to_scheduler', encoder_urls=[], custom_weight_loader=[], weight_loader_disable_mmap=False, remote_instance_weight_loader_seed_instance_ip=None, remote_instance_weight_loader_seed_instance_service_port=None, remote_instance_weight_loader_send_weights_group_ports=None, remote_instance_weight_loader_backend='nccl', remote_instance_weight_loader_start_seed_via_transfer_engine=False, enable_pdmux=False, pdmux_config_path=None, sm_group_num=8, mm_max_concurrent_calls=32, mm_per_request_timeout=10.0, enable_broadcast_mm_inputs_process=False, enable_prefix_mm_cache=False, mm_enable_dp_encoder=False, mm_process_config={}, decrypted_config_file=None, decrypted_draft_config_file=None, forward_hooks=None)
[2025-12-25 13:03:31] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:32] Using default HuggingFace chat template with detected content format: string
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
[2025-12-25 13:03:48 DP0 TP1 EP1] Process 1738 gpu_id 1 is running on CPUs: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:48 DP0 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
[2025-12-25 13:03:49 DP1 TP9 EP9] Process 2250 gpu_id 9 is running on CPUs: [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
[2025-12-25 13:03:49 DP1 TP9 EP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-25 13:03:49 DP0 TP0 EP0] Process 1737 gpu_id 0 is running on CPUs: [0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[2025-12-25 13:03:49 DP0 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP0 TP6 EP6] Process 1743 gpu_id 6 is running on CPUs: [120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
[2025-12-25 13:03:49 DP1 TP14 EP14] Process 2258 gpu_id 14 is running on CPUs: [280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299]
[2025-12-25 13:03:49 DP0 TP6 EP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:49 DP1 TP14 EP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-25 13:03:49 DP0 TP3 EP3] Process 1740 gpu_id 3 is running on CPUs: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
[2025-12-25 13:03:49 DP0 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP1 TP12 EP12] Process 2256 gpu_id 12 is running on CPUs: [240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259]
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP1 TP12 EP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP1 TP11 EP11] Process 2255 gpu_id 11 is running on CPUs: [220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP1 TP11 EP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP0 TP7 EP7] Process 1744 gpu_id 7 is running on CPUs: [140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2025-12-25 13:03:49 DP0 TP5 EP5] Process 1742 gpu_id 5 is running on CPUs: [100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
[2025-12-25 13:03:49 DP0 TP7 EP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:49 DP0 TP5 EP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP0 TP4 EP4] Process 1741 gpu_id 4 is running on CPUs: [80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP0 TP4 EP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:49 DP0 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:49 DP0 TP1 EP1] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 13:03:49 DP1 TP10 EP10] Process 2251 gpu_id 10 is running on CPUs: [200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219]
[2025-12-25 13:03:49 DP1 TP9 EP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:49 DP1 TP9 EP9] Init torch distributed begin.
[2025-12-25 13:03:49 DP0 TP2 EP2] Process 1739 gpu_id 2 is running on CPUs: [40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
[2025-12-25 13:03:49 DP1 TP15 EP15] Process 2259 gpu_id 15 is running on CPUs: [300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319]
[2025-12-25 13:03:49 DP1 TP10 EP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP0 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:49 DP1 TP15 EP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:49 DP1 TP8 EP8] Process 2068 gpu_id 8 is running on CPUs: [160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
[2025-12-25 13:03:49 DP1 TP8 EP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:50 DP1 TP13 EP13] Process 2257 gpu_id 13 is running on CPUs: [260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279]
[2025-12-25 13:03:50 DP1 TP13 EP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 13:03:50 DP0 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP0 TP0 EP0] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 13:03:50 DP1 TP14 EP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP1 TP14 EP14] Init torch distributed begin.
[2025-12-25 13:03:50 DP0 TP6 EP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP0 TP6 EP6] Init torch distributed begin.
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2025-12-25 13:03:50 DP1 TP12 EP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP1 TP12 EP12] Init torch distributed begin.
[2025-12-25 13:03:50 DP0 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP0 TP3 EP3] Init torch distributed begin.
[2025-12-25 13:03:50 DP1 TP11 EP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP1 TP11 EP11] Init torch distributed begin.
[2025-12-25 13:03:50 DP0 TP5 EP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP0 TP5 EP5] Init torch distributed begin.
[2025-12-25 13:03:50 DP0 TP7 EP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP0 TP7 EP7] Init torch distributed begin.
[2025-12-25 13:03:50 DP0 TP4 EP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP0 TP4 EP4] Init torch distributed begin.
[2025-12-25 13:03:50 DP1 TP15 EP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP0 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP1 TP15 EP15] Init torch distributed begin.
[2025-12-25 13:03:50 DP0 TP2 EP2] Init torch distributed begin.
[2025-12-25 13:03:50 DP1 TP10 EP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP1 TP10 EP10] Init torch distributed begin.
[2025-12-25 13:03:50 DP1 TP8 EP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP1 TP8 EP8] Init torch distributed begin.
[2025-12-25 13:03:50 DP1 TP13 EP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:03:50 DP1 TP13 EP13] Init torch distributed begin.
[Gloo] Rank 0 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 11 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 8 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 13 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 7 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 5 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 2 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 3 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 1 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 4 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 6 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 9 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 10 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 14 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 12 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 15 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 3 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 1 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 11 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 2 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 8 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 6 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 7 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 12 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 10 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 4 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 5 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 9 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 13 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 15 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 14 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 1 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 4 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 0 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 0 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 1 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 2 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 4 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 3 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 6 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 6 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 5 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 5 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 7 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 2 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 3 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[Gloo] Rank 7 is connected to 7 peer ranks. Expected number of connected peer ranks is : 7
[2025-12-25 13:03:52 DP0 TP0 EP0] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP1 TP14 EP14] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP1 TP15 EP15] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP1 TP13 EP13] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP1 TP12 EP12] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP1 TP11 EP11] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP1 TP10 EP10] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP1 TP9 EP9] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP1 TP8 EP8] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP0 TP6 EP6] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP0 TP7 EP7] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP0 TP1 EP1] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP0 TP5 EP5] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP0 TP4 EP4] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP0 TP3 EP3] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:03:52 DP0 TP2 EP2] Init torch distributed ends. mem usage=0.00 GB
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:53 DP1 TP12 EP12] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP1 TP8 EP8] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP0 TP2 EP2] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP1 TP11 EP11] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP1 TP9 EP9] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP1 TP14 EP14] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP1 TP15 EP15] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP0 TP1 EP1] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP0 TP7 EP7] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP0 TP6 EP6] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP1 TP10 EP10] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP0 TP5 EP5] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP0 TP4 EP4] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP0 TP3 EP3] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP1 TP13 EP13] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2025-12-25 13:03:53 DP1 TP8 EP8] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP1 TP14 EP14] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP0 TP6 EP6] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP0 TP1 EP1] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP1 TP11 EP11] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP0 TP7 EP7] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP0 TP4 EP4] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP1 TP15 EP15] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP1 TP9 EP9] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP0 TP5 EP5] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP1 TP10 EP10] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP1 TP12 EP12] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP1 TP13 EP13] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP0 TP2 EP2] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2025-12-25 13:03:53 DP0 TP3 EP3] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
/usr/local/python3.11.13/lib/python3.11/site-packages/torch_npu/dynamo/torchair/configs/compiler_config.py:106: UserWarning: The following torchair config or properties may not take effect or report error in max-autotune mode: config.debug.aclgraph.clone_input:True
  warnings.warn(
[2025-12-25 13:03:54 DP1 TP12 EP12] Load weight begin. avail mem=60.85 GB
[2025-12-25 13:03:54 DP1 TP13 EP13] Load weight begin. avail mem=61.08 GB
[2025-12-25 13:03:54 DP1 TP14 EP14] Load weight begin. avail mem=60.85 GB
[2025-12-25 13:03:54 DP1 TP15 EP15] Load weight begin. avail mem=61.08 GB
[2025-12-25 13:03:54 DP0 TP2 EP2] Load weight begin. avail mem=60.85 GB
[2025-12-25 13:03:54 DP0 TP4 EP4] Load weight begin. avail mem=60.85 GB
[2025-12-25 13:03:54 DP0 TP6 EP6] Load weight begin. avail mem=60.85 GB
[2025-12-25 13:03:54 DP1 TP8 EP8] Load weight begin. avail mem=60.85 GB
[2025-12-25 13:03:54 DP0 TP1 EP1] Load weight begin. avail mem=61.08 GB
[2025-12-25 13:03:54 DP0 TP5 EP5] Load weight begin. avail mem=61.08 GB
[2025-12-25 13:03:54 DP1 TP11 EP11] Load weight begin. avail mem=61.08 GB
[2025-12-25 13:03:54 DP0 TP0 EP0] Load weight begin. avail mem=60.77 GB
[2025-12-25 13:03:54 DP1 TP9 EP9] Load weight begin. avail mem=61.08 GB
[2025-12-25 13:03:54 DP0 TP3 EP3] Load weight begin. avail mem=61.08 GB
[2025-12-25 13:03:54 DP0 TP7 EP7] Load weight begin. avail mem=61.08 GB
[2025-12-25 13:03:54 DP1 TP10 EP10] Load weight begin. avail mem=60.86 GB
[2025-12-25 13:03:59 DP1 TP12 EP12] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP0 TP2 EP2] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP1 TP14 EP14] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP1 TP11 EP11] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP1 TP15 EP15] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP0 TP4 EP4] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP0 TP6 EP6] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP1 TP8 EP8] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP0 TP1 EP1] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP1 TP9 EP9] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP0 TP5 EP5] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP0 TP7 EP7] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP0 TP0 EP0] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP1 TP10 EP10] attn_tp_input_scattered is not enabled while other conditions are not met
Loading safetensors checkpoint shards:   0% Completed | 0/162 [00:00<?, ?it/s]
[2025-12-25 13:04:00 DP0 TP3 EP3] attn_tp_input_scattered is not enabled while other conditions are not met
[2025-12-25 13:04:00 DP1 TP13 EP13] attn_tp_input_scattered is not enabled while other conditions are not met
Loading safetensors checkpoint shards:   1% Completed | 1/162 [00:01<05:18,  1.98s/it]
Loading safetensors checkpoint shards:   1% Completed | 2/162 [00:04<05:30,  2.07s/it]
Loading safetensors checkpoint shards:   2% Completed | 3/162 [00:06<05:34,  2.10s/it]
Loading safetensors checkpoint shards:   2% Completed | 4/162 [00:08<05:31,  2.10s/it]
Loading safetensors checkpoint shards:   3% Completed | 5/162 [00:10<05:30,  2.11s/it]
Loading safetensors checkpoint shards:   4% Completed | 6/162 [00:12<05:28,  2.10s/it]
Loading safetensors checkpoint shards:   4% Completed | 7/162 [00:14<05:21,  2.07s/it]
Loading safetensors checkpoint shards:   5% Completed | 8/162 [00:16<05:18,  2.07s/it]
Loading safetensors checkpoint shards:   6% Completed | 9/162 [00:18<05:19,  2.09s/it]
Loading safetensors checkpoint shards:   6% Completed | 10/162 [00:21<05:28,  2.16s/it]
Loading safetensors checkpoint shards:   7% Completed | 11/162 [00:23<05:22,  2.13s/it]
Loading safetensors checkpoint shards:   7% Completed | 12/162 [00:25<05:12,  2.08s/it]
Loading safetensors checkpoint shards:   8% Completed | 13/162 [00:27<05:13,  2.11s/it]
Loading safetensors checkpoint shards:   9% Completed | 14/162 [00:29<05:10,  2.10s/it]
Loading safetensors checkpoint shards:   9% Completed | 15/162 [00:31<05:17,  2.16s/it]
Loading safetensors checkpoint shards:  10% Completed | 16/162 [00:33<05:09,  2.12s/it]
Loading safetensors checkpoint shards:  10% Completed | 17/162 [00:35<05:10,  2.14s/it]
Loading safetensors checkpoint shards:  11% Completed | 18/162 [00:37<05:04,  2.12s/it]
Loading safetensors checkpoint shards:  12% Completed | 19/162 [00:39<04:59,  2.09s/it]
Loading safetensors checkpoint shards:  12% Completed | 20/162 [00:42<05:19,  2.25s/it]
Loading safetensors checkpoint shards:  13% Completed | 21/162 [00:44<05:06,  2.17s/it]
Loading safetensors checkpoint shards:  14% Completed | 22/162 [00:46<05:10,  2.22s/it]
Loading safetensors checkpoint shards:  14% Completed | 23/162 [00:49<05:12,  2.24s/it]
Loading safetensors checkpoint shards:  15% Completed | 24/162 [00:51<05:02,  2.20s/it]
Loading safetensors checkpoint shards:  15% Completed | 25/162 [00:53<04:57,  2.17s/it]
Loading safetensors checkpoint shards:  16% Completed | 26/162 [00:55<04:50,  2.14s/it]
Loading safetensors checkpoint shards:  17% Completed | 27/162 [00:57<04:45,  2.11s/it]
Loading safetensors checkpoint shards:  17% Completed | 28/162 [00:59<04:42,  2.11s/it]
Loading safetensors checkpoint shards:  18% Completed | 29/162 [01:01<04:37,  2.09s/it]
Loading safetensors checkpoint shards:  19% Completed | 30/162 [01:03<04:38,  2.11s/it]
Loading safetensors checkpoint shards:  19% Completed | 31/162 [01:05<04:33,  2.09s/it]
Loading safetensors checkpoint shards:  20% Completed | 32/162 [01:07<04:13,  1.95s/it]
Loading safetensors checkpoint shards:  20% Completed | 33/162 [01:09<04:16,  1.99s/it]
Loading safetensors checkpoint shards:  22% Completed | 35/162 [01:11<03:21,  1.59s/it]
Loading safetensors checkpoint shards:  22% Completed | 36/162 [01:14<03:41,  1.75s/it]
Loading safetensors checkpoint shards:  23% Completed | 37/162 [01:16<03:49,  1.84s/it]
Loading safetensors checkpoint shards:  23% Completed | 38/162 [01:18<03:59,  1.93s/it]
Loading safetensors checkpoint shards:  24% Completed | 39/162 [01:20<04:06,  2.01s/it]
Loading safetensors checkpoint shards:  25% Completed | 40/162 [01:24<05:29,  2.70s/it]
Loading safetensors checkpoint shards:  25% Completed | 41/162 [01:27<05:06,  2.53s/it]
Loading safetensors checkpoint shards:  26% Completed | 42/162 [01:29<04:49,  2.41s/it]
Loading safetensors checkpoint shards:  27% Completed | 43/162 [01:31<04:34,  2.31s/it]
Loading safetensors checkpoint shards:  27% Completed | 44/162 [01:33<04:40,  2.37s/it]
Loading safetensors checkpoint shards:  28% Completed | 45/162 [01:34<03:49,  1.96s/it]
Loading safetensors checkpoint shards:  28% Completed | 46/162 [01:36<03:48,  1.97s/it]
Loading safetensors checkpoint shards:  29% Completed | 47/162 [01:38<03:48,  1.99s/it]
Loading safetensors checkpoint shards:  30% Completed | 48/162 [01:40<03:52,  2.04s/it]
Loading safetensors checkpoint shards:  30% Completed | 49/162 [01:43<03:51,  2.05s/it]
Loading safetensors checkpoint shards:  31% Completed | 50/162 [01:45<03:51,  2.07s/it]
Loading safetensors checkpoint shards:  31% Completed | 51/162 [01:47<04:01,  2.17s/it]
Loading safetensors checkpoint shards:  32% Completed | 52/162 [01:49<03:52,  2.12s/it]
Loading safetensors checkpoint shards:  33% Completed | 53/162 [01:51<03:57,  2.18s/it]
Loading safetensors checkpoint shards:  33% Completed | 54/162 [01:54<03:58,  2.21s/it]
Loading safetensors checkpoint shards:  34% Completed | 55/162 [01:56<03:57,  2.22s/it]
Loading safetensors checkpoint shards:  35% Completed | 56/162 [01:58<03:47,  2.15s/it]
Loading safetensors checkpoint shards:  35% Completed | 57/162 [02:00<03:42,  2.12s/it]
Loading safetensors checkpoint shards:  36% Completed | 58/162 [02:02<03:42,  2.14s/it]
Loading safetensors checkpoint shards:  36% Completed | 59/162 [02:04<03:46,  2.20s/it]
Loading safetensors checkpoint shards:  37% Completed | 60/162 [02:06<03:39,  2.15s/it]
Loading safetensors checkpoint shards:  38% Completed | 61/162 [02:09<03:35,  2.13s/it]
Loading safetensors checkpoint shards:  38% Completed | 62/162 [02:11<03:32,  2.12s/it]
Loading safetensors checkpoint shards:  39% Completed | 63/162 [02:13<03:27,  2.10s/it]
Loading safetensors checkpoint shards:  40% Completed | 64/162 [02:15<03:26,  2.11s/it]
Loading safetensors checkpoint shards:  40% Completed | 65/162 [02:17<03:24,  2.10s/it]
Loading safetensors checkpoint shards:  41% Completed | 66/162 [02:18<02:49,  1.76s/it]
Loading safetensors checkpoint shards:  41% Completed | 67/162 [02:20<02:56,  1.86s/it]
Loading safetensors checkpoint shards:  42% Completed | 68/162 [02:22<03:01,  1.94s/it]
Loading safetensors checkpoint shards:  43% Completed | 69/162 [02:25<03:22,  2.18s/it]
Loading safetensors checkpoint shards:  43% Completed | 70/162 [02:27<03:25,  2.24s/it]
Loading safetensors checkpoint shards:  44% Completed | 71/162 [02:29<03:23,  2.24s/it]
Loading safetensors checkpoint shards:  44% Completed | 72/162 [02:32<03:19,  2.21s/it]
Loading safetensors checkpoint shards:  45% Completed | 73/162 [02:34<03:15,  2.20s/it]
Loading safetensors checkpoint shards:  46% Completed | 74/162 [02:36<03:16,  2.24s/it]
Loading safetensors checkpoint shards:  46% Completed | 75/162 [02:38<03:11,  2.20s/it]
Loading safetensors checkpoint shards:  47% Completed | 76/162 [02:40<03:07,  2.18s/it]
Loading safetensors checkpoint shards:  48% Completed | 77/162 [02:43<03:12,  2.26s/it]
Loading safetensors checkpoint shards:  48% Completed | 78/162 [02:45<03:06,  2.22s/it]
Loading safetensors checkpoint shards:  49% Completed | 79/162 [02:47<03:05,  2.23s/it]
Loading safetensors checkpoint shards:  49% Completed | 80/162 [02:49<03:04,  2.24s/it]
Loading safetensors checkpoint shards:  50% Completed | 81/162 [02:52<02:57,  2.19s/it]
Loading safetensors checkpoint shards:  51% Completed | 82/162 [02:54<02:57,  2.22s/it]
Loading safetensors checkpoint shards:  51% Completed | 83/162 [02:56<02:57,  2.24s/it]
Loading safetensors checkpoint shards:  52% Completed | 84/162 [02:58<02:53,  2.22s/it]
Loading safetensors checkpoint shards:  52% Completed | 85/162 [03:01<02:53,  2.25s/it]
Loading safetensors checkpoint shards:  53% Completed | 86/162 [03:03<02:45,  2.18s/it]
Loading safetensors checkpoint shards:  54% Completed | 87/162 [03:05<02:50,  2.28s/it]
Loading safetensors checkpoint shards:  54% Completed | 88/162 [03:07<02:42,  2.19s/it]
Loading safetensors checkpoint shards:  55% Completed | 89/162 [03:09<02:42,  2.22s/it]
Loading safetensors checkpoint shards:  56% Completed | 90/162 [03:11<02:35,  2.16s/it]
Loading safetensors checkpoint shards:  56% Completed | 91/162 [03:14<02:31,  2.13s/it]
Loading safetensors checkpoint shards:  57% Completed | 92/162 [03:16<02:28,  2.12s/it]
Loading safetensors checkpoint shards:  57% Completed | 93/162 [03:18<02:25,  2.11s/it]
Loading safetensors checkpoint shards:  58% Completed | 94/162 [03:20<02:22,  2.09s/it]
Loading safetensors checkpoint shards:  59% Completed | 95/162 [03:22<02:19,  2.08s/it]
Loading safetensors checkpoint shards:  59% Completed | 96/162 [03:24<02:17,  2.09s/it]
Loading safetensors checkpoint shards:  60% Completed | 97/162 [03:26<02:16,  2.10s/it]
Loading safetensors checkpoint shards:  60% Completed | 98/162 [03:28<02:12,  2.08s/it]
Loading safetensors checkpoint shards:  61% Completed | 99/162 [03:30<02:11,  2.09s/it]
Loading safetensors checkpoint shards:  62% Completed | 100/162 [03:32<02:10,  2.10s/it]
Loading safetensors checkpoint shards:  62% Completed | 101/162 [03:35<02:11,  2.16s/it]
Loading safetensors checkpoint shards:  63% Completed | 102/162 [03:37<02:07,  2.13s/it]
Loading safetensors checkpoint shards:  64% Completed | 103/162 [03:39<02:04,  2.11s/it]
Loading safetensors checkpoint shards:  64% Completed | 104/162 [03:41<02:02,  2.11s/it]
Loading safetensors checkpoint shards:  65% Completed | 105/162 [03:43<01:59,  2.10s/it]
Loading safetensors checkpoint shards:  65% Completed | 106/162 [03:45<01:57,  2.10s/it]
Loading safetensors checkpoint shards:  66% Completed | 107/162 [03:47<01:56,  2.11s/it]
Loading safetensors checkpoint shards:  67% Completed | 108/162 [03:49<01:52,  2.09s/it]
Loading safetensors checkpoint shards:  67% Completed | 109/162 [03:52<01:55,  2.18s/it]
Loading safetensors checkpoint shards:  68% Completed | 110/162 [03:54<01:51,  2.14s/it]
Loading safetensors checkpoint shards:  69% Completed | 111/162 [03:56<01:48,  2.12s/it]
Loading safetensors checkpoint shards:  69% Completed | 112/162 [03:58<01:45,  2.12s/it]
Loading safetensors checkpoint shards:  70% Completed | 113/162 [04:00<01:42,  2.10s/it]
Loading safetensors checkpoint shards:  70% Completed | 114/162 [04:02<01:40,  2.10s/it]
Loading safetensors checkpoint shards:  71% Completed | 115/162 [04:04<01:41,  2.17s/it]
Loading safetensors checkpoint shards:  72% Completed | 116/162 [04:06<01:38,  2.14s/it]
Loading safetensors checkpoint shards:  72% Completed | 117/162 [04:08<01:35,  2.12s/it]
Loading safetensors checkpoint shards:  73% Completed | 118/162 [04:11<01:33,  2.12s/it]
Loading safetensors checkpoint shards:  73% Completed | 119/162 [04:13<01:30,  2.11s/it]
Loading safetensors checkpoint shards:  74% Completed | 120/162 [04:15<01:31,  2.18s/it]
Loading safetensors checkpoint shards:  75% Completed | 121/162 [04:17<01:29,  2.17s/it]
Loading safetensors checkpoint shards:  75% Completed | 122/162 [04:19<01:25,  2.13s/it]
Loading safetensors checkpoint shards:  76% Completed | 123/162 [04:21<01:23,  2.15s/it]
Loading safetensors checkpoint shards:  77% Completed | 124/162 [04:23<01:20,  2.13s/it]
Loading safetensors checkpoint shards:  77% Completed | 125/162 [04:26<01:18,  2.11s/it]
Loading safetensors checkpoint shards:  78% Completed | 126/162 [04:28<01:16,  2.13s/it]
Loading safetensors checkpoint shards:  78% Completed | 127/162 [04:30<01:13,  2.10s/it]
Loading safetensors checkpoint shards:  79% Completed | 128/162 [04:32<01:11,  2.10s/it]
Loading safetensors checkpoint shards:  80% Completed | 129/162 [04:34<01:11,  2.18s/it]
Loading safetensors checkpoint shards:  80% Completed | 130/162 [04:36<01:10,  2.21s/it]
Loading safetensors checkpoint shards:  81% Completed | 131/162 [04:39<01:06,  2.16s/it]
Loading safetensors checkpoint shards:  81% Completed | 132/162 [04:41<01:09,  2.30s/it]
Loading safetensors checkpoint shards:  82% Completed | 133/162 [04:43<01:06,  2.29s/it]
Loading safetensors checkpoint shards:  83% Completed | 134/162 [04:45<01:02,  2.22s/it]
Loading safetensors checkpoint shards:  83% Completed | 135/162 [04:48<01:00,  2.24s/it]
Loading safetensors checkpoint shards:  84% Completed | 136/162 [04:50<00:56,  2.18s/it]
Loading safetensors checkpoint shards:  85% Completed | 137/162 [04:52<00:53,  2.14s/it]
Loading safetensors checkpoint shards:  85% Completed | 138/162 [04:54<00:50,  2.12s/it]
Loading safetensors checkpoint shards:  86% Completed | 139/162 [04:55<00:41,  1.79s/it]
Loading safetensors checkpoint shards:  86% Completed | 140/162 [04:57<00:40,  1.85s/it]
Loading safetensors checkpoint shards:  87% Completed | 141/162 [04:59<00:40,  1.93s/it]
Loading safetensors checkpoint shards:  88% Completed | 142/162 [05:01<00:39,  1.98s/it]
Loading safetensors checkpoint shards:  88% Completed | 143/162 [05:03<00:39,  2.07s/it]
Loading safetensors checkpoint shards:  89% Completed | 144/162 [05:06<00:38,  2.16s/it]
Loading safetensors checkpoint shards:  90% Completed | 145/162 [05:08<00:36,  2.14s/it]
Loading safetensors checkpoint shards:  90% Completed | 146/162 [05:10<00:34,  2.15s/it]
Loading safetensors checkpoint shards:  91% Completed | 147/162 [05:12<00:32,  2.15s/it]
Loading safetensors checkpoint shards:  91% Completed | 148/162 [05:14<00:29,  2.13s/it]
Loading safetensors checkpoint shards:  92% Completed | 149/162 [05:16<00:27,  2.11s/it]
Loading safetensors checkpoint shards:  93% Completed | 150/162 [05:18<00:25,  2.11s/it]
Loading safetensors checkpoint shards:  93% Completed | 151/162 [05:21<00:24,  2.19s/it]
Loading safetensors checkpoint shards:  94% Completed | 152/162 [05:23<00:21,  2.15s/it]
Loading safetensors checkpoint shards:  94% Completed | 153/162 [05:25<00:19,  2.15s/it]
Loading safetensors checkpoint shards:  95% Completed | 154/162 [05:27<00:17,  2.13s/it]
Loading safetensors checkpoint shards:  96% Completed | 155/162 [05:29<00:14,  2.11s/it]
Loading safetensors checkpoint shards:  96% Completed | 156/162 [05:31<00:12,  2.13s/it]
Loading safetensors checkpoint shards:  97% Completed | 157/162 [05:33<00:10,  2.10s/it]
Loading safetensors checkpoint shards:  98% Completed | 158/162 [05:36<00:08,  2.11s/it]
Loading safetensors checkpoint shards:  98% Completed | 159/162 [05:36<00:04,  1.51s/it]
Loading safetensors checkpoint shards:  99% Completed | 160/162 [05:38<00:03,  1.66s/it]
Loading safetensors checkpoint shards:  99% Completed | 161/162 [05:40<00:01,  1.92s/it]
Loading safetensors checkpoint shards: 100% Completed | 162/162 [05:42<00:00,  1.99s/it]
Loading safetensors checkpoint shards: 100% Completed | 162/162 [05:42<00:00,  2.12s/it]

[2025-12-25 13:10:28 DP0 TP7 EP7] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.77 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP1 TP15 EP15] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.77 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP0 TP2 EP2] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.53 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP1 TP11 EP11] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.76 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP1 TP12 EP12] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.53 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP1 TP8 EP8] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.53 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP0 TP4 EP4] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.53 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP1 TP9 EP9] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.77 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP1 TP13 EP13] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.77 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP0 TP5 EP5] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.77 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP0 TP3 EP3] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.77 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP0 TP6 EP6] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.53 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP1 TP14 EP14] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.53 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP0 TP1 EP1] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.77 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP0 TP0 EP0] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.46 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP1 TP10 EP10] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=14.54 GB, mem usage=46.32 GB.
[2025-12-25 13:10:28 DP0 TP0 EP0] Using KV cache dtype: torch.bfloat16
[2025-12-25 13:10:28 DP0 TP0 EP0] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP1 TP15 EP15] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP1 TP14 EP14] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP1 TP13 EP13] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP1 TP12 EP12] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP1 TP11 EP11] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP1 TP10 EP10] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP1 TP9 EP9] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP1 TP8 EP8] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP0 TP7 EP7] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP0 TP6 EP6] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP0 TP5 EP5] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP0 TP4 EP4] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP0 TP3 EP3] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP0 TP2 EP2] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP0 TP1 EP1] The available memory for KV cache is 2.90 GB.
[2025-12-25 13:10:28 DP0 TP1 EP1] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP1 TP12 EP12] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP1 TP11 EP11] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP0 TP7 EP7] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP1 TP8 EP8] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP0 TP3 EP3] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP1 TP10 EP10] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP0 TP6 EP6] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP0 TP0 EP0] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP1 TP15 EP15] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP1 TP14 EP14] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP0 TP2 EP2] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP0 TP4 EP4] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP1 TP9 EP9] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP0 TP5 EP5] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP1 TP13 EP13] KV Cache is allocated. #tokens: 44416, KV size: 2.92 GB
[2025-12-25 13:10:28 DP1 TP14 EP14] Memory pool end. avail mem=11.60 GB
[2025-12-25 13:10:28 DP0 TP6 EP6] Memory pool end. avail mem=11.60 GB
[2025-12-25 13:10:28 DP1 TP10 EP10] Memory pool end. avail mem=11.61 GB
[2025-12-25 13:10:28 DP0 TP0 EP0] Memory pool end. avail mem=11.53 GB
[2025-12-25 13:10:28 DP1 TP13 EP13] Memory pool end. avail mem=11.84 GB
[2025-12-25 13:10:28 DP0 TP2 EP2] Memory pool end. avail mem=11.60 GB
[2025-12-25 13:10:28 DP1 TP11 EP11] Memory pool end. avail mem=11.83 GB
[2025-12-25 13:10:28 DP0 TP3 EP3] Memory pool end. avail mem=11.84 GB
[2025-12-25 13:10:28 DP1 TP8 EP8] Memory pool end. avail mem=11.60 GB
[2025-12-25 13:10:28 DP1 TP15 EP15] Memory pool end. avail mem=11.84 GB
[2025-12-25 13:10:28 DP0 TP4 EP4] Memory pool end. avail mem=11.60 GB
[2025-12-25 13:10:28 DP0 TP7 EP7] Memory pool end. avail mem=11.84 GB
[2025-12-25 13:10:28 DP1 TP12 EP12] Memory pool end. avail mem=11.60 GB
[2025-12-25 13:10:28 DP0 TP5 EP5] Memory pool end. avail mem=11.84 GB
[2025-12-25 13:10:28 DP0 TP1 EP1] Memory pool end. avail mem=11.84 GB
[2025-12-25 13:10:28 DP1 TP9 EP9] Memory pool end. avail mem=11.84 GB
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:1204: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  tensor_data = torch.ByteTensor(
[2025-12-25 13:10:29 DP1 TP14 EP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP1 TP15 EP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP1 TP11 EP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP1 TP12 EP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP1 TP13 EP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP0 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP1 TP8 EP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP1 TP9 EP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP0 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP0 TP6 EP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP0 TP7 EP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP1 TP14 EP14] Init torch distributed begin.
[2025-12-25 13:10:29 DP1 TP11 EP11] Init torch distributed begin.
[2025-12-25 13:10:29 DP1 TP15 EP15] Init torch distributed begin.
[2025-12-25 13:10:29 DP1 TP12 EP12] Init torch distributed begin.
[2025-12-25 13:10:29 DP1 TP13 EP13] Init torch distributed begin.
[2025-12-25 13:10:29 DP1 TP8 EP8] Init torch distributed begin.
[2025-12-25 13:10:29 DP0 TP2 EP2] Init torch distributed begin.
[2025-12-25 13:10:29 DP1 TP9 EP9] Init torch distributed begin.
[2025-12-25 13:10:29 DP0 TP0 EP0] Init torch distributed begin.
[2025-12-25 13:10:29 DP0 TP6 EP6] Init torch distributed begin.
[2025-12-25 13:10:29 DP0 TP7 EP7] Init torch distributed begin.
[2025-12-25 13:10:29 DP0 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP0 TP5 EP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP0 TP4 EP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP0 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP0 TP5 EP5] Init torch distributed begin.
[2025-12-25 13:10:29 DP0 TP4 EP4] Init torch distributed begin.
[2025-12-25 13:10:29 DP0 TP1 EP1] Init torch distributed begin.
[2025-12-25 13:10:29 DP0 TP3 EP3] Init torch distributed begin.
[2025-12-25 13:10:29 DP1 TP10 EP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2025-12-25 13:10:29 DP1 TP10 EP10] Init torch distributed begin.
[2025-12-25 13:10:29 DP0 TP0 EP0] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP1 TP14 EP14] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP1 TP15 EP15] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP1 TP13 EP13] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP1 TP12 EP12] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP1 TP10 EP10] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP1 TP9 EP9] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP1 TP11 EP11] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP1 TP8 EP8] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP0 TP6 EP6] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP0 TP7 EP7] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP0 TP4 EP4] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP0 TP5 EP5] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP0 TP3 EP3] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP0 TP2 EP2] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP0 TP1 EP1] Init torch distributed ends. mem usage=0.00 GB
[2025-12-25 13:10:29 DP0 TP0 EP0] Load weight begin. avail mem=11.53 GB
[2025-12-25 13:10:29 DP1 TP14 EP14] Load weight begin. avail mem=11.60 GB
[2025-12-25 13:10:29 DP1 TP15 EP15] Load weight begin. avail mem=11.84 GB
[2025-12-25 13:10:29 DP1 TP13 EP13] Load weight begin. avail mem=11.84 GB
[2025-12-25 13:10:29 DP1 TP8 EP8] Load weight begin. avail mem=11.60 GB
[2025-12-25 13:10:29 DP0 TP6 EP6] Load weight begin. avail mem=11.60 GB
[2025-12-25 13:10:29 DP1 TP10 EP10] Load weight begin. avail mem=11.61 GB
[2025-12-25 13:10:29 DP1 TP9 EP9] Load weight begin. avail mem=11.84 GB
[2025-12-25 13:10:29 DP1 TP11 EP11] Load weight begin. avail mem=11.83 GB
[2025-12-25 13:10:29 DP0 TP4 EP4] Load weight begin. avail mem=11.60 GB
[2025-12-25 13:10:29 DP0 TP7 EP7] Load weight begin. avail mem=11.84 GB
[2025-12-25 13:10:29 DP1 TP12 EP12] Load weight begin. avail mem=11.60 GB
[2025-12-25 13:10:29 DP0 TP1 EP1] Load weight begin. avail mem=11.84 GB
[2025-12-25 13:10:29 DP0 TP5 EP5] Load weight begin. avail mem=11.84 GB
[2025-12-25 13:10:29 DP0 TP2 EP2] Load weight begin. avail mem=11.60 GB
[2025-12-25 13:10:29 DP0 TP3 EP3] Load weight begin. avail mem=11.84 GB
Loading safetensors checkpoint shards:   0% Completed | 0/162 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:   1% Completed | 1/162 [00:01<03:06,  1.16s/it]
Loading safetensors checkpoint shards:   1% Completed | 2/162 [00:02<03:05,  1.16s/it]
Loading safetensors checkpoint shards:   2% Completed | 3/162 [00:03<03:02,  1.15s/it]
Loading safetensors checkpoint shards:   2% Completed | 4/162 [00:04<03:00,  1.14s/it]
Loading safetensors checkpoint shards:   3% Completed | 5/162 [00:05<03:00,  1.15s/it]
Loading safetensors checkpoint shards:   4% Completed | 6/162 [00:06<03:00,  1.16s/it]
Loading safetensors checkpoint shards:   4% Completed | 7/162 [00:08<02:59,  1.16s/it]
Loading safetensors checkpoint shards:   5% Completed | 8/162 [00:09<02:53,  1.13s/it]
Loading safetensors checkpoint shards:   6% Completed | 9/162 [00:10<02:53,  1.14s/it]
Loading safetensors checkpoint shards:   6% Completed | 10/162 [00:11<02:53,  1.14s/it]
Loading safetensors checkpoint shards:   7% Completed | 11/162 [00:12<02:53,  1.15s/it]
Loading safetensors checkpoint shards:   7% Completed | 12/162 [00:13<02:48,  1.12s/it]
Loading safetensors checkpoint shards:   8% Completed | 13/162 [00:14<02:45,  1.11s/it]
Loading safetensors checkpoint shards:   9% Completed | 14/162 [00:15<02:46,  1.13s/it]
Loading safetensors checkpoint shards:   9% Completed | 15/162 [00:17<02:46,  1.13s/it]
Loading safetensors checkpoint shards:  10% Completed | 16/162 [00:18<02:45,  1.14s/it]
Loading safetensors checkpoint shards:  10% Completed | 17/162 [00:19<02:46,  1.15s/it]
Loading safetensors checkpoint shards:  11% Completed | 18/162 [00:20<02:44,  1.14s/it]
Loading safetensors checkpoint shards:  12% Completed | 19/162 [00:21<02:39,  1.12s/it]
Loading safetensors checkpoint shards:  12% Completed | 20/162 [00:22<02:37,  1.11s/it]
Loading safetensors checkpoint shards:  13% Completed | 21/162 [00:23<02:36,  1.11s/it]
Loading safetensors checkpoint shards:  14% Completed | 22/162 [00:24<02:36,  1.12s/it]
Loading safetensors checkpoint shards:  14% Completed | 23/162 [00:26<02:35,  1.12s/it]
Loading safetensors checkpoint shards:  15% Completed | 24/162 [00:27<02:31,  1.10s/it]
Loading safetensors checkpoint shards:  15% Completed | 25/162 [00:28<02:37,  1.15s/it]
Loading safetensors checkpoint shards:  16% Completed | 26/162 [00:29<02:41,  1.19s/it]
Loading safetensors checkpoint shards:  17% Completed | 27/162 [00:30<02:46,  1.23s/it]
Loading safetensors checkpoint shards:  17% Completed | 28/162 [00:32<02:46,  1.24s/it]
Loading safetensors checkpoint shards:  18% Completed | 29/162 [00:33<02:44,  1.23s/it]
Loading safetensors checkpoint shards:  19% Completed | 30/162 [00:34<02:54,  1.32s/it]
Loading safetensors checkpoint shards:  19% Completed | 31/162 [00:36<02:51,  1.31s/it]
Loading safetensors checkpoint shards:  20% Completed | 32/162 [00:37<02:37,  1.21s/it]
Loading safetensors checkpoint shards:  20% Completed | 33/162 [00:38<02:37,  1.22s/it]
Loading safetensors checkpoint shards:  22% Completed | 35/162 [00:39<01:58,  1.07it/s]
Loading safetensors checkpoint shards:  22% Completed | 36/162 [00:40<02:05,  1.00it/s]
Loading safetensors checkpoint shards:  23% Completed | 37/162 [00:42<02:10,  1.04s/it]
Loading safetensors checkpoint shards:  23% Completed | 38/162 [00:43<02:13,  1.08s/it]
Loading safetensors checkpoint shards:  24% Completed | 39/162 [00:44<02:16,  1.11s/it]
Loading safetensors checkpoint shards:  25% Completed | 40/162 [00:45<02:16,  1.12s/it]
Loading safetensors checkpoint shards:  25% Completed | 41/162 [00:46<02:17,  1.14s/it]
Loading safetensors checkpoint shards:  26% Completed | 42/162 [00:47<02:18,  1.15s/it]
Loading safetensors checkpoint shards:  27% Completed | 43/162 [00:49<02:17,  1.15s/it]
Loading safetensors checkpoint shards:  27% Completed | 44/162 [00:50<02:16,  1.16s/it]
Loading safetensors checkpoint shards:  28% Completed | 45/162 [00:51<02:15,  1.16s/it]
Loading safetensors checkpoint shards:  28% Completed | 46/162 [00:52<02:13,  1.15s/it]
Loading safetensors checkpoint shards:  29% Completed | 47/162 [00:53<02:10,  1.14s/it]
Loading safetensors checkpoint shards:  30% Completed | 48/162 [00:54<02:09,  1.14s/it]
Loading safetensors checkpoint shards:  30% Completed | 49/162 [00:55<02:10,  1.15s/it]
Loading safetensors checkpoint shards:  31% Completed | 50/162 [00:57<02:09,  1.15s/it]
Loading safetensors checkpoint shards:  31% Completed | 51/162 [00:58<02:07,  1.15s/it]
Loading safetensors checkpoint shards:  32% Completed | 52/162 [00:59<02:05,  1.14s/it]
Loading safetensors checkpoint shards:  33% Completed | 53/162 [01:00<02:05,  1.15s/it]
Loading safetensors checkpoint shards:  33% Completed | 54/162 [01:01<02:03,  1.14s/it]
Loading safetensors checkpoint shards:  34% Completed | 55/162 [01:02<02:00,  1.13s/it]
Loading safetensors checkpoint shards:  35% Completed | 56/162 [01:03<02:01,  1.14s/it]
Loading safetensors checkpoint shards:  35% Completed | 57/162 [01:05<01:59,  1.13s/it]
Loading safetensors checkpoint shards:  36% Completed | 58/162 [01:06<01:56,  1.12s/it]
Loading safetensors checkpoint shards:  36% Completed | 59/162 [01:07<01:53,  1.10s/it]
Loading safetensors checkpoint shards:  37% Completed | 60/162 [01:08<01:51,  1.09s/it]
Loading safetensors checkpoint shards:  38% Completed | 61/162 [01:09<01:49,  1.08s/it]
Loading safetensors checkpoint shards:  38% Completed | 62/162 [01:10<01:48,  1.09s/it]
Loading safetensors checkpoint shards:  39% Completed | 63/162 [01:11<01:48,  1.10s/it]
Loading safetensors checkpoint shards:  40% Completed | 64/162 [01:12<01:47,  1.10s/it]
Loading safetensors checkpoint shards:  40% Completed | 65/162 [01:13<01:45,  1.09s/it]
Loading safetensors checkpoint shards:  41% Completed | 66/162 [01:15<02:17,  1.43s/it]
Loading safetensors checkpoint shards:  41% Completed | 67/162 [01:17<02:05,  1.33s/it]
Loading safetensors checkpoint shards:  42% Completed | 68/162 [01:18<01:59,  1.27s/it]
Loading safetensors checkpoint shards:  43% Completed | 69/162 [01:18<01:29,  1.03it/s]
Loading safetensors checkpoint shards:  43% Completed | 70/162 [01:19<01:29,  1.02it/s]
Loading safetensors checkpoint shards:  44% Completed | 71/162 [01:20<01:32,  1.02s/it]
Loading safetensors checkpoint shards:  44% Completed | 72/162 [01:21<01:34,  1.05s/it]
Loading safetensors checkpoint shards:  45% Completed | 73/162 [01:22<01:32,  1.04s/it]
Loading safetensors checkpoint shards:  46% Completed | 74/162 [01:23<01:32,  1.05s/it]
Loading safetensors checkpoint shards:  46% Completed | 75/162 [01:24<01:32,  1.06s/it]
Loading safetensors checkpoint shards:  47% Completed | 76/162 [01:25<01:31,  1.06s/it]
Loading safetensors checkpoint shards:  48% Completed | 77/162 [01:26<01:30,  1.07s/it]
Loading safetensors checkpoint shards:  48% Completed | 78/162 [01:28<01:32,  1.10s/it]
Loading safetensors checkpoint shards:  49% Completed | 79/162 [01:29<01:37,  1.17s/it]
Loading safetensors checkpoint shards:  49% Completed | 80/162 [01:30<01:36,  1.18s/it]
Loading safetensors checkpoint shards:  50% Completed | 81/162 [01:31<01:35,  1.18s/it]
Loading safetensors checkpoint shards:  51% Completed | 82/162 [01:33<01:34,  1.18s/it]
Loading safetensors checkpoint shards:  51% Completed | 83/162 [01:34<01:32,  1.18s/it]
Loading safetensors checkpoint shards:  52% Completed | 84/162 [01:35<01:31,  1.18s/it]
Loading safetensors checkpoint shards:  52% Completed | 85/162 [01:36<01:29,  1.17s/it]
Loading safetensors checkpoint shards:  53% Completed | 86/162 [01:37<01:25,  1.12s/it]
Loading safetensors checkpoint shards:  54% Completed | 87/162 [01:38<01:22,  1.11s/it]
Loading safetensors checkpoint shards:  54% Completed | 88/162 [01:39<01:21,  1.10s/it]
Loading safetensors checkpoint shards:  55% Completed | 89/162 [01:40<01:21,  1.11s/it]
Loading safetensors checkpoint shards:  56% Completed | 90/162 [01:41<01:19,  1.11s/it]
Loading safetensors checkpoint shards:  56% Completed | 91/162 [01:43<01:18,  1.10s/it]
Loading safetensors checkpoint shards:  57% Completed | 92/162 [01:44<01:17,  1.10s/it]
Loading safetensors checkpoint shards:  57% Completed | 93/162 [01:45<01:16,  1.11s/it]
Loading safetensors checkpoint shards:  58% Completed | 94/162 [01:46<01:14,  1.10s/it]
Loading safetensors checkpoint shards:  59% Completed | 95/162 [01:47<01:14,  1.11s/it]
Loading safetensors checkpoint shards:  59% Completed | 96/162 [01:48<01:13,  1.12s/it]
Loading safetensors checkpoint shards:  60% Completed | 97/162 [01:49<01:12,  1.12s/it]
Loading safetensors checkpoint shards:  60% Completed | 98/162 [01:51<01:14,  1.16s/it]
Loading safetensors checkpoint shards:  61% Completed | 99/162 [01:52<01:11,  1.14s/it]
Loading safetensors checkpoint shards:  62% Completed | 100/162 [01:53<01:09,  1.11s/it]
Loading safetensors checkpoint shards:  62% Completed | 101/162 [01:54<01:06,  1.09s/it]
Loading safetensors checkpoint shards:  63% Completed | 102/162 [01:55<01:05,  1.09s/it]
Loading safetensors checkpoint shards:  64% Completed | 103/162 [01:56<01:04,  1.10s/it]
Loading safetensors checkpoint shards:  64% Completed | 104/162 [01:57<01:03,  1.09s/it]
Loading safetensors checkpoint shards:  65% Completed | 105/162 [01:58<01:01,  1.08s/it]
Loading safetensors checkpoint shards:  65% Completed | 106/162 [01:59<01:00,  1.07s/it]
Loading safetensors checkpoint shards:  66% Completed | 107/162 [02:00<00:59,  1.08s/it]
Loading safetensors checkpoint shards:  67% Completed | 108/162 [02:01<00:57,  1.07s/it]
Loading safetensors checkpoint shards:  67% Completed | 109/162 [02:02<00:54,  1.03s/it]
Loading safetensors checkpoint shards:  68% Completed | 110/162 [02:03<00:53,  1.03s/it]
Loading safetensors checkpoint shards:  69% Completed | 111/162 [02:04<00:52,  1.02s/it]
Loading safetensors checkpoint shards:  69% Completed | 112/162 [02:05<00:51,  1.02s/it]
Loading safetensors checkpoint shards:  70% Completed | 113/162 [02:06<00:49,  1.01s/it]
Loading safetensors checkpoint shards:  70% Completed | 114/162 [02:07<00:48,  1.00s/it]
Loading safetensors checkpoint shards:  71% Completed | 115/162 [02:08<00:47,  1.01s/it]
Loading safetensors checkpoint shards:  72% Completed | 116/162 [02:09<00:46,  1.02s/it]
Loading safetensors checkpoint shards:  72% Completed | 117/162 [02:10<00:45,  1.01s/it]
Loading safetensors checkpoint shards:  73% Completed | 118/162 [02:11<00:44,  1.02s/it]
Loading safetensors checkpoint shards:  73% Completed | 119/162 [02:12<00:42,  1.00it/s]
Loading safetensors checkpoint shards:  74% Completed | 120/162 [02:13<00:41,  1.00it/s]
Loading safetensors checkpoint shards:  75% Completed | 121/162 [02:14<00:41,  1.00s/it]
Loading safetensors checkpoint shards:  75% Completed | 122/162 [02:15<00:39,  1.01it/s]
Loading safetensors checkpoint shards:  76% Completed | 123/162 [02:16<00:37,  1.03it/s]
Loading safetensors checkpoint shards:  77% Completed | 124/162 [02:17<00:36,  1.03it/s]
Loading safetensors checkpoint shards:  77% Completed | 125/162 [02:18<00:35,  1.04it/s]
Loading safetensors checkpoint shards:  78% Completed | 126/162 [02:19<00:34,  1.05it/s]
Loading safetensors checkpoint shards:  78% Completed | 127/162 [02:20<00:32,  1.06it/s]
Loading safetensors checkpoint shards:  79% Completed | 128/162 [02:21<00:32,  1.05it/s]
Loading safetensors checkpoint shards:  80% Completed | 129/162 [02:22<00:31,  1.06it/s]
Loading safetensors checkpoint shards:  80% Completed | 130/162 [02:23<00:30,  1.06it/s]
Loading safetensors checkpoint shards:  81% Completed | 131/162 [02:24<00:28,  1.08it/s]
Loading safetensors checkpoint shards:  81% Completed | 132/162 [02:25<00:27,  1.08it/s]
Loading safetensors checkpoint shards:  82% Completed | 133/162 [02:25<00:26,  1.08it/s]
Loading safetensors checkpoint shards:  83% Completed | 134/162 [02:26<00:26,  1.07it/s]
Loading safetensors checkpoint shards:  83% Completed | 135/162 [02:27<00:25,  1.05it/s]
Loading safetensors checkpoint shards:  84% Completed | 136/162 [02:29<00:26,  1.03s/it]
Loading safetensors checkpoint shards:  85% Completed | 137/162 [02:30<00:26,  1.08s/it]
Loading safetensors checkpoint shards:  85% Completed | 138/162 [02:31<00:25,  1.08s/it]
Loading safetensors checkpoint shards:  86% Completed | 139/162 [02:33<00:32,  1.42s/it]
Loading safetensors checkpoint shards:  86% Completed | 140/162 [02:34<00:25,  1.17s/it]
Loading safetensors checkpoint shards:  87% Completed | 141/162 [02:34<00:21,  1.03s/it]
Loading safetensors checkpoint shards:  88% Completed | 142/162 [02:35<00:20,  1.04s/it]
Loading safetensors checkpoint shards:  88% Completed | 143/162 [02:36<00:19,  1.04s/it]
Loading safetensors checkpoint shards:  89% Completed | 144/162 [02:37<00:18,  1.02s/it]
Loading safetensors checkpoint shards:  90% Completed | 145/162 [02:38<00:17,  1.03s/it]
Loading safetensors checkpoint shards:  90% Completed | 146/162 [02:40<00:16,  1.03s/it]
Loading safetensors checkpoint shards:  91% Completed | 147/162 [02:41<00:15,  1.02s/it]
Loading safetensors checkpoint shards:  91% Completed | 148/162 [02:42<00:14,  1.03s/it]
Loading safetensors checkpoint shards:  92% Completed | 149/162 [02:43<00:13,  1.01s/it]
Loading safetensors checkpoint shards:  93% Completed | 150/162 [02:44<00:12,  1.01s/it]
Loading safetensors checkpoint shards:  93% Completed | 151/162 [02:45<00:11,  1.01s/it]
Loading safetensors checkpoint shards:  94% Completed | 152/162 [02:45<00:08,  1.16it/s]
Loading safetensors checkpoint shards:  94% Completed | 153/162 [02:46<00:06,  1.33it/s]
Loading safetensors checkpoint shards:  95% Completed | 154/162 [02:46<00:05,  1.50it/s]
Loading safetensors checkpoint shards:  96% Completed | 155/162 [02:47<00:05,  1.39it/s]
Loading safetensors checkpoint shards:  96% Completed | 156/162 [02:48<00:04,  1.26it/s]
Loading safetensors checkpoint shards:  97% Completed | 157/162 [02:49<00:04,  1.19it/s]
Loading safetensors checkpoint shards:  98% Completed | 158/162 [02:49<00:02,  1.36it/s]
Loading safetensors checkpoint shards:  98% Completed | 159/162 [02:49<00:01,  1.75it/s]
Loading safetensors checkpoint shards:  99% Completed | 160/162 [02:50<00:01,  1.66it/s]
Loading safetensors checkpoint shards:  99% Completed | 161/162 [02:51<00:00,  1.44it/s]
Loading safetensors checkpoint shards: 100% Completed | 162/162 [02:52<00:00,  1.28it/s]
Loading safetensors checkpoint shards: 100% Completed | 162/162 [02:52<00:00,  1.07s/it]

[2025-12-25 13:13:26 DP1 TP8 EP8] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=8.90 GB, mem usage=2.70 GB.
[2025-12-25 13:13:26 DP0 TP4 EP4] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=8.91 GB, mem usage=2.70 GB.
[2025-12-25 13:13:26 DP1 TP15 EP15] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=9.14 GB, mem usage=2.70 GB.
[2025-12-25 13:13:26 DP1 TP11 EP11] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=9.13 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP1 TP12 EP12] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=8.90 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP0 TP7 EP7] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=9.14 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP0 TP6 EP6] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=8.90 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP1 TP14 EP14] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=8.90 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP0 TP5 EP5] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=9.14 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP1 TP10 EP10] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=8.91 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP1 TP13 EP13] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=9.14 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP1 TP9 EP9] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=9.14 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP0 TP3 EP3] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=9.14 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP0 TP2 EP2] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=8.90 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP0 TP0 EP0] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=8.83 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP0 TP1 EP1] Load weight end. type=DeepseekV3ForCausalLMNextN, dtype=torch.bfloat16, avail mem=9.14 GB, mem usage=2.70 GB.
[2025-12-25 13:13:27 DP0 TP0 EP0] Using KV cache dtype: torch.bfloat16
[2025-12-25 13:13:27 DP0 TP0 EP0] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP1 TP15 EP15] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP1 TP14 EP14] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP1 TP13 EP13] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP1 TP12 EP12] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP1 TP11 EP11] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP1 TP10 EP10] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP1 TP9 EP9] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP1 TP8 EP8] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP0 TP7 EP7] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP0 TP6 EP6] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP0 TP5 EP5] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP0 TP4 EP4] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP0 TP3 EP3] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP0 TP2 EP2] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP0 TP1 EP1] The available memory for KV cache is 6.64 GB.
[2025-12-25 13:13:27 DP0 TP0 EP0] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP1 TP14 EP14] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP1 TP15 EP15] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP1 TP13 EP13] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP1 TP12 EP12] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP1 TP11 EP11] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP1 TP10 EP10] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP1 TP9 EP9] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP1 TP8 EP8] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP0 TP7 EP7] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP0 TP6 EP6] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP0 TP5 EP5] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP0 TP4 EP4] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP0 TP2 EP2] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP0 TP3 EP3] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP0 TP1 EP1] KV Cache is allocated. #tokens: 44416, KV size: 0.05 GB
[2025-12-25 13:13:27 DP0 TP0 EP0] Memory pool end. avail mem=8.79 GB
[2025-12-25 13:13:27 DP1 TP14 EP14] Memory pool end. avail mem=8.86 GB
[2025-12-25 13:13:27 DP1 TP12 EP12] Memory pool end. avail mem=8.86 GB
[2025-12-25 13:13:27 DP1 TP15 EP15] Memory pool end. avail mem=9.10 GB
[2025-12-25 13:13:27 DP1 TP13 EP13] Memory pool end. avail mem=9.10 GB
[2025-12-25 13:13:27 DP1 TP11 EP11] Memory pool end. avail mem=9.09 GB
[2025-12-25 13:13:27 DP1 TP10 EP10] Memory pool end. avail mem=8.87 GB
[2025-12-25 13:13:27 DP1 TP9 EP9] Memory pool end. avail mem=9.10 GB
[2025-12-25 13:13:27 DP1 TP8 EP8] Memory pool end. avail mem=8.86 GB
[2025-12-25 13:13:27 DP0 TP6 EP6] Memory pool end. avail mem=8.86 GB
[2025-12-25 13:13:27 DP0 TP7 EP7] Memory pool end. avail mem=9.10 GB
[2025-12-25 13:13:27 DP0 TP1 EP1] Memory pool end. avail mem=9.10 GB
[2025-12-25 13:13:27 DP0 TP4 EP4] Memory pool end. avail mem=8.87 GB
[2025-12-25 13:13:27 DP0 TP5 EP5] Memory pool end. avail mem=9.10 GB
[2025-12-25 13:13:27 DP0 TP2 EP2] Memory pool end. avail mem=8.86 GB
[2025-12-25 13:13:27 DP0 TP3 EP3] Memory pool end. avail mem=9.10 GB
[2025-12-25 13:13:27 DP0 TP0 EP0] max_total_num_tokens=44416, chunked_prefill_size=-1, max_prefill_tokens=28680, max_running_requests=2, context_len=8192, available_gpu_mem=10.61 GB
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 48537), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 38295), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 56963), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 58738), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 36032), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 57471), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=188, family=2, type=2, proto=0, laddr=('192.168.0.234', 37187), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 45728), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 50072), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 51011), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 40319), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 41876), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 57373), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 47807), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=173, family=2, type=2, proto=0, laddr=('192.168.0.234', 46900), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=227, family=2, type=2, proto=0, laddr=('192.168.0.234', 34310), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 55039), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP1 TP12 EP12] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 58344), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 59200), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP1 TP13 EP13] Invalid or no transfer protocol specified, using default protocol.
[2025-12-25 13:13:28 DP1 TP14 EP14] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=195, family=2, type=2, proto=0, laddr=('192.168.0.234', 38044), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP1 TP8 EP8] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 55677), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP1 TP15 EP15] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 33624), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP1 TP9 EP9] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 53079), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP0 TP4 EP4] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 46742), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 53959), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP0 TP5 EP5] Invalid or no transfer protocol specified, using default protocol.
[2025-12-25 13:13:28 DP1 TP11 EP11] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 39685), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP0 TP2 EP2] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 59419), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 56888), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP0 TP3 EP3] Invalid or no transfer protocol specified, using default protocol.
[2025-12-25 13:13:28 DP1 TP10 EP10] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 37835), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP0 TP6 EP6] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 47560), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=180, family=2, type=2, proto=0, laddr=('192.168.0.234', 58430), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP0 TP7 EP7] Invalid or no transfer protocol specified, using default protocol.
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:2698: ResourceWarning: unclosed <socket.socket fd=234, family=2, type=2, proto=0, laddr=('192.168.0.234', 53868), raddr=('8.8.8.8', 80)>
  if ip := get_local_ip_by_remote():
[2025-12-25 13:13:28 DP0 TP1 EP1] Invalid or no transfer protocol specified, using default protocol.
[2025-12-25 13:13:28 DP0 TP0 EP0] Invalid or no transfer protocol specified, using default protocol.
[2025-12-25 13:13:38] INFO:     Started server process [805]
[2025-12-25 13:13:38] INFO:     Waiting for application startup.
[2025-12-25 13:13:38] Using default chat sampling params from model generation config: {'repetition_penalty': 1.0, 'temperature': 0.6, 'top_k': 50, 'top_p': 0.95}
[2025-12-25 13:13:38] Using default chat sampling params from model generation config: {'repetition_penalty': 1.0, 'temperature': 0.6, 'top_k': 50, 'top_p': 0.95}
[2025-12-25 13:13:38] INFO:     Application startup complete.
[2025-12-25 13:13:38] INFO:     Uvicorn running on http://192.168.0.234:8000 (Press CTRL+C to quit)
[2025-12-25 13:13:39] INFO:     192.168.0.234:55736 - "GET /model_info HTTP/1.1" 200 OK
[2025-12-25 13:13:39] Start of pd disaggregation warmup ...
[2025-12-25 13:13:40] INFO:     192.168.0.234:55744 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/utils/common.py:1204: UserWarning: The given NumPy array is not writable, and PyTorch does not support non-writable tensors. This means writing to this tensor will result in undefined behavior. You may want to copy the array to protect its data or make it writable before converting it to a tensor. This type of warning will be suppressed for the rest of this program. (Triggered internally at /pytorch/torch/csrc/utils/tensor_numpy.cpp:203.)
  tensor_data = torch.ByteTensor(
[2025-12-25 13:13:41 DP1 TP8 EP8] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, #prealloc-req: 0, #inflight-req: 0, input throughput (token/s): 0.00, 
[2025-12-25 13:13:41 DP0 TP0 EP0] Prefill batch, #new-seq: 1, #new-token: 128, #cached-token: 0, token usage: 0.00, #running-req: 0, #queue-req: 0, #prealloc-req: 0, #inflight-req: 0, input throughput (token/s): 0.00, 
[rank14]:[W1225 13:13:41.668059520 compiler_depend.ts:198] Warning: Driver Version: "o" is invalid or not supported yet. (function operator())
[rank13]:[W1225 13:13:41.668064870 compiler_depend.ts:198] Warning: Driver Version: "a&" is invalid or not supported yet. (function operator())
[rank12]:[W1225 13:13:41.668072910 compiler_depend.ts:198] Warning: Driver Version: "`q1" is invalid or not supported yet. (function operator())
[rank15]:[W1225 13:13:41.668078510 compiler_depend.ts:198] Warning: Driver Version: "J" is invalid or not supported yet. (function operator())
[rank11]:[W1225 13:13:41.668096970 compiler_depend.ts:198] Warning: Driver Version: "i" is invalid or not supported yet. (function operator())
[rank8]:[W1225 13:13:41.668100210 compiler_depend.ts:198] Warning: Driver Version: "<uX" is invalid or not supported yet. (function operator())
[rank6]:[W1225 13:13:41.668111570 compiler_depend.ts:198] Warning: Driver Version: "LA" is invalid or not supported yet. (function operator())
[rank7]:[W1225 13:13:41.668111660 compiler_depend.ts:198] Warning: Driver Version: "P" is invalid or not supported yet. (function operator())
[rank9]:[W1225 13:13:41.668118420 compiler_depend.ts:198] Warning: Driver Version: "pB" is invalid or not supported yet. (function operator())
[rank10]:[W1225 13:13:41.668123170 compiler_depend.ts:198] Warning: Driver Version: "0^" is invalid or not supported yet. (function operator())
[rank4]:[W1225 13:13:41.668123870 compiler_depend.ts:198] Warning: Driver Version: "" is invalid or not supported yet. (function operator())
[rank5]:[W1225 13:13:41.668123910 compiler_depend.ts:198] Warning: Driver Version: "v;" is invalid or not supported yet. (function operator())
[rank0]:[W1225 13:13:41.668129470 compiler_depend.ts:198] Warning: Driver Version: " F" is invalid or not supported yet. (function operator())
[rank1]:[W1225 13:13:41.668128170 compiler_depend.ts:198] Warning: Driver Version: "07)" is invalid or not supported yet. (function operator())
[rank2]:[W1225 13:13:41.668134550 compiler_depend.ts:198] Warning: Driver Version: "+" is invalid or not supported yet. (function operator())
[rank3]:[W1225 13:13:41.668134590 compiler_depend.ts:198] Warning: Driver Version: "" is invalid or not supported yet. (function operator())
[2025-12-25 13:13:50] INFO:     192.168.0.234:43664 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:00] INFO:     192.168.0.234:41356 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:10] INFO:     192.168.0.234:49302 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:16 DP1 TP11 EP11] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 2255] 2025-12-25-13:14:16.213.040 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe079148c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe078bc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb127fed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb127f2a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb127e5d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP1 TP14 EP14] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 2258] 2025-12-25-13:14:16.213.451 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe045648c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0450c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb0f45ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb0f452a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb0f445d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP1 TP15 EP15] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 2259] 2025-12-25-13:14:16.213.441 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe161d48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe1617c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb2107ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb21072a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb21065d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP1 TP12 EP12] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 2256] 2025-12-25-13:14:16.213.456 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe0ec948c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0ec3c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb19b6ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb19b62a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb19b55d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP1 TP8 EP8] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 2068] 2025-12-25-13:14:16.213.031 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe1dcc48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe1dc6c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb28b7ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb28b72a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb28b65d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP0 TP1 EP1] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1738] 2025-12-25-13:14:16.213.044 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe13f848c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe13f2c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb1ee6ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb1ee62a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb1ee55d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP1 TP9 EP9] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 2250] 2025-12-25-13:14:16.213.033 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe2a5548c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe2a4fc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb353fed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb353f2a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb353e5d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP0 TP5 EP5] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1742] 2025-12-25-13:14:16.213.030 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe033548c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe032fc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb0e22ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb0e222a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb0e215d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP1 TP13 EP13] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 2257] 2025-12-25-13:14:16.213.459 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe226e48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe2268c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb2d5bed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb2d5b2a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb2d5a5d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP0 TP7 EP7] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1744] 2025-12-25-13:14:16.213.037 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf0da48c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf0d4c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffafbc5ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffafbc52a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffafbc45d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP0 TP0 EP0] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1737] 2025-12-25-13:14:16.213.044 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdfe1848c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdfe12c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb0902ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb09022a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb09015d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP0 TP4 EP4] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1741] 2025-12-25-13:14:16.213.030 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe2c2448c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe2c1ec140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb370eed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb370e2a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb370d5d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP0 TP6 EP6] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1743] 2025-12-25-13:14:16.213.037 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf74948c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf743c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb0237ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb02372a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb02365d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP1 TP10 EP10] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 2251] 2025-12-25-13:14:16.213.047 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe198348c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe197dc140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb246eed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb246e2a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb246d5d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP0 TP3 EP3] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1740] 2025-12-25-13:14:16.213.048 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe281448c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe280ec140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffb3300ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffb33002a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffb32ff5d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:16 DP0 TP2 EP2] Scheduler hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2875, in run_scheduler_process
    scheduler.event_loop_normal_disagg_prefill()
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/disaggregation/prefill.py", line 354, in event_loop_normal_disagg_prefill
    result = self.run_batch(batch)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2188, in run_batch
    batch_result = self.model_worker.forward_batch_generation(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 281, in forward_batch_generation
    logits_output, next_token_ids, seq_lens_cpu = self.forward_target_extend(
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/speculative/eagle_worker.py", line 359, in forward_target_extend
    batch_result = self.target_worker.forward_batch_generation(model_worker_batch)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 421, in forward_batch_generation
    out = self.model_runner.forward(
          ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2895, in forward
    output = self._forward_raw(
             ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2973, in _forward_raw
    ret = self.forward_extend(
          ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2840, in forward_extend
    return self.model.forward(
           ^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120, in decorate_context
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3402, in forward
    hidden_states = self.model(
                    ^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3213, in forward
    hidden_states, residual = layer(
                              ^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2925, in forward
    hidden_states = self.mlp(
                    ^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819, in forward
    return self.forward_deepep(hidden_states, forward_batch)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129, in forward_deepep
    final_hidden_states = self.experts(
                          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167, in forward
    return self.forward_impl(hidden_states, topk_output)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 186, in forward_impl
    hidden_states = self.dispatcher.combine(
                    ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1039, in combine
    return self._execute("combine", **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/batch_overlap/two_batch_overlap.py", line 1027, in _execute
    return getattr(self._inners[tbo_subbatch_index or 0], name)(**kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 808, in combine
    ret = self.combine_b()
          ^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 828, in combine_b
    return self._get_impl().combine_b(*inner_state)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 503, in combine_b
    hidden_states, event = self._combine_core(output, previous_event)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/sglang/srt/layers/moe/token_dispatcher/deepep.py", line 511, in _combine_core
    combined_x, _, event = buffer.combine(
                           ^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/utils.py", line 87, in wrapper
    result = func(*args, **kwargs)
             ^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep/buffer.py", line 541, in combine
    recv_x, recv_topk_weights, event = self.runtime.intranode_combine(
                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: call aclnnCamMoeCombineNormal failed, detail:EZ9999: Inner Error!
EZ9999[PID: 1739] 2025-12-25-13:14:16.213.024 AclNN_Inner_Error(EZ9999):  CamMoeCombineNormal do tiling failed, ret is -1.
        TraceBack (most recent call last):
       Check NnopbaseExecutorDoTiling(executor) failed
       Check NnopbaseExecutorTilingAndUpdateBinInfo(executor) failed
       Check NnopbaseExecutorMatchCache(executor) failed
       Check NnopbaseRunForWorkspace(*executor, workspaceSize) failed

Exception raised from intranode_combine at /__w/sgl-kernel-npu/sgl-kernel-npu/csrc/deepep/deep_ep.cpp:605 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdef3948c0 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdef33c140 in /usr/local/python3.11.13/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x2ed80 (0xfffafa26ed80 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #3: <unknown function> + 0x22a2c (0xfffafa262a2c in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
frame #4: <unknown function> + 0x15d70 (0xfffafa255d70 in /usr/local/python3.11.13/lib/python3.11/site-packages/deep_ep_cpp.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>


[2025-12-25 13:14:20] INFO:     192.168.0.234:59930 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:28] INFO:     192.168.0.184:51044 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:28] INFO:     192.168.0.184:51034 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:28] INFO:     192.168.0.184:51056 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:29] INFO:     192.168.0.184:51034 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:29] INFO:     192.168.0.184:51058 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:29] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:29] INFO:     192.168.0.184:51064 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:29] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:30] INFO:     192.168.0.234:56146 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:31] INFO:     192.168.0.184:51034 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:31] INFO:     192.168.0.184:51074 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:31] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:31] INFO:     192.168.0.184:51088 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:31] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:34] INFO:     192.168.0.184:51034 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:34] INFO:     192.168.0.184:51096 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:34] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:34] INFO:     192.168.0.184:51102 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:34] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:38] INFO:     192.168.0.184:51034 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:38] INFO:     192.168.0.184:33876 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:38] INFO:     192.168.0.184:33890 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:40] INFO:     192.168.0.234:37458 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:43] INFO:     192.168.0.184:33892 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:43] INFO:     192.168.0.184:33902 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:43] INFO:     192.168.0.184:33918 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:48] INFO:     192.168.0.184:53276 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:48] INFO:     192.168.0.184:53282 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:48] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:48] INFO:     192.168.0.184:53284 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:48] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:50] INFO:     192.168.0.234:53232 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:53] INFO:     192.168.0.184:53294 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:53] INFO:     192.168.0.184:53306 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:53] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:53] INFO:     192.168.0.184:53316 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:53] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:58] INFO:     192.168.0.184:50268 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:58] WARNING:  Invalid HTTP request received.
[2025-12-25 13:14:58] INFO:     192.168.0.184:50262 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:14:58] INFO:     192.168.0.184:50284 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:14:58] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:00] INFO:     192.168.0.234:35652 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:03] INFO:     192.168.0.184:50300 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:03] INFO:     192.168.0.184:50288 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:03] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:03] INFO:     192.168.0.184:50304 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:03] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:08] INFO:     192.168.0.184:47452 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:08] INFO:     192.168.0.184:47462 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:08] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:08] INFO:     192.168.0.184:47478 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:08] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:10] INFO:     192.168.0.234:52868 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:13] INFO:     192.168.0.184:47484 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:13] INFO:     192.168.0.184:47486 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:13] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:13] INFO:     192.168.0.184:47492 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:13] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:18] INFO:     192.168.0.184:44026 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:18] INFO:     192.168.0.184:44028 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:18] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:18] INFO:     192.168.0.184:44036 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:18] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:20] INFO:     192.168.0.234:35692 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:23] INFO:     192.168.0.184:44048 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:23] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:23] INFO:     192.168.0.184:44038 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:23] INFO:     192.168.0.184:44060 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:23] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:28] INFO:     192.168.0.184:34704 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:28] INFO:     192.168.0.184:34720 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:28] INFO:     192.168.0.184:34730 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:30] INFO:     192.168.0.234:48034 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:33] INFO:     192.168.0.184:34734 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:33] INFO:     192.168.0.184:34736 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:33] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:33] INFO:     192.168.0.184:34738 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:33] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:38] INFO:     192.168.0.184:45174 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:38] INFO:     192.168.0.184:45168 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:38] INFO:     192.168.0.184:45176 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:40] INFO:     192.168.0.234:38590 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:43] INFO:     192.168.0.184:45180 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:43] INFO:     192.168.0.184:45188 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:43] INFO:     192.168.0.184:45190 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:48] INFO:     192.168.0.184:60262 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:48] INFO:     192.168.0.184:60266 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:48] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:48] INFO:     192.168.0.184:60278 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:48] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:50] INFO:     192.168.0.234:36006 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:53] INFO:     192.168.0.184:60304 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:53] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:53] INFO:     192.168.0.184:60294 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:53] INFO:     192.168.0.184:60312 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:53] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:58] INFO:     192.168.0.184:51410 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:58] WARNING:  Invalid HTTP request received.
[2025-12-25 13:15:58] INFO:     192.168.0.184:51400 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:15:58] INFO:     192.168.0.184:51422 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:15:58] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:00] INFO:     192.168.0.234:59968 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:03] INFO:     192.168.0.184:51428 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:03] INFO:     192.168.0.184:51440 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:03] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:03] INFO:     192.168.0.184:51448 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:03] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:08] INFO:     192.168.0.184:35164 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:08] INFO:     192.168.0.184:35178 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:08] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:08] INFO:     192.168.0.184:35184 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:08] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:10] INFO:     192.168.0.234:49428 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:13] INFO:     192.168.0.184:35186 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:13] INFO:     192.168.0.184:35200 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:13] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:13] INFO:     192.168.0.184:35212 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:13] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:18] INFO:     192.168.0.184:52272 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:18] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:18] INFO:     192.168.0.184:52270 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:18] INFO:     192.168.0.184:52288 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:18] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:20] INFO:     192.168.0.234:39552 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:23] INFO:     192.168.0.184:52306 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:23] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:23] INFO:     192.168.0.184:52304 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:23] INFO:     192.168.0.184:52312 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:23] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:28] INFO:     192.168.0.184:54658 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:28] INFO:     192.168.0.184:54674 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:28] INFO:     192.168.0.184:54684 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:30] INFO:     192.168.0.234:43910 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:33] INFO:     192.168.0.184:54716 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:33] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:33] INFO:     192.168.0.184:54700 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:33] INFO:     192.168.0.184:54728 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:33] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:38] INFO:     192.168.0.184:39424 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:38] INFO:     192.168.0.184:39414 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:38] INFO:     192.168.0.184:39440 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:40] INFO:     192.168.0.234:40764 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:43] INFO:     192.168.0.184:39458 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:43] INFO:     192.168.0.184:39442 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:43] INFO:     192.168.0.184:39474 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:48] INFO:     192.168.0.184:41950 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:48] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:48] INFO:     192.168.0.184:41946 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:48] INFO:     192.168.0.184:41954 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:48] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:50] INFO:     192.168.0.234:55122 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:53] INFO:     192.168.0.184:41958 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:53] INFO:     192.168.0.184:41968 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:53] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:53] INFO:     192.168.0.184:41980 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:53] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:58] INFO:     192.168.0.184:51400 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:58] WARNING:  Invalid HTTP request received.
[2025-12-25 13:16:58] INFO:     192.168.0.184:51394 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:16:58] INFO:     192.168.0.184:51406 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:16:58] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:00] INFO:     192.168.0.234:39300 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:03] INFO:     192.168.0.184:51416 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:03] INFO:     192.168.0.184:51420 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:03] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:03] INFO:     192.168.0.184:51436 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:03] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:08] INFO:     192.168.0.184:45858 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:08] INFO:     192.168.0.184:45874 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:08] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:08] INFO:     192.168.0.184:45890 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:08] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:10] INFO:     192.168.0.234:41522 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:13] INFO:     192.168.0.184:45892 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:13] INFO:     192.168.0.184:45900 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:13] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:13] INFO:     192.168.0.184:45914 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:13] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:18] INFO:     192.168.0.184:38422 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:18] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:18] INFO:     192.168.0.184:38416 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:18] INFO:     192.168.0.184:38438 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:18] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:20] INFO:     192.168.0.234:49254 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:23] INFO:     192.168.0.184:38462 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:23] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:23] INFO:     192.168.0.184:38446 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:23] INFO:     192.168.0.184:38464 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:23] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:28] INFO:     192.168.0.184:49686 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:28] INFO:     192.168.0.184:49702 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:28] INFO:     192.168.0.184:49710 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:30] INFO:     192.168.0.234:50228 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:33] INFO:     192.168.0.184:49718 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:33] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:33] INFO:     192.168.0.184:49714 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:33] INFO:     192.168.0.184:49732 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:33] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:38] INFO:     192.168.0.184:57732 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:38] INFO:     192.168.0.184:57734 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:38] INFO:     192.168.0.184:57748 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:40] INFO:     192.168.0.234:37788 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:43] INFO:     192.168.0.184:57772 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:43] INFO:     192.168.0.184:57764 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:43] INFO:     192.168.0.184:57786 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:48] INFO:     192.168.0.184:37194 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:48] INFO:     192.168.0.184:37196 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:48] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:48] INFO:     192.168.0.184:37208 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:48] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:50] INFO:     192.168.0.234:41338 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:53] INFO:     192.168.0.184:37228 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:53] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:53] INFO:     192.168.0.184:37220 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:53] INFO:     192.168.0.184:37244 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:53] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:58] INFO:     192.168.0.184:38184 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:58] WARNING:  Invalid HTTP request received.
[2025-12-25 13:17:58] INFO:     192.168.0.184:38170 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:17:58] INFO:     192.168.0.184:38194 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:17:58] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:00] INFO:     192.168.0.234:44600 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:03] INFO:     192.168.0.184:38204 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:03] INFO:     192.168.0.184:38214 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:03] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:03] INFO:     192.168.0.184:38228 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:03] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:08] INFO:     192.168.0.184:60590 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:08] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:08] INFO:     192.168.0.184:60582 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:08] INFO:     192.168.0.184:60594 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:08] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:10] INFO:     192.168.0.234:41870 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:13] INFO:     192.168.0.184:60604 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:13] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:13] INFO:     192.168.0.184:60596 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:13] INFO:     192.168.0.184:60612 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:13] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:18] INFO:     192.168.0.184:56574 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:18] INFO:     192.168.0.184:56582 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:18] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:18] INFO:     192.168.0.184:56598 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:18] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:20] INFO:     192.168.0.234:33070 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:23] INFO:     192.168.0.184:56614 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:23] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:23] INFO:     192.168.0.184:56602 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:23] INFO:     192.168.0.184:56618 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:23] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:28] INFO:     192.168.0.184:35718 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:28] INFO:     192.168.0.184:35726 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:28] INFO:     192.168.0.184:35736 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:28] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:30] INFO:     192.168.0.234:55272 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:33] INFO:     192.168.0.184:35756 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:33] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:33] INFO:     192.168.0.184:35752 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:33] INFO:     192.168.0.184:35760 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:33] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:38] INFO:     192.168.0.184:52640 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:38] INFO:     192.168.0.184:52634 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:38] INFO:     192.168.0.184:52650 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:38] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:40] INFO:     192.168.0.234:44056 - "GET /health_generate HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:43] INFO:     192.168.0.184:52662 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:43] INFO:     192.168.0.184:52658 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:43] INFO:     192.168.0.184:52674 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:43] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:48] INFO:     192.168.0.184:42190 - "GET /health HTTP/1.1" 503 Service Unavailable
[2025-12-25 13:18:48] INFO:     192.168.0.184:42196 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:48] WARNING:  Invalid HTTP request received.
[2025-12-25 13:18:48] INFO:     192.168.0.184:42204 - "PRI %2A HTTP/2.0" 404 Not Found
[2025-12-25 13:18:48] WARNING:  Invalid HTTP request received.
