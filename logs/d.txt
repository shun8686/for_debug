NPU info:
+------------------------------------------------------------------------------------------------+
| npu-smi 25.3.rc1                 Version: 25.3.rc1                                             |
+---------------------------+---------------+----------------------------------------------------+
| NPU   Name                | Health        | Power(W)    Temp(C)           Hugepages-Usage(page)|
| Chip  Phy-ID              | Bus-Id        | AICore(%)   Memory-Usage(MB)  HBM-Usage(MB)        |
+===========================+===============+====================================================+
| 0     Ascend910           | OK            | 165.6       37                0    / 0             |
| 0     0                   | 0000:9D:00.0  | 0           0    / 0          3164 / 65536         |
+------------------------------------------------------------------------------------------------+
| 0     Ascend910           | OK            | -           36                0    / 0             |
| 1     1                   | 0000:9F:00.0  | 0           0    / 0          2889 / 65536         |
+===========================+===============+====================================================+
| 1     Ascend910           | OK            | 169.5       37                0    / 0             |
| 0     2                   | 0000:99:00.0  | 0           0    / 0          3163 / 65536         |
+------------------------------------------------------------------------------------------------+
| 1     Ascend910           | OK            | -           36                0    / 0             |
| 1     3                   | 0000:9B:00.0  | 0           0    / 0          2879 / 65536         |
+===========================+===============+====================================================+
| 2     Ascend910           | OK            | 163.9       37                0    / 0             |
| 0     4                   | 0000:95:00.0  | 0           0    / 0          3163 / 65536         |
+------------------------------------------------------------------------------------------------+
| 2     Ascend910           | OK            | -           36                0    / 0             |
| 1     5                   | 0000:97:00.0  | 0           0    / 0          2879 / 65536         |
+===========================+===============+====================================================+
| 3     Ascend910           | OK            | 160.8       36                0    / 0             |
| 0     6                   | 0000:91:00.0  | 0           0    / 0          3163 / 65536         |
+------------------------------------------------------------------------------------------------+
| 3     Ascend910           | OK            | -           36                0    / 0             |
| 1     7                   | 0000:93:00.0  | 0           0    / 0          2879 / 65536         |
+===========================+===============+====================================================+
| 4     Ascend910           | OK            | 176.9       37                0    / 0             |
| 0     8                   | 0000:8D:00.0  | 0           0    / 0          3152 / 65536         |
+------------------------------------------------------------------------------------------------+
| 4     Ascend910           | OK            | -           36                0    / 0             |
| 1     9                   | 0000:8F:00.0  | 0           0    / 0          2891 / 65536         |
+===========================+===============+====================================================+
| 5     Ascend910           | OK            | 161.2       39                0    / 0             |
| 0     10                  | 0000:89:00.0  | 0           0    / 0          3161 / 65536         |
+------------------------------------------------------------------------------------------------+
| 5     Ascend910           | OK            | -           37                0    / 0             |
| 1     11                  | 0000:8B:00.0  | 0           0    / 0          2879 / 65536         |
+===========================+===============+====================================================+
| 6     Ascend910           | OK            | 159.7       36                0    / 0             |
| 0     12                  | 0000:85:00.0  | 0           0    / 0          3161 / 65536         |
+------------------------------------------------------------------------------------------------+
| 6     Ascend910           | OK            | -           36                0    / 0             |
| 1     13                  | 0000:87:00.0  | 0           0    / 0          2880 / 65536         |
+===========================+===============+====================================================+
| 7     Ascend910           | OK            | 161.0       38                0    / 0             |
| 0     14                  | 0000:81:00.0  | 0           0    / 0          3150 / 65536         |
+------------------------------------------------------------------------------------------------+
| 7     Ascend910           | OK            | -           39                0    / 0             |
| 1     15                  | 0000:83:00.0  | 0           0    / 0          2889 / 65536         |
+===========================+===============+====================================================+
+---------------------------+---------------+----------------------------------------------------+
| NPU     Chip              | Process id    | Process name             | Process memory(MB)      |
+===========================+===============+====================================================+
| No running processes found in NPU 0                                                            |
+===========================+===============+====================================================+
| No running processes found in NPU 1                                                            |
+===========================+===============+====================================================+
| No running processes found in NPU 2                                                            |
+===========================+===============+====================================================+
| No running processes found in NPU 3                                                            |
+===========================+===============+====================================================+
| No running processes found in NPU 4                                                            |
+===========================+===============+====================================================+
| No running processes found in NPU 5                                                            |
+===========================+===============+====================================================+
| No running processes found in NPU 6                                                            |
+===========================+===============+====================================================+
| No running processes found in NPU 7                                                            |
+===========================+===============+====================================================+
DNS info:
nameserver 223.5.5.5
nameserver 223.6.6.6
nameserver 169.254.20.10
nameserver 10.247.3.10
search sglang-multi-debug.svc.cluster.local svc.cluster.local cluster.local
options single-request-reopen timeout:2 ndots:5
Writing to /root/.config/pip/pip.conf
Writing to /root/.config/pip/pip.conf
Looking in indexes: https://pypi.tuna.tsinghua.edu.cn/simple
Collecting kubernetes
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/0c/70/05b685ea2dffcb2adbf3cdcea5d8865b7bc66f67249084cf845012a0ff13/kubernetes-35.0.0-py2.py3-none-any.whl (2.0 MB)
Requirement already satisfied: certifi>=14.05.14 in /usr/local/python3.11.14/lib/python3.11/site-packages (from kubernetes) (2026.1.4)
Requirement already satisfied: six>=1.9.0 in /usr/local/python3.11.14/lib/python3.11/site-packages (from kubernetes) (1.17.0)
Requirement already satisfied: python-dateutil>=2.5.3 in /usr/local/python3.11.14/lib/python3.11/site-packages (from kubernetes) (2.9.0.post0)
Requirement already satisfied: pyyaml>=5.4.1 in /usr/local/python3.11.14/lib/python3.11/site-packages (from kubernetes) (6.0.3)
Collecting websocket-client!=0.40.0,!=0.41.*,!=0.42.*,>=0.32.0 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/34/db/b10e48aa8fff7407e67470363eac595018441cf32d5e1001567a7aeba5d2/websocket_client-1.9.0-py3-none-any.whl (82 kB)
Requirement already satisfied: requests in /usr/local/python3.11.14/lib/python3.11/site-packages (from kubernetes) (2.32.5)
Collecting requests-oauthlib (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/3b/5d/63d4ae3b9daea098d5d6f5da83984853c1bbacd5dc826764b249fe119d24/requests_oauthlib-2.0.0-py2.py3-none-any.whl (24 kB)
Requirement already satisfied: urllib3!=2.6.0,>=1.24.2 in /usr/local/python3.11.14/lib/python3.11/site-packages (from kubernetes) (2.6.3)
Collecting durationpy>=0.7 (from kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/b0/0d/9feae160378a3553fa9a339b0e9c1a048e147a4127210e286ef18b730f03/durationpy-0.10-py3-none-any.whl (3.9 kB)
Requirement already satisfied: charset_normalizer<4,>=2 in /usr/local/python3.11.14/lib/python3.11/site-packages (from requests->kubernetes) (3.4.4)
Requirement already satisfied: idna<4,>=2.5 in /usr/local/python3.11.14/lib/python3.11/site-packages (from requests->kubernetes) (3.11)
Collecting oauthlib>=3.0.0 (from requests-oauthlib->kubernetes)
  Using cached https://pypi.tuna.tsinghua.edu.cn/packages/be/9c/92789c596b8df838baa98fa71844d84283302f7604ed565dafe5a6b5041a/oauthlib-3.3.1-py3-none-any.whl (160 kB)
Installing collected packages: durationpy, websocket-client, oauthlib, requests-oauthlib, kubernetes

Successfully installed durationpy-0.10 kubernetes-35.0.0 oauthlib-3.3.1 requests-oauthlib-2.0.0 websocket-client-1.9.0
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
performance
vm.swappiness = 0
kernel.numa_balancing = 0
kernel.sched_migration_cost_ns = 50000
CANN: version=8.5.0
Set env for CANN 8.5
Running test case test/registered/ascend/performance/test_ascend_deepseek_r1_w4a8_1p1d_16p_in2k_out2k_50ms.py
The nic name matched is enp23s0f3
The nic name matched is enp23s0f3
Nic name: enp23s0f3
Init 172.22.3.245 cls.role=None!
[CI Test Method] Test_DeepSeek_R1_W4A8_1P1D_In2048_Out2048.test_throughput
launch_node start ......None node started, keeping test alive for 3600 seconds

Successfully queried ConfigMap sglang-info in namespace sglang-multi-debug
Retrieved ConfigMap data: {'sglang-multi-debug-sglang-decode-0': '172.22.3.245', 'sglang-multi-debug-sglang-prefill-0': '172.22.3.244', 'sglang-multi-debug-sglang-router-0': '172.22.3.244'}
Setting ENV_VAR ASCEND_MF_STORE_URL=tcp://172.22.3.244:24666
Launching decode node with dist_init_addr=172.22.3.245:5000
Setting ENV_VAR SGLANG_SET_CPU_AFFINITY=1
Setting ENV_VAR PYTORCH_NPU_ALLOC_CONF=expandable_segments:True
Setting ENV_VAR STREAMS_PER_DEVICE=32
Setting ENV_VAR SGLANG_NPU_USE_MLAPO=1
Setting ENV_VAR SGLANG_USE_FIA_NZ=1
Setting ENV_VAR ENABLE_MOE_NZ=1
Setting ENV_VAR SGLANG_ENABLE_OVERLAP_PLAN_STREAM=1
Setting ENV_VAR SGLANG_ENABLE_SPEC_V2=1
Setting ENV_VAR HCCL_BUFFSIZE=720
Setting ENV_VAR SGLANG_DP_ROUND_ROBIN=1
Setting ENV_VAR SGLANG_DEEPEP_NUM_MAX_DISPATCH_TOKENS_PER_RANK=96
Setting ENV_VAR TASK_QUEUE_ENABLE=1
Setting ENV_VAR HCCL_SOCKET_IFNAME=enp23s0f3
Setting ENV_VAR GLOO_SOCKET_IFNAME=enp23s0f3
No node-rank specified - all decode nodes will form a single instance.
Starting decode node on 172.22.3.245 with args: ['--trust-remote-code', '--attention-backend', 'ascend', '--device', 'npu', '--disaggregation-transfer-backend', 'ascend', '--nnodes', '1', '--disaggregation-mode', 'decode', '--tp-size', 16, '--dp-size', 16, '--mem-fraction-static', 0.8, '--max-running-requests', 384, '--quantization', 'modelslim', '--moe-a2a-backend', 'deepep', '--enable-dp-attention', '--deepep-mode', 'low_latency', '--enable-dp-lm-head', '--cuda-graph-bs', 8, 10, 12, 14, 16, 18, 20, 22, 24, '--watchdog-timeout', 9000, '--context-length', 8192, '--speculative-algorithm', 'NEXTN', '--speculative-num-steps', 3, '--speculative-eagle-topk', 1, '--speculative-num-draft-tokens', 4, '--prefill-round-robin-balance', '--disable-shared-experts-fusion', '--dtype', 'bfloat16', '--tokenizer-worker-num', 4, '--load-balance-method', 'decode_round_robin', '--dist-init-addr', '172.22.3.245:5000', '--node-rank', '0']
command=python3 -m sglang.launch_server --model-path /root/.cache/modelscope/hub/models/DeepSeek-R1-0528-w4a8-per-channel --trust-remote-code --attention-backend ascend --device npu --disaggregation-transfer-backend ascend --nnodes 1 --disaggregation-mode decode --tp-size 16 --dp-size 16 --mem-fraction-static 0.8 --max-running-requests 384 --quantization modelslim --moe-a2a-backend deepep --enable-dp-attention --deepep-mode low_latency --enable-dp-lm-head --cuda-graph-bs 8 10 12 14 16 18 20 22 24 --watchdog-timeout 9000 --context-length 8192 --speculative-algorithm NEXTN --speculative-num-steps 3 --speculative-eagle-topk 1 --speculative-num-draft-tokens 4 --prefill-round-robin-balance --disable-shared-experts-fusion --dtype bfloat16 --tokenizer-worker-num 4 --load-balance-method decode_round_robin --dist-init-addr 172.22.3.245:5000 --node-rank 0 --device npu --host 172.22.3.245 --port 8000
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2026-01-19 20:17:15] WARNING model_config.py:820: modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:15] WARNING server_args.py:1780: DP attention is enabled. The chunked prefill size is adjusted to 512 to avoid MoE kernel issues. 
[2026-01-19 20:17:15] WARNING server_args.py:1833: DeepEP MoE is enabled. The expert parallel size is adjusted to be the same as the tensor parallel size[16].
[2026-01-19 20:17:15] WARNING server_args.py:1975: Beta spec is enabled for eagle speculative decoding and overlap schedule is turned on.
[2026-01-19 20:17:15] WARNING server_args.py:2213: KV cache is forced as chunk cache for decode server
[2026-01-19 20:17:16] server_args=ServerArgs(model_path='/root/.cache/modelscope/hub/models/DeepSeek-R1-0528-w4a8-per-channel', tokenizer_path='/root/.cache/modelscope/hub/models/DeepSeek-R1-0528-w4a8-per-channel', tokenizer_mode='auto', tokenizer_worker_num=4, skip_tokenizer_init=False, load_format='auto', model_loader_extra_config='{}', trust_remote_code=True, context_length=8192, is_embedding=False, enable_multimodal=None, limit_mm_data_per_request=None, revision=None, model_impl='auto', host='172.22.3.245', port=8000, fastapi_root_path='', grpc_mode=False, skip_server_warmup=False, warmups=None, nccl_port=None, checkpoint_engine_wait_weights_before_ready=False, dtype='bfloat16', quantization='modelslim', quantization_param_path=None, kv_cache_dtype='auto', enable_fp32_lm_head=False, modelopt_quant=None, modelopt_checkpoint_restore_path=None, modelopt_checkpoint_save_path=None, modelopt_export_path=None, quantize_and_serve=False, rl_quant_profile=None, mem_fraction_static=0.8, max_running_requests=384, max_queued_requests=None, max_total_tokens=None, chunked_prefill_size=512, enable_dynamic_chunking=False, max_prefill_tokens=16384, prefill_max_requests=None, schedule_policy='fcfs', enable_priority_scheduling=False, abort_on_priority_when_disabled=False, schedule_low_priority_values_first=False, priority_scheduling_preemption_threshold=10, schedule_conservativeness=0.3, page_size=128, hybrid_kvcache_ratio=None, swa_full_tokens_ratio=0.8, disable_hybrid_swa_memory=False, radix_eviction_policy='lru', device='npu', tp_size=16, pp_size=1, pp_max_micro_batch_size=None, pp_async_batch_depth=0, stream_interval=1, stream_output=False, random_seed=571479149, constrained_json_whitespace_pattern=None, constrained_json_disable_any_whitespace=False, watchdog_timeout=9000.0, soft_watchdog_timeout=None, dist_timeout=None, download_dir=None, base_gpu_id=0, gpu_id_step=1, sleep_on_idle=False, custom_sigquit_handler=None, log_level='info', log_level_http=None, log_requests=False, log_requests_level=2, crash_dump_folder=None, show_time_cost=False, enable_metrics=False, enable_metrics_for_all_schedulers=False, tokenizer_metrics_custom_labels_header='x-custom-labels', tokenizer_metrics_allowed_custom_labels=None, bucket_time_to_first_token=None, bucket_inter_token_latency=None, bucket_e2e_request_latency=None, collect_tokens_histogram=False, prompt_tokens_buckets=None, generation_tokens_buckets=None, gc_warning_threshold_secs=0.0, decode_log_interval=40, enable_request_time_stats_logging=False, kv_events_config=None, enable_trace=False, otlp_traces_endpoint='localhost:4317', export_metrics_to_file=False, export_metrics_to_file_dir=None, api_key=None, served_model_name='/root/.cache/modelscope/hub/models/DeepSeek-R1-0528-w4a8-per-channel', weight_version='default', chat_template=None, completion_template=None, file_storage_path='sglang_storage', enable_cache_report=False, reasoning_parser=None, tool_call_parser=None, tool_server=None, sampling_defaults='model', dp_size=16, load_balance_method='decode_round_robin', load_watch_interval=0.1, prefill_round_robin_balance=True, dist_init_addr='172.22.3.245:5000', nnodes=1, node_rank=0, json_model_override_args='{}', preferred_sampling_params=None, enable_lora=None, max_lora_rank=None, lora_target_modules=None, lora_paths=None, max_loaded_loras=None, max_loras_per_batch=8, lora_eviction_policy='lru', lora_backend='csgmv', max_lora_chunk_size=16, attention_backend='ascend', decode_attention_backend='ascend', prefill_attention_backend='ascend', sampling_backend='pytorch', grammar_backend='xgrammar', mm_attention_backend=None, fp8_gemm_runner_backend='auto', nsa_prefill_backend='flashmla_sparse', nsa_decode_backend='fa3', disable_flashinfer_autotune=False, speculative_algorithm='EAGLE', speculative_draft_model_path='/root/.cache/modelscope/hub/models/DeepSeek-R1-0528-w4a8-per-channel', speculative_draft_model_revision=None, speculative_draft_load_format=None, speculative_num_steps=3, speculative_eagle_topk=1, speculative_num_draft_tokens=4, speculative_accept_threshold_single=1.0, speculative_accept_threshold_acc=1.0, speculative_token_map=None, speculative_attention_mode='prefill', speculative_draft_attention_backend=None, speculative_moe_runner_backend='auto', speculative_moe_a2a_backend=None, speculative_draft_model_quantization='modelslim', speculative_ngram_min_match_window_size=1, speculative_ngram_max_match_window_size=12, speculative_ngram_min_bfs_breadth=1, speculative_ngram_max_bfs_breadth=10, speculative_ngram_match_type='BFS', speculative_ngram_branch_length=18, speculative_ngram_capacity=10000000, speculative_suffix_max_tree_depth=24, speculative_suffix_max_cached_requests=50000, speculative_suffix_max_spec_factor=1.0, speculative_suffix_min_token_prob=0.1, enable_mtp=False, ep_size=16, moe_a2a_backend='deepep', moe_runner_backend='auto', flashinfer_mxfp4_moe_precision='default', enable_flashinfer_allreduce_fusion=False, deepep_mode='low_latency', ep_num_redundant_experts=0, ep_dispatch_algorithm=None, init_expert_location='trivial', enable_eplb=False, enable_async_eplb=False, eplb_algorithm='auto', eplb_rebalance_num_iterations=1000, eplb_rebalance_layers_per_chunk=None, eplb_min_rebalancing_utilization_threshold=1.0, expert_distribution_recorder_mode=None, expert_distribution_recorder_buffer_size=1000, enable_expert_distribution_metrics=False, deepep_config=None, moe_dense_tp_size=None, elastic_ep_backend=None, mooncake_ib_device=None, max_mamba_cache_size=None, mamba_ssm_dtype='float32', mamba_full_memory_ratio=0.9, mamba_scheduler_strategy='no_buffer', mamba_track_interval=256, enable_hierarchical_cache=False, hicache_ratio=2.0, hicache_size=0, hicache_write_policy='write_through', hicache_io_backend='kernel', hicache_mem_layout='layer_first', hicache_storage_backend=None, hicache_storage_prefetch_policy='best_effort', hicache_storage_backend_extra_config=None, enable_lmcache=False, kt_weight_path=None, kt_method='AMXINT4', kt_cpuinfer=None, kt_threadpool_count=2, kt_num_gpu_experts=None, kt_max_deferred_experts_per_token=None, dllm_algorithm=None, dllm_algorithm_config=None, enable_double_sparsity=False, ds_channel_config_path=None, ds_heavy_channel_num=32, ds_heavy_token_num=256, ds_heavy_channel_type='qk', ds_sparse_decode_threshold=4096, cpu_offload_gb=0, offload_group_size=-1, offload_num_in_group=1, offload_prefetch_step=1, offload_mode='cpu', multi_item_scoring_delimiter=None, disable_radix_cache=True, cuda_graph_max_bs=24, cuda_graph_bs=[8, 10, 12, 14, 16, 18, 20, 22, 24], disable_cuda_graph=False, disable_cuda_graph_padding=False, enable_profile_cuda_graph=False, enable_cudagraph_gc=False, enable_layerwise_nvtx_marker=False, enable_nccl_nvls=False, enable_symm_mem=False, disable_flashinfer_cutlass_moe_fp4_allgather=False, enable_tokenizer_batch_encode=False, disable_tokenizer_batch_decode=False, disable_outlines_disk_cache=False, disable_custom_all_reduce=True, enable_mscclpp=False, enable_torch_symm_mem=False, disable_overlap_schedule=False, enable_mixed_chunk=False, enable_dp_attention=True, enable_dp_lm_head=True, enable_two_batch_overlap=False, enable_single_batch_overlap=False, tbo_token_distribution_threshold=0.48, enable_torch_compile=False, enable_piecewise_cuda_graph=False, enable_torch_compile_debug_mode=False, torch_compile_max_bs=32, piecewise_cuda_graph_max_tokens=4096, piecewise_cuda_graph_tokens=[4, 8, 12, 16, 20, 24, 28, 32, 48, 64, 80, 96, 112, 128, 144, 160, 176, 192, 208, 224, 240, 256, 288, 320, 352, 384, 416, 448, 480, 512, 640, 768, 896, 1024, 1152, 1280, 1408, 1536, 1664, 1792, 1920, 2048, 2176, 2304, 2432, 2560, 2688, 2816, 2944, 3072, 3200, 3328, 3456, 3584, 3712, 3840, 3968, 4096], piecewise_cuda_graph_compiler='eager', torchao_config='', enable_nan_detection=False, enable_p2p_check=False, triton_attention_reduce_in_fp32=False, triton_attention_num_kv_splits=8, triton_attention_split_tile_size=None, num_continuous_decode_steps=1, delete_ckpt_after_loading=False, enable_memory_saver=False, enable_weights_cpu_backup=False, enable_draft_weights_cpu_backup=False, allow_auto_truncate=False, enable_custom_logit_processor=False, flashinfer_mla_disable_ragged=False, disable_shared_experts_fusion=True, disable_chunked_prefix_cache=False, disable_fast_image_processor=False, keep_mm_feature_on_device=False, enable_return_hidden_states=False, enable_return_routed_experts=False, scheduler_recv_interval=1, numa_node=None, enable_deterministic_inference=False, rl_on_policy_target=None, enable_attn_tp_input_scattered=False, enable_nsa_prefill_context_parallel=False, enable_fused_qk_norm_rope=False, enable_dynamic_batch_tokenizer=False, dynamic_batch_tokenizer_batch_size=32, dynamic_batch_tokenizer_batch_timeout=0.002, debug_tensor_dump_output_folder=None, debug_tensor_dump_layers=None, debug_tensor_dump_input_file=None, debug_tensor_dump_inject=False, disaggregation_mode='decode', disaggregation_transfer_backend='ascend', disaggregation_bootstrap_port=8998, disaggregation_decode_tp=None, disaggregation_decode_dp=None, disaggregation_prefill_pp=1, disaggregation_ib_device=None, disaggregation_decode_enable_offload_kvcache=False, num_reserved_decode_tokens=512, disaggregation_decode_polling_interval=1, encoder_only=False, language_only=False, encoder_transfer_backend='zmq_to_scheduler', encoder_urls=[], custom_weight_loader=[], weight_loader_disable_mmap=False, remote_instance_weight_loader_seed_instance_ip=None, remote_instance_weight_loader_seed_instance_service_port=None, remote_instance_weight_loader_send_weights_group_ports=None, remote_instance_weight_loader_backend='nccl', remote_instance_weight_loader_start_seed_via_transfer_engine=False, enable_pdmux=False, pdmux_config_path=None, sm_group_num=8, mm_max_concurrent_calls=32, mm_per_request_timeout=10.0, enable_broadcast_mm_inputs_process=False, enable_prefix_mm_cache=False, mm_enable_dp_encoder=False, mm_process_config={}, decrypted_config_file=None, decrypted_draft_config_file=None, forward_hooks=None)
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
[2026-01-19 20:17:35 DP6 TP6 EP6] Process 1198 gpu_id 6 is running on CPUs: [120, 121, 122, 123, 124, 125, 126, 127, 128, 129, 130, 131, 132, 133, 134, 135, 136, 137, 138, 139]
[2026-01-19 20:17:35 DP6 TP6 EP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2026-01-19 20:17:36 DP13 TP13 EP13] Process 1898 gpu_id 13 is running on CPUs: [260, 261, 262, 263, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 274, 275, 276, 277, 278, 279]
[2026-01-19 20:17:36 DP13 TP13 EP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/awq.py:77: UserWarning: Only CUDA, HIP and XPU support AWQ currently.
  warnings.warn(f"Only CUDA, HIP and XPU support AWQ currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2026-01-19 20:17:36 DP9 TP9 EP9] Process 1201 gpu_id 9 is running on CPUs: [180, 181, 182, 183, 184, 185, 186, 187, 188, 189, 190, 191, 192, 193, 194, 195, 196, 197, 198, 199]
[2026-01-19 20:17:36 DP9 TP9 EP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:36 DP4 TP4 EP4] Process 1196 gpu_id 4 is running on CPUs: [80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98, 99]
[2026-01-19 20:17:36 DP4 TP4 EP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2026-01-19 20:17:36 DP6 TP6 EP6] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:36 DP6 TP6 EP6] Init torch distributed begin.
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2026-01-19 20:17:36 DP3 TP3 EP3] Process 1195 gpu_id 3 is running on CPUs: [60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79]
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/quantization/gguf.py:46: UserWarning: Only CUDA support GGUF quantization currently.
  warnings.warn(f"Only CUDA support GGUF quantization currently.")
[2026-01-19 20:17:36 DP3 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2026-01-19 20:17:37 DP13 TP13 EP13] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP13 TP13 EP13] Init torch distributed begin.
[2026-01-19 20:17:37 DP10 TP10 EP10] Process 1202 gpu_id 10 is running on CPUs: [200, 201, 202, 203, 204, 205, 206, 207, 208, 209, 210, 211, 212, 213, 214, 215, 216, 217, 218, 219]
[2026-01-19 20:17:37 DP10 TP10 EP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP11 TP11 EP11] Process 1896 gpu_id 11 is running on CPUs: [220, 221, 222, 223, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 234, 235, 236, 237, 238, 239]
[2026-01-19 20:17:37 DP11 TP11 EP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP14 TP14 EP14] Process 1899 gpu_id 14 is running on CPUs: [280, 281, 282, 283, 284, 285, 286, 287, 288, 289, 290, 291, 292, 293, 294, 295, 296, 297, 298, 299]
[2026-01-19 20:17:37 DP14 TP14 EP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP1 TP1 EP1] Process 1193 gpu_id 1 is running on CPUs: [20, 21, 22, 23, 24, 25, 26, 27, 28, 29, 30, 31, 32, 33, 34, 35, 36, 37, 38, 39]
[2026-01-19 20:17:37 DP1 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP7 TP7 EP7] Process 1199 gpu_id 7 is running on CPUs: [140, 141, 142, 143, 144, 145, 146, 147, 148, 149, 150, 151, 152, 153, 154, 155, 156, 157, 158, 159]
[2026-01-19 20:17:37 DP7 TP7 EP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2026-01-19 20:17:37 DP5 TP5 EP5] Process 1197 gpu_id 5 is running on CPUs: [100, 101, 102, 103, 104, 105, 106, 107, 108, 109, 110, 111, 112, 113, 114, 115, 116, 117, 118, 119]
[2026-01-19 20:17:37 DP15 TP15 EP15] Process 1900 gpu_id 15 is running on CPUs: [300, 301, 302, 303, 304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 314, 315, 316, 317, 318, 319]
[2026-01-19 20:17:37 DP2 TP2 EP2] Process 1194 gpu_id 2 is running on CPUs: [40, 41, 42, 43, 44, 45, 46, 47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59]
[2026-01-19 20:17:37 DP5 TP5 EP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP15 TP15 EP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP2 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP4 TP4 EP4] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP4 TP4 EP4] Init torch distributed begin.
[2026-01-19 20:17:37 DP9 TP9 EP9] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP9 TP9 EP9] Init torch distributed begin.
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2026-01-19 20:17:37 DP8 TP8 EP8] Process 1200 gpu_id 8 is running on CPUs: [160, 161, 162, 163, 164, 165, 166, 167, 168, 169, 170, 171, 172, 173, 174, 175, 176, 177, 178, 179]
[2026-01-19 20:17:37 DP0 TP0 EP0] Process 1192 gpu_id 0 is running on CPUs: [0, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19]
[2026-01-19 20:17:37 DP12 TP12 EP12] Process 1897 gpu_id 12 is running on CPUs: [240, 241, 242, 243, 244, 245, 246, 247, 248, 249, 250, 251, 252, 253, 254, 255, 256, 257, 258, 259]
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2026-01-19 20:17:37 DP0 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP8 TP8 EP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP12 TP12 EP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2026-01-19 20:17:37 DP3 TP3 EP3] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:37 DP3 TP3 EP3] Init torch distributed begin.
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:347: ImportWarning: 
    *************************************************************************************************************
    The torch.Tensor.cuda and torch.nn.Module.cuda are replaced with torch.Tensor.npu and torch.nn.Module.npu now..
    The torch.cuda.DoubleTensor is replaced with torch.npu.FloatTensor cause the double type is not supported now..
    The backend in torch.distributed.init_process_group set to hccl now..
    The torch.cuda.* and torch.cuda.amp.* are replaced with torch.npu.* and torch.npu.amp.* now..
    The device parameters have been replaced with npu in the function below:
    torch.logspace, torch.randint, torch.hann_window, torch.rand, torch.full_like, torch.ones_like, torch.rand_like, torch.randperm, torch.arange, torch.frombuffer, torch.normal, torch._empty_per_channel_affine_quantized, torch.empty_strided, torch.empty_like, torch.scalar_tensor, torch.tril_indices, torch.bartlett_window, torch.ones, torch.sparse_coo_tensor, torch.randn, torch.kaiser_window, torch.tensor, torch.triu_indices, torch.as_tensor, torch.zeros, torch.randint_like, torch.full, torch.eye, torch._sparse_csr_tensor_unsafe, torch.empty, torch._sparse_coo_tensor_unsafe, torch.blackman_window, torch.zeros_like, torch.range, torch.sparse_csr_tensor, torch.randn_like, torch.from_file, torch._cudnn_init_dropout_state, torch._empty_affine_quantized, torch.linspace, torch.hamming_window, torch.empty_quantized, torch._pin_memory, torch.load, torch.set_default_device, torch.get_device_module, torch.sparse_compressed_tensor, torch.Tensor.new_empty, torch.Tensor.new_empty_strided, torch.Tensor.new_full, torch.Tensor.new_ones, torch.Tensor.new_tensor, torch.Tensor.new_zeros, torch.Tensor.to, torch.Tensor.pin_memory, torch.nn.Module.to, torch.nn.Module.to_empty
    *************************************************************************************************************
    
  warnings.warn(msg, ImportWarning)
/usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/contrib/transfer_to_npu.py:276: RuntimeWarning: torch.jit.script and torch.jit.script_method will be disabled by transfer_to_npu, which currently does not support them, if you need to enable them, please do not use transfer_to_npu.
  warnings.warn(msg, RuntimeWarning)
[2026-01-19 20:17:38 DP10 TP10 EP10] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP10 TP10 EP10] Init torch distributed begin.
[2026-01-19 20:17:38 DP11 TP11 EP11] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP11 TP11 EP11] Init torch distributed begin.
[2026-01-19 20:17:38 DP14 TP14 EP14] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP14 TP14 EP14] Init torch distributed begin.
[2026-01-19 20:17:38 DP1 TP1 EP1] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP1 TP1 EP1] Init torch distributed begin.
[2026-01-19 20:17:38 DP7 TP7 EP7] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP7 TP7 EP7] Init torch distributed begin.
[2026-01-19 20:17:38 DP5 TP5 EP5] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP5 TP5 EP5] Init torch distributed begin.
[2026-01-19 20:17:38 DP15 TP15 EP15] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP15 TP15 EP15] Init torch distributed begin.
[2026-01-19 20:17:38 DP2 TP2 EP2] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP2 TP2 EP2] Init torch distributed begin.
[2026-01-19 20:17:38 DP0 TP0 EP0] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP0 TP0 EP0] Init torch distributed begin.
[2026-01-19 20:17:38 DP12 TP12 EP12] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP12 TP12 EP12] Init torch distributed begin.
[2026-01-19 20:17:38 DP8 TP8 EP8] modelslim quantization is not fully optimized yet. The speed can be slower than non-quantized models.
[2026-01-19 20:17:38 DP8 TP8 EP8] Init torch distributed begin.
[Gloo] Rank 1 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 6 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 2 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 3 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 12 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 4 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 5 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 7 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 9 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 8 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 11 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 10 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 13 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 14 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 15 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 1 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 2 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 3 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 4 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 5 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 6 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 9 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 8 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 7 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 10 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 11 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 12 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 14 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 13 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 15 is connected to 15 peer ranks. Expected number of connected peer ranks is : 15
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[Gloo] Rank 0 is connected to 0 peer ranks. Expected number of connected peer ranks is : 0
[2026-01-19 20:17:40 DP0 TP0 EP0] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP13 TP13 EP13] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP15 TP15 EP15] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP14 TP14 EP14] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP12 TP12 EP12] Init torch distributed ends. mem usage=-0.00 GB
[2026-01-19 20:17:40 DP9 TP9 EP9] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP10 TP10 EP10] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP11 TP11 EP11] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP8 TP8 EP8] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP7 TP7 EP7] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP6 TP6 EP6] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP5 TP5 EP5] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP1 TP1 EP1] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP4 TP4 EP4] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP2 TP2 EP2] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:40 DP3 TP3 EP3] Init torch distributed ends. mem usage=0.00 GB
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.interns1: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.internvl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.midashenglm: No module named 'torchaudio'
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.mindspore: No module named 'mindspore'
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.nano_nemotron_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP4 TP4 EP4] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.qwen3: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.qwen3_classification: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP7 TP7 EP7] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP13 TP13 EP13] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP0 TP0 EP0] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP12 TP12 EP12] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP1 TP1 EP1] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.qwen3_omni_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP6 TP6 EP6] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP2 TP2 EP2] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP8 TP8 EP8] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP9 TP9 EP9] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.qwen3_vl: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP14 TP14 EP14] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP15 TP15 EP15] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP3 TP3 EP3] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.qwen3_vl_moe: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP11 TP11 EP11] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP10 TP10 EP10] Ignore import error when loading sglang.srt.models.radio: unexpected indent (qwen3.py, line 197)
[2026-01-19 20:17:41 DP5 TP5 EP5] Load weight begin. avail mem=61.09 GB
[2026-01-19 20:17:41 DP4 TP4 EP4] Load weight begin. avail mem=60.81 GB
[2026-01-19 20:17:41 DP1 TP1 EP1] Load weight begin. avail mem=61.08 GB
[2026-01-19 20:17:41 DP13 TP13 EP13] Load weight begin. avail mem=61.09 GB
[2026-01-19 20:17:41 DP7 TP7 EP7] Load weight begin. avail mem=61.09 GB
[2026-01-19 20:17:41 DP9 TP9 EP9] Load weight begin. avail mem=61.08 GB
[2026-01-19 20:17:41 DP8 TP8 EP8] Load weight begin. avail mem=60.82 GB
[2026-01-19 20:17:41 DP14 TP14 EP14] Load weight begin. avail mem=60.82 GB
[2026-01-19 20:17:41 DP15 TP15 EP15] Load weight begin. avail mem=61.08 GB
[2026-01-19 20:17:41 DP2 TP2 EP2] Load weight begin. avail mem=60.81 GB
[2026-01-19 20:17:41 DP3 TP3 EP3] Load weight begin. avail mem=61.09 GB
[2026-01-19 20:17:41 DP0 TP0 EP0] Load weight begin. avail mem=60.76 GB
[2026-01-19 20:17:41 DP12 TP12 EP12] Load weight begin. avail mem=60.81 GB
[2026-01-19 20:17:41 DP10 TP10 EP10] Load weight begin. avail mem=60.81 GB
[2026-01-19 20:17:41 DP11 TP11 EP11] Load weight begin. avail mem=61.09 GB
[2026-01-19 20:17:41 DP6 TP6 EP6] Load weight begin. avail mem=60.81 GB
Loading safetensors checkpoint shards:   0% Completed | 0/88 [00:00<?, ?it/s]
Loading safetensors checkpoint shards:   1% Completed | 1/88 [00:02<03:21,  2.32s/it]
Loading safetensors checkpoint shards:   2% Completed | 2/88 [00:05<03:51,  2.69s/it]
Loading safetensors checkpoint shards:   3% Completed | 3/88 [00:07<03:47,  2.67s/it]
Loading safetensors checkpoint shards:   5% Completed | 4/88 [00:10<03:56,  2.82s/it]
Loading safetensors checkpoint shards:   6% Completed | 5/88 [00:14<04:05,  2.95s/it]
Loading safetensors checkpoint shards:   7% Completed | 6/88 [00:17<04:15,  3.11s/it]
Loading safetensors checkpoint shards:   8% Completed | 7/88 [00:21<04:33,  3.38s/it]
Loading safetensors checkpoint shards:   9% Completed | 8/88 [00:25<04:51,  3.64s/it]
Loading safetensors checkpoint shards:  10% Completed | 9/88 [00:29<04:51,  3.69s/it]
Loading safetensors checkpoint shards:  11% Completed | 10/88 [00:32<04:33,  3.51s/it]
Loading safetensors checkpoint shards:  12% Completed | 11/88 [00:36<04:28,  3.48s/it]
Loading safetensors checkpoint shards:  14% Completed | 12/88 [00:39<04:21,  3.45s/it]
Loading safetensors checkpoint shards:  15% Completed | 13/88 [00:42<04:19,  3.45s/it]
Loading safetensors checkpoint shards:  16% Completed | 14/88 [00:46<04:18,  3.49s/it]
Loading safetensors checkpoint shards:  17% Completed | 15/88 [00:49<04:13,  3.48s/it]
Loading safetensors checkpoint shards:  18% Completed | 16/88 [00:53<04:12,  3.51s/it]
Loading safetensors checkpoint shards:  19% Completed | 17/88 [00:57<04:11,  3.54s/it]
Loading safetensors checkpoint shards:  20% Completed | 18/88 [01:00<04:01,  3.45s/it]
Loading safetensors checkpoint shards:  22% Completed | 19/88 [01:03<03:57,  3.44s/it]
Loading safetensors checkpoint shards:  23% Completed | 20/88 [01:07<03:50,  3.39s/it]
Loading safetensors checkpoint shards:  24% Completed | 21/88 [01:10<03:40,  3.30s/it]
Loading safetensors checkpoint shards:  25% Completed | 22/88 [01:13<03:31,  3.20s/it]
Loading safetensors checkpoint shards:  26% Completed | 23/88 [01:15<03:17,  3.04s/it]
Loading safetensors checkpoint shards:  27% Completed | 24/88 [01:18<03:14,  3.04s/it]
Loading safetensors checkpoint shards:  28% Completed | 25/88 [01:22<03:25,  3.26s/it]
Loading safetensors checkpoint shards:  30% Completed | 26/88 [01:25<03:16,  3.17s/it]
Loading safetensors checkpoint shards:  31% Completed | 27/88 [01:29<03:25,  3.37s/it]
Loading safetensors checkpoint shards:  32% Completed | 28/88 [01:31<03:04,  3.08s/it]
Loading safetensors checkpoint shards:  33% Completed | 29/88 [01:35<03:07,  3.18s/it]
Loading safetensors checkpoint shards:  34% Completed | 30/88 [01:38<03:04,  3.19s/it]
Loading safetensors checkpoint shards:  35% Completed | 31/88 [01:41<02:52,  3.03s/it]
Loading safetensors checkpoint shards:  38% Completed | 33/88 [01:41<01:38,  1.79s/it]
Loading safetensors checkpoint shards:  39% Completed | 34/88 [01:45<01:56,  2.16s/it]
Loading safetensors checkpoint shards:  40% Completed | 35/88 [01:48<02:13,  2.52s/it]
Loading safetensors checkpoint shards:  41% Completed | 36/88 [01:48<01:41,  1.95s/it]
Loading safetensors checkpoint shards:  42% Completed | 37/88 [01:51<01:51,  2.19s/it]
Loading safetensors checkpoint shards:  43% Completed | 38/88 [01:55<02:07,  2.54s/it]
Loading safetensors checkpoint shards:  44% Completed | 39/88 [01:58<02:21,  2.88s/it]
Loading safetensors checkpoint shards:  45% Completed | 40/88 [02:02<02:28,  3.09s/it]
Loading safetensors checkpoint shards:  47% Completed | 41/88 [02:06<02:31,  3.22s/it]
Loading safetensors checkpoint shards:  48% Completed | 42/88 [02:10<02:41,  3.50s/it]
Loading safetensors checkpoint shards:  49% Completed | 43/88 [02:13<02:39,  3.54s/it]
Loading safetensors checkpoint shards:  50% Completed | 44/88 [02:17<02:32,  3.46s/it]
Loading safetensors checkpoint shards:  51% Completed | 45/88 [02:20<02:29,  3.48s/it]
Loading safetensors checkpoint shards:  52% Completed | 46/88 [02:24<02:26,  3.49s/it]
Loading safetensors checkpoint shards:  53% Completed | 47/88 [02:27<02:22,  3.49s/it]
Loading safetensors checkpoint shards:  55% Completed | 48/88 [02:31<02:18,  3.46s/it]
Loading safetensors checkpoint shards:  56% Completed | 49/88 [02:34<02:17,  3.53s/it]
Loading safetensors checkpoint shards:  57% Completed | 50/88 [02:38<02:14,  3.53s/it]
Loading safetensors checkpoint shards:  58% Completed | 51/88 [02:42<02:15,  3.67s/it]
Loading safetensors checkpoint shards:  59% Completed | 52/88 [02:46<02:14,  3.73s/it]
Loading safetensors checkpoint shards:  60% Completed | 53/88 [02:49<02:11,  3.77s/it]
Loading safetensors checkpoint shards:  61% Completed | 54/88 [02:53<02:08,  3.77s/it]
Loading safetensors checkpoint shards:  62% Completed | 55/88 [02:57<02:04,  3.77s/it]
Loading safetensors checkpoint shards:  64% Completed | 56/88 [03:00<01:54,  3.59s/it]
Loading safetensors checkpoint shards:  65% Completed | 57/88 [03:04<01:49,  3.53s/it]
Loading safetensors checkpoint shards:  66% Completed | 58/88 [03:07<01:44,  3.47s/it]
Loading safetensors checkpoint shards:  67% Completed | 59/88 [03:10<01:41,  3.50s/it]
Loading safetensors checkpoint shards:  68% Completed | 60/88 [03:14<01:38,  3.53s/it]
Loading safetensors checkpoint shards:  69% Completed | 61/88 [03:18<01:36,  3.58s/it]
Loading safetensors checkpoint shards:  70% Completed | 62/88 [03:21<01:33,  3.60s/it]
Loading safetensors checkpoint shards:  72% Completed | 63/88 [03:25<01:30,  3.60s/it]
Loading safetensors checkpoint shards:  73% Completed | 64/88 [03:29<01:25,  3.58s/it]
Loading safetensors checkpoint shards:  74% Completed | 65/88 [03:32<01:19,  3.44s/it]
Loading safetensors checkpoint shards:  75% Completed | 66/88 [03:35<01:16,  3.50s/it]
Loading safetensors checkpoint shards:  76% Completed | 67/88 [03:39<01:13,  3.50s/it]
Loading safetensors checkpoint shards:  77% Completed | 68/88 [03:42<01:10,  3.52s/it]
Loading safetensors checkpoint shards:  78% Completed | 69/88 [03:46<01:07,  3.53s/it]
Loading safetensors checkpoint shards:  80% Completed | 70/88 [03:50<01:03,  3.55s/it]
Loading safetensors checkpoint shards:  83% Completed | 73/88 [03:50<00:26,  1.73s/it]
Loading safetensors checkpoint shards:  84% Completed | 74/88 [03:55<00:31,  2.26s/it]
Loading safetensors checkpoint shards:  85% Completed | 75/88 [03:59<00:34,  2.66s/it]
Loading safetensors checkpoint shards:  86% Completed | 76/88 [04:02<00:34,  2.89s/it]
Loading safetensors checkpoint shards:  88% Completed | 77/88 [04:06<00:34,  3.14s/it]
Loading safetensors checkpoint shards:  89% Completed | 78/88 [04:10<00:33,  3.36s/it]
Loading safetensors checkpoint shards:  90% Completed | 79/88 [04:13<00:29,  3.29s/it]
Loading safetensors checkpoint shards:  91% Completed | 80/88 [04:17<00:27,  3.38s/it]
Loading safetensors checkpoint shards:  92% Completed | 81/88 [04:20<00:24,  3.43s/it]
Loading safetensors checkpoint shards:  93% Completed | 82/88 [04:24<00:20,  3.40s/it]
Loading safetensors checkpoint shards:  94% Completed | 83/88 [04:27<00:16,  3.39s/it]
Loading safetensors checkpoint shards:  95% Completed | 84/88 [04:30<00:13,  3.35s/it]
Loading safetensors checkpoint shards:  97% Completed | 85/88 [04:33<00:09,  3.27s/it]
Loading safetensors checkpoint shards:  98% Completed | 86/88 [04:37<00:06,  3.27s/it]
Loading safetensors checkpoint shards:  99% Completed | 87/88 [04:40<00:03,  3.18s/it]
Loading safetensors checkpoint shards: 100% Completed | 88/88 [04:43<00:00,  3.31s/it]
Loading safetensors checkpoint shards: 100% Completed | 88/88 [04:43<00:00,  3.22s/it]

[2026-01-19 20:23:02 DP14 TP14 EP14] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.71 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP6 TP6 EP6] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.70 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP12 TP12 EP12] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.70 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP4 TP4 EP4] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.70 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP11 TP11 EP11] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.98 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP2 TP2 EP2] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.70 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP15 TP15 EP15] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.97 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP13 TP13 EP13] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.98 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP10 TP10 EP10] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.70 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP7 TP7 EP7] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.98 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP5 TP5 EP5] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.98 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP8 TP8 EP8] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.71 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP3 TP3 EP3] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.98 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP0 TP0 EP0] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.65 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP1 TP1 EP1] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.97 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP9 TP9 EP9] Load weight end. type=DeepseekV3ForCausalLM, dtype=torch.bfloat16, avail mem=20.97 GB, mem usage=40.11 GB.
[2026-01-19 20:23:02 DP0 TP0 EP0] Using KV cache dtype: torch.bfloat16
[2026-01-19 20:23:02 DP0 TP0 EP0] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP15 TP15 EP15] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP14 TP14 EP14] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP13 TP13 EP13] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP12 TP12 EP12] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP11 TP11 EP11] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP10 TP10 EP10] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP9 TP9 EP9] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP8 TP8 EP8] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP6 TP6 EP6] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP7 TP7 EP7] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP5 TP5 EP5] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP4 TP4 EP4] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP3 TP3 EP3] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP2 TP2 EP2] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:02 DP1 TP1 EP1] The available memory for KV cache is 8.49 GB.
[2026-01-19 20:23:03 DP0 TP0 EP0] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP6 TP6 EP6] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP14 TP14 EP14] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP8 TP8 EP8] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP6 TP6 EP6] Memory pool end. avail mem=12.03 GB
[2026-01-19 20:23:03 DP0 TP0 EP0] Memory pool end. avail mem=11.98 GB
[2026-01-19 20:23:03 DP14 TP14 EP14] Memory pool end. avail mem=12.04 GB
[2026-01-19 20:23:03 DP10 TP10 EP10] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP8 TP8 EP8] Memory pool end. avail mem=12.04 GB
[2026-01-19 20:23:03 DP2 TP2 EP2] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP12 TP12 EP12] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP10 TP10 EP10] Memory pool end. avail mem=12.03 GB
[2026-01-19 20:23:03 DP4 TP4 EP4] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP2 TP2 EP2] Memory pool end. avail mem=12.03 GB
[2026-01-19 20:23:03 DP12 TP12 EP12] Memory pool end. avail mem=12.03 GB
[2026-01-19 20:23:03 DP4 TP4 EP4] Memory pool end. avail mem=12.03 GB
[2026-01-19 20:23:03 DP1 TP1 EP1] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP7 TP7 EP7] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP1 TP1 EP1] Memory pool end. avail mem=12.30 GB
[2026-01-19 20:23:03 DP7 TP7 EP7] Memory pool end. avail mem=12.31 GB
[2026-01-19 20:23:03 DP9 TP9 EP9] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP15 TP15 EP15] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP11 TP11 EP11] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP9 TP9 EP9] Memory pool end. avail mem=12.30 GB
[2026-01-19 20:23:03 DP15 TP15 EP15] Memory pool end. avail mem=12.30 GB
[2026-01-19 20:23:03 DP13 TP13 EP13] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP3 TP3 EP3] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP11 TP11 EP11] Memory pool end. avail mem=12.31 GB
[2026-01-19 20:23:03 DP13 TP13 EP13] Memory pool end. avail mem=12.31 GB
[2026-01-19 20:23:03 DP3 TP3 EP3] Memory pool end. avail mem=12.31 GB
[2026-01-19 20:23:03 DP5 TP5 EP5] KV Cache is allocated. #tokens: 132480, KV size: 8.68 GB
[2026-01-19 20:23:03 DP5 TP5 EP5] Memory pool end. avail mem=12.31 GB
[2026-01-19 20:23:03 DP2 TP2 EP2] Capture npu graph begin. This can take up to several minutes. avail mem=12.03 GB
[2026-01-19 20:23:03 DP6 TP6 EP6] Capture npu graph begin. This can take up to several minutes. avail mem=12.03 GB
[2026-01-19 20:23:03 DP3 TP3 EP3] Capture npu graph begin. This can take up to several minutes. avail mem=12.31 GB
[2026-01-19 20:23:03 DP10 TP10 EP10] Capture npu graph begin. This can take up to several minutes. avail mem=12.03 GB
[2026-01-19 20:23:03 DP0 TP0 EP0] Capture npu graph begin. This can take up to several minutes. avail mem=11.98 GB
[2026-01-19 20:23:03 DP0 TP0 EP0] Capture cuda graph bs [8, 10, 12, 14, 16, 18, 20, 22, 24]
[2026-01-19 20:23:03 DP8 TP8 EP8] Capture npu graph begin. This can take up to several minutes. avail mem=12.04 GB
[2026-01-19 20:23:03 DP4 TP4 EP4] Capture npu graph begin. This can take up to several minutes. avail mem=12.03 GB
[2026-01-19 20:23:03 DP7 TP7 EP7] Capture npu graph begin. This can take up to several minutes. avail mem=12.31 GB
[2026-01-19 20:23:03 DP11 TP11 EP11] Capture npu graph begin. This can take up to several minutes. avail mem=12.31 GB
[2026-01-19 20:23:03 DP12 TP12 EP12] Capture npu graph begin. This can take up to several minutes. avail mem=12.03 GB
[2026-01-19 20:23:03 DP1 TP1 EP1] Capture npu graph begin. This can take up to several minutes. avail mem=12.30 GB
[2026-01-19 20:23:03 DP9 TP9 EP9] Capture npu graph begin. This can take up to several minutes. avail mem=12.30 GB
[2026-01-19 20:23:03 DP14 TP14 EP14] Capture npu graph begin. This can take up to several minutes. avail mem=12.04 GB
[2026-01-19 20:23:03 DP5 TP5 EP5] Capture npu graph begin. This can take up to several minutes. avail mem=12.31 GB
[2026-01-19 20:23:03 DP13 TP13 EP13] Capture npu graph begin. This can take up to several minutes. avail mem=12.31 GB
[2026-01-19 20:23:03 DP15 TP15 EP15] Capture npu graph begin. This can take up to several minutes. avail mem=12.30 GB
  0%|          | 0/9 [00:00<?, ?it/s]Capturing batches (bs=24 avail_mem=11.91 GB):   0%|          | 0/9 [00:00<?, ?it/s][rank4]:[W119 20:23:08.061970388 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank5]:[W119 20:23:08.061970518 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank11]:[W119 20:23:08.062349630 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank10]:[W119 20:23:08.062349770 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank14]:[W119 20:23:08.062619918 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank6]:[W119 20:23:08.062709211 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank7]:[W119 20:23:08.062709261 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank12]:[W119 20:23:08.065726743 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank13]:[W119 20:23:08.066006402 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank15]:[W119 20:23:08.066809767 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank8]:[W119 20:23:08.110840082 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank9]:[W119 20:23:08.111047149 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank1]:[W119 20:23:08.297339583 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank0]:[W119 20:23:08.345316140 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank2]:[W119 20:23:08.406539345 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
[rank3]:[W119 20:23:08.409669551 compiler_depend.ts:83] Warning: [Check][offset] Check input storage_offset[%ld] = 0 failed, result is untrustworthy128 (function operator())
Capturing batches (bs=24 avail_mem=11.91 GB):  11%|         | 1/9 [00:23<03:10, 23.87s/it]Capturing batches (bs=22 avail_mem=1.84 GB):  11%|         | 1/9 [00:23<03:10, 23.87s/it] terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 4; 61.27 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.50 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe211948c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe2113c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffd0ef1d584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffd0ef3b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffd0ef3e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffd0ee33494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffd0eae95d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffd0eae97bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe22035fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe220444d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe220377b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa503264d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa5032221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa50321bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff94ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff95bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff967fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff973fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff98bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff997fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9a3fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff867fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9affff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffcf38ff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffffaef16060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 13; 61.28 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.78 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe209c48c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe2096c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffd0e74d584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffd0e76b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffd0e76e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffd0e663494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffd0e3195d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffd0e3197bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe21865fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe218744d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe218677b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa47b064d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa47b0221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa47b01bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff937fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff94ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff95bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff967fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff973fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff98bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff997fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff943fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9affff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffceffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffffae740060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 9; 61.28 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.77 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe066848c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0662c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffcf440d584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffcf442b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffcf442e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffcf4323494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffcf3fd95d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffcf3fd97bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe07525fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe075344d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe075277b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa357064d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa3570221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa35701bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff927fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff933fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff93ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff957fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff963fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff96ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff987fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff94bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff993fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffcd7fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffff943ff060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 1; 61.28 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.77 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe25cc48c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe25c6c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffd13a4d584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffd13a6b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffd13a6e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffd13963494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffd136195d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffd136197bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe26b65fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe26b744d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe26b677b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa6c1964d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa6c19221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa6c191bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff947fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff953fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff95ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff96bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff983fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff98ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff99bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9a7fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff977fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9b3fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffcf7fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffffb3a47060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 8; 61.27 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.51 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdeed548c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdeecfc140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffcdcadd584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffcdcafb4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffcdcafe738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffcdc9f3494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffcdc6a95d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffcdc6a97bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffdefbf5fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffdefc044d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffdefbf77b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa15d964d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa15d9221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa15d91bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff913fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff91ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff92bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff937fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff943fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff94ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff95bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff967fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff747fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffcbffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffff7cacc060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 10; 61.27 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.50 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe036e48c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0368c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffcf146d584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffcf148b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffcf148e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffcf1383494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffcf10395d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffcf10397bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe04585fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe045944d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe045877b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa2a7064d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa2a70221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa2a701bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff927fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff933fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff93ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff94bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff957fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff963fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff96ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff903fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff993fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffcd3fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffff9145b060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 15; 61.28 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.77 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe134648c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe1340c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffd011ed584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffd0120b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffd0120e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffd01103494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffd00db95d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffd00db97bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe14305fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe143144d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe143077b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa3a4c64d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa3a4c221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa3a4c1bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff937fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff943fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff94ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff95bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff967fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff973fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff98bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff843fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9a3fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffce3fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffffa11e3060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 0; 61.27 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.44 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe009848c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0092c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffcee70d584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffcee72b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffcee72e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffcee623494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffcee2d95d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffcee2d97bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe01825fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe018344d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe018277b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa27a964d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa27a9221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa27a91bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff8cffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff917fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff92ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff93bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff947fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff953fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff95ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff96bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff977fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff8c3fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff983fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffccffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffff8e6fb060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 3; 61.28 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.78 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe1f3c48c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe1f36c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffd0d14d584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffd0d16b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffd0d16e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffd0d063494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffd0cd195d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffd0cd197bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe20265fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe202744d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe202677b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa463f64d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa463f221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa463f1bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff943fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff94ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff967fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff973fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff98bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff997fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9a3fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff8a3fef120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9affff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffceffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffffad142060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 2; 61.27 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.50 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe0d0348c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe0cfdc140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffcfadbd584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffcfaddb4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffcfadde738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffcfacd3494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffcfa9895d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffcfa9897bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe0ded5fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe0dee44d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe0ded77b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa3c1b64d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa3c1b221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa3c1b1bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff93bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff947fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff953fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff95ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff96bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff977fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff983fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff98ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff77bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff99bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffcdf6ff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffff9adab060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 6; 61.27 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.50 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf19248c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf18cc140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffcdf6ad584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffcdf6cb4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffcdf6ce738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffcdf5c3494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffcdf2795d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffcdf2797bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffdf27c5fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffdf27d44d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffdf27c77b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa20a964d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa20a9221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa20a91bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff913fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff91ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff92bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff937fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff943fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff95bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff967fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff973fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff753fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffcc3fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffff7f6a8060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
[2026-01-19 20:23:32] DataParallelController hit an exception: Traceback (most recent call last):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/data_parallel_controller.py", line 568, in run_data_parallel_controller_process
    controller = DataParallelController(
                 ^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/data_parallel_controller.py", line 168, in __init__
    self.launch_dp_attention_schedulers(server_args, port_args)
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/data_parallel_controller.py", line 374, in launch_dp_attention_schedulers
    self.launch_tensor_parallel_group(
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/data_parallel_controller.py", line 461, in launch_tensor_parallel_group
    scheduler_info.append(scheduler_pipe_readers[i].recv())
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250, in recv
    buf = self._recv_bytes()
          ^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430, in _recv_bytes
    buf = self._recv(4)
          ^^^^^^^^^^^^^
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 399, in _recv
    raise EOFError
EOFError

[2026-01-19 20:23:32] Received sigquit from a child process. It usually means the child failed.
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 5; 61.28 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.78 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe177748c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe1771c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffd054fd584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffd0551b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffd0551e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffd05413494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffd050c95d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffd050c97bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe18615fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe186244d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe186177b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa480464d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa4804221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa48041bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff947fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff953fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff95ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff96bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff977fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff983fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff98ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff99bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff887fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9a7fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffce7fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffffa54ec060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 14; 61.27 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.51 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffdf6ab48c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffdf6a5c140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffce483d584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffce485b4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffce485e738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffce4753494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffce44095d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffce44097bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffdf7955fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffdf79644d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffdf79577b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa1db164d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa1db1221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa1db11bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff91bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff927fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff933fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff93ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff94bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff957fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff96ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff75bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff987fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffcc7fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffff84834060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
terminate called after throwing an instance of 'c10::Error'
  what():  NPU out of memory. Tried to allocate 4.00 GiB (NPU 7; 61.28 GiB total capacity; 52.08 GiB already allocated; 52.08 GiB current active; 1.78 GiB free; 57.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.
Exception raised from malloc at build/CMakeFiles/torch_npu.dir/compiler_depend.ts:1634 (most recent call first):
frame #0: c10::Error::Error(c10::SourceLocation, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> >) + 0xb0 (0xfffe1d2248c0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #1: c10::detail::torchCheckFail(char const*, char const*, unsigned int, std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&) + 0x68 (0xfffe1d1cc140 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libc10.so)
frame #2: <unknown function> + 0x9ed584 (0xfffd0afad584 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #3: <unknown function> + 0xa0b4f4 (0xfffd0afcb4f4 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #4: <unknown function> + 0xa0e738 (0xfffd0afce738 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #5: <unknown function> + 0x903494 (0xfffd0aec3494 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #6: <unknown function> + 0x5b95d8 (0xfffd0ab795d8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #7: <unknown function> + 0x5b97bc (0xfffd0ab797bc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch_npu/lib/libtorch_npu.so)
frame #8: at::_ops::empty_memory_format::redispatch(c10::DispatchKeySet, c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0xec (0xfffe1e0c5fcc in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #9: <unknown function> + 0x12344d0 (0xfffe1e0d44d0 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #10: at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>) + 0x1c8 (0xfffe1e0c77b8 in /usr/local/python3.11.14/lib/python3.11/site-packages/torch/lib/libtorch_cpu.so)
frame #11: at::empty(c10::ArrayRef<long>, c10::TensorOptions, std::optional<c10::MemoryFormat>) + 0x134 (0xfffa4c3d64d4 in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #12: <unknown function> + 0x1221c (0xfffa4c3d221c in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
frame #13: <unknown function> + 0x11bdc (0xfffa4c3d1bdc in /root/.triton/cache/I0BrlCSnKsuU20wkGVQ_W6113GtoKlXz8xEBIkD9SfY/launcher_cxx11abi1.cpython-311-aarch64-linux-gnu.so)
<omitting python frames>

Fatal Python error: Aborted

Thread 0x0000fff94bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff957fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff963fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff96ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff97bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff987fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff993fff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff99ffff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 327 in wait
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/queues.py", line 231 in _feed
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff78bfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 395 in _recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 430 in _recv_bytes
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/connection.py", line 250 in recv
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/managers.py", line 822 in _callmethod
  File "<string>", line 2 in get
  File "/usr/local/Ascend/cann-8.5.0/python/site-packages/tbe/common/repository_manager/utils/multiprocess_util.py", line 68 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fff9abfff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 331 in wait
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 629 in wait
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/tqdm/_monitor.py", line 60 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Thread 0x0000fffcef8ff120 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 61 in _recv_msg
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/_inductor/compile_worker/subproc_pool.py", line 195 in _read_thread
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982 in run
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045 in _bootstrap_inner
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1002 in _bootstrap

Current thread 0x0000ffffaafa7060 (most recent call first):
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/backends/ascend/driver.py", line 156 in __call__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 697 in run
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/triton/runtime/jit.py", line 353 in <lambda>
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sgl_kernel_npu/activation/swiglu_quant.py", line 96 in swiglu_quant
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/quantization/fused_moe_method_npu.py", line 594 in apply_without_routing_weights
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 405 in forward_npu
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 220 in run_moe_core
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 185 in forward_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/layers/moe/ep_moe/layer.py", line 167 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 1129 in forward_deepep
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 819 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 2926 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3214 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1784 in _call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/nn/modules/module.py", line 1773 in _wrapped_call_impl
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/models/deepseek_v2.py", line 3403 in forward
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/torch/utils/_contextlib.py", line 120 in decorate_context
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 711 in run_once
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 724 in capture_one_batch_size
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 505 in _capture_one_stream
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 518 in capture
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/cuda_graph_runner.py", line 359 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/hardware_backend/npu/graph_runner/npu_graph_runner.py", line 80 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 2683 in init_device_graphs
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 591 in initialize
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/model_executor/model_runner.py", line 385 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/tp_worker.py", line 253 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 455 in init_model_worker
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 317 in __init__
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/srt/managers/scheduler.py", line 2978 in run_scheduler_process
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 108 in run
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/process.py", line 314 in _bootstrap
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 135 in _main
  File "/usr/local/python3.11.14/lib/python3.11/multiprocessing/spawn.py", line 122 in spawn_main
  File "<string>", line 1 in <module>

Extension modules: numpy._core._multiarray_umath, numpy.linalg._umath_linalg, pybase64._pybase64, charset_normalizer.md, requests.packages.charset_normalizer.md, requests.packages.chardet.md, multidict._multidict, yarl._quoting_c, propcache._helpers_c, aiohttp._http_writer, aiohttp._http_parser, aiohttp._websocket.mask, aiohttp._websocket.reader_c, frozenlist._frozenlist, torch._C, torch._C._dynamo.autograd_compiler, torch._C._dynamo.eval_frame, torch._C._dynamo.guards, torch._C._dynamo.utils, torch._C._fft, torch._C._linalg, torch._C._nested, torch._C._nn, torch._C._sparse, torch._C._special, numpy.random._common, numpy.random.bit_generator, numpy.random._bounded_integers, numpy.random._pcg64, numpy.random._mt19937, numpy.random._generator, numpy.random._philox, numpy.random._sfc64, numpy.random.mtrand, torch_npu._C, markupsafe._speedups, yaml._yaml, psutil._psutil_linux, zmq.backend.cython._zmq, PIL._imaging, sentencepiece._sentencepiece, regex._regex, npu_utils, PIL._imagingft, _cffi_backend, _cyutility, scipy._cyutility, scipy._lib._ccallback_c, scipy.linalg._fblas, scipy.linalg._flapack, scipy.linalg.cython_lapack, scipy.linalg._cythonized_array_utils, scipy.linalg._solve_toeplitz, scipy.linalg._batched_linalg, scipy.linalg._decomp_lu_cython, scipy.linalg._matfuncs_schur_sqrtm, scipy.linalg._matfuncs_expm, scipy.linalg._linalg_pythran, scipy.linalg.cython_blas, scipy.linalg._decomp_update, scipy.sparse._sparsetools, _csparsetools, scipy.sparse._csparsetools, scipy.sparse.linalg._dsolve._superlu, scipy.sparse.linalg._eigen.arpack._arpacklib, scipy.sparse.linalg._propack, scipy.optimize._group_columns, scipy._lib.messagestream, scipy.optimize._trlib._trlib, scipy.optimize._lbfgsb, _moduleTNC, scipy.optimize._moduleTNC, scipy.optimize._slsqplib, scipy.optimize._minpack, scipy.optimize._lsq.givens_elimination, scipy.optimize._zeros, scipy._lib._uarray._uarray, scipy.special._ufuncs_cxx, scipy.special._ellip_harm_2, scipy.special._special_ufuncs, scipy.special._gufuncs, scipy.special._ufuncs, scipy.special._specfun, scipy.special._comb, scipy.linalg._decomp_interpolative, scipy.optimize._bglu_dense, scipy.optimize._lsap, scipy.spatial._ckdtree, scipy.spatial._qhull, scipy.spatial._voronoi, scipy.spatial._hausdorff, scipy.spatial._distance_wrap, scipy.spatial.transform._rotation_cy, scipy.spatial.transform._rigid_transform_cy, scipy.optimize._direct, setproctitle._setproctitle, google._upb._message, msgspec._core, pyarrow.lib, pandas._libs.tslibs.ccalendar, pandas._libs.tslibs.np_datetime, pandas._libs.tslibs.dtypes, pandas._libs.tslibs.base, pandas._libs.tslibs.nattype, pandas._libs.tslibs.timezones, pandas._libs.tslibs.fields, pandas._libs.tslibs.timedeltas, pandas._libs.tslibs.tzconversion, pandas._libs.tslibs.timestamps, pandas._libs.properties, pandas._libs.tslibs.offsets, pandas._libs.tslibs.strptime, pandas._libs.tslibs.parsing, pandas._libs.tslibs.conversion, pandas._libs.tslibs.period, pandas._libs.tslibs.vectorized, pandas._libs.ops_dispatch, pandas._libs.missing, pandas._libs.hashtable, pandas._libs.algos, pandas._libs.interval, pandas._libs.lib, pyarrow._compute, pandas._libs.ops, pandas._libs.hashing, pandas._libs.arrays, pandas._libs.tslib, pandas._libs.sparse, pandas._libs.internals, pandas._libs.indexing, pandas._libs.index, pandas._libs.writers, pandas._libs.join, pandas._libs.window.aggregations, pandas._libs.window.indexers, pandas._libs.reshape, pandas._libs.groupby, pandas._libs.json, pandas._libs.parsers, pandas._libs.testing, pyarrow._parquet, pyarrow._fs, pyarrow._azurefs, pyarrow._hdfs, pyarrow._gcsfs, pyarrow._s3fs, xxhash._xxhash, pyarrow._acero, pyarrow._csv, pyarrow._json, pyarrow._substrait, pyarrow._dataset, pyarrow._dataset_orc, pyarrow._parquet_encryption, pyarrow._dataset_parquet_encryption, pyarrow._dataset_parquet, __triton_launcher (total: 157)
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
[ERROR] TBE Subprocess[task_distribute] raise error[], main process disappeared!
Exception in thread Thread-2 (launch_node):
Traceback (most recent call last):
  File "/data/d00662834/0104_dev/sglang/test/registered/ascend/performance/test_ascend_disaggregation_utils.py", line 287, in launch_node
    process = popen_launch_server(
              ^^^^^^^^^^^^^^^^^^^^
  File "/usr/local/python3.11.14/lib/python3.11/site-packages/sglang/test/test_utils.py", line 660, in popen_launch_server
    raise Exception(
Exception: Server process exited with code -9. Check server logs for errors.

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 1045, in _bootstrap_inner
    self.run()
  File "/usr/local/python3.11.14/lib/python3.11/threading.py", line 982, in run
    self._target(*self._args, **self._kwargs)
  File "/data/d00662834/0104_dev/sglang/test/registered/ascend/performance/test_ascend_disaggregation_utils.py", line 296, in launch_node
    raise RuntimeError(f"Failed to start {role} node on {node_ip}: {e}")
RuntimeError: Failed to start decode node on 172.22.3.245: Server process exited with code -9. Check server logs for errors.
